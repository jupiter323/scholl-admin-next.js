{"ast":null,"code":"import _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/wolf/Documents/clearchoice/admin/feature-view-updated-course/clear-choice-admin/components/Dashboard/components/Modals/AssignLessonModal/index.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport update from 'immutability-helper';\nimport moment from 'moment';\nimport FilterSection from './components/FilterSection';\nimport LessonCard from './components/LessonCard';\nimport sampleLessons from '../../../utils/sampleLessons';\nimport { pageNumberSort, problemSort, timeEstimateSort, subjectSort } from '../../../utils/sortOptions';\nvar lessonTypeMap = {\n  'Challenge + Practice': 'challenge',\n  'Homework Drill': 'homework',\n  'Reading from Workbook': 'readingFromWorkbook'\n};\n\nvar AssignLessonModal =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(AssignLessonModal, _React$Component);\n\n  function AssignLessonModal(props) {\n    var _this;\n\n    _classCallCheck(this, AssignLessonModal);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AssignLessonModal).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"onToggleAssignSelectedDropdown\", function () {\n      return _this.setState(function (_ref) {\n        var assignSelectedDropdownOpen = _ref.assignSelectedDropdownOpen;\n        return {\n          assignSelectedDropdownOpen: !assignSelectedDropdownOpen\n        };\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSetDropdown\", function (dropdownIndex) {\n      return _this.setState({\n        dropdownIndex: dropdownIndex,\n        dropdownIsOpen: true\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onCloseDropdown\", function () {\n      return _this.setState({\n        dropdownIsOpen: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onResetModal\", function () {\n      return _this.setState({\n        subjectFilters: [],\n        typeFilters: [],\n        sort: ''\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSetSort\", function (sort) {\n      return _this.setState({\n        sort: sort\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSetFilteredState\", function (titleFilter, value) {\n      return _this.setState(_defineProperty({}, titleFilter, value));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onUnsetFilteredState\", function (titleFilter) {\n      return _this.setState(_defineProperty({}, titleFilter, ''));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onCloseModal\", function () {\n      var onClose = _this.props.onClose;\n      onClose();\n\n      _this.onResetModal();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSortLessons\", function (lessons) {\n      var sort = _this.state.sort;\n\n      switch (sort) {\n        case 'pageNumber':\n          return lessons.sort(pageNumberSort);\n\n        case 'problems':\n          return lessons.sort(problemSort);\n\n        case 'timeEstimate':\n          return lessons.sort(timeEstimateSort);\n\n        case 'subject':\n          return lessons.sort(subjectSort);\n\n        default:\n          break;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onFilterByTitle\", function () {\n      var _this$state = _this.state,\n          lessons = _this$state.lessons,\n          titleFilter = _this$state.titleFilter;\n      return lessons.reduce(function (finalArr, currentLesson) {\n        var title = currentLesson.title;\n        var lessonString = title.replace(/\\s/g, \"\").toLowerCase();\n\n        if (lessonString.indexOf(titleFilter) !== -1 && finalArr.indexOf(currentLesson) === -1) {\n          finalArr.push(currentLesson);\n        }\n\n        return finalArr;\n      }, []);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onFilterByUnit\", function () {\n      var _this$state2 = _this.state,\n          lessons = _this$state2.lessons,\n          unitFilter = _this$state2.unitFilter;\n      return lessons.reduce(function (finalArr, currentLesson) {\n        var unit = currentLesson.unit;\n        var lessonString = unit.replace(/\\s/g, \"\").toLowerCase();\n\n        if (lessonString.indexOf(unitFilter) !== -1 && finalArr.indexOf(currentLesson) === -1) {\n          finalArr.push(currentLesson);\n        }\n\n        return finalArr;\n      }, []);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onFilterLessons\", function () {\n      var _this$state3 = _this.state,\n          subjectFilters = _this$state3.subjectFilters,\n          typeFilters = _this$state3.typeFilters,\n          allLessons = _this$state3.lessons;\n      var lessons = allLessons;\n\n      if (subjectFilters.length) {\n        lessons = lessons.filter(function (lesson) {\n          return subjectFilters.indexOf(lesson.subject) !== -1;\n        });\n      }\n\n      if (typeFilters.length) {\n        lessons = lessons.filter(function (lesson) {\n          return typeFilters.indexOf(lessonTypeMap[lesson.type]) !== -1;\n        });\n      }\n\n      return lessons;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getMappableLessons\", function () {\n      var _this$state4 = _this.state,\n          subjectFilters = _this$state4.subjectFilters,\n          typeFilters = _this$state4.typeFilters,\n          sort = _this$state4.sort,\n          unitFilter = _this$state4.unitFilter,\n          titleFilter = _this$state4.titleFilter,\n          lessons = _this$state4.lessons;\n      var mappableLessons = lessons;\n\n      if (titleFilter.length) {\n        mappableLessons = _this.onFilterByTitle();\n      }\n\n      if (unitFilter.length) {\n        mappableLessons = _this.onFilterByUnit();\n      }\n\n      if (subjectFilters.length || typeFilters.length) {\n        mappableLessons = _this.onFilterLessons();\n      }\n\n      if (sort) {\n        return _this.onSortLessons(mappableLessons);\n      }\n\n      return mappableLessons;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleFilterClick\", function (filterType, filter) {\n      var _this$state5 = _this.state,\n          currentSubjectFilters = _this$state5.subjectFilters,\n          currentTypeFilters = _this$state5.typeFilters;\n      var modifiedFilterCurrentState;\n      var modifiedFilterName;\n      var modifiedFilterUpdatedState;\n\n      switch (filterType) {\n        case 'subject':\n          modifiedFilterCurrentState = currentSubjectFilters;\n          modifiedFilterName = 'subjectFilters';\n          break;\n\n        case 'type':\n          modifiedFilterCurrentState = currentTypeFilters;\n          modifiedFilterName = 'typeFilters';\n          break;\n\n        default:\n          break;\n      }\n\n      if (modifiedFilterCurrentState.indexOf(filter) === -1) {\n        modifiedFilterUpdatedState = update(modifiedFilterCurrentState, {\n          $push: [filter]\n        });\n      } else {\n        var filterIndex = modifiedFilterCurrentState.indexOf(filter);\n        modifiedFilterUpdatedState = update(modifiedFilterCurrentState, {\n          $splice: [[filterIndex, 1]]\n        });\n      }\n\n      _this.setState(_defineProperty({}, modifiedFilterName, modifiedFilterUpdatedState));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleLessonClick\", function (lesson) {\n      var selectedLessons = _this.state.selectedLessons;\n      var modifiedLessons;\n\n      if (selectedLessons.indexOf(lesson) === -1) {\n        modifiedLessons = update(selectedLessons, {\n          $push: [lesson]\n        });\n      } else {\n        var lessonIndex = selectedLessons.indexOf(lesson);\n        modifiedLessons = update(selectedLessons, {\n          $splice: [[lessonIndex, 1]]\n        });\n      }\n\n      _this.setState({\n        selectedLessons: modifiedLessons\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"assignLessons\", function (date) {\n      var onAssignLessons = _this.props.onAssignLessons;\n      var selectedLessons = _this.state.selectedLessons;\n      var assignDate;\n\n      switch (date) {\n        case 'today':\n          assignDate = moment().format('MM/DD/YY');\n          break;\n\n        case 'tomorrow':\n          assignDate = moment().add(1, 'days').format('MM/DD/YY');\n          break;\n\n        case 'nextSession':\n          break;\n\n        case 'customDate':\n          assignDate = '01/05/19';\n          break;\n\n        default:\n          break;\n      }\n\n      _this.onToggleAssignSelectedDropdown();\n\n      _this.onResetModal();\n\n      onAssignLessons(selectedLessons, assignDate);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"mapLessons\", function () {\n      return _this.getMappableLessons().map(function (lesson, index) {\n        return __jsx(LessonCard, {\n          lesson: lesson,\n          index: index,\n          key: lesson.id,\n          onSetDropdown: _this.onSetDropdown,\n          onCloseDropdown: _this.onCloseDropdown,\n          dropdownIndex: _this.state.dropdownIndex,\n          dropdownIsOpen: _this.state.dropdownIsOpen,\n          handleLessonClick: _this.handleLessonClick,\n          selectedLessons: _this.state.selectedLessons,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 193\n          },\n          __self: this\n        });\n      });\n    });\n\n    _this.state = {\n      sort: '',\n      unitFilter: '',\n      titleFilter: '',\n      typeFilters: [],\n      subjectFilters: [],\n      selectedLessons: [],\n      lessons: sampleLessons,\n      dropdownIndex: null,\n      dropdownIsOpen: false,\n      assignSelectedDropdownOpen: false\n    };\n    return _this;\n  }\n\n  _createClass(AssignLessonModal, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var open = this.props.open;\n      var _this$state6 = this.state,\n          assignSelectedDropdownOpen = _this$state6.assignSelectedDropdownOpen,\n          subjectFilters = _this$state6.subjectFilters,\n          typeFilters = _this$state6.typeFilters,\n          sort = _this$state6.sort;\n      return __jsx(\"div\", {\n        className: \"jsx-4152893512\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210\n        },\n        __self: this\n      }, open && __jsx(\"div\", {\n        className: \"jsx-4152893512\" + \" \" + \"wrapper\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        style: {\n          minWidth: \"100%\"\n        },\n        className: \"jsx-4152893512\" + \" \" + \"card-modal card-main card switcher-section grey lighten-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        className: \"jsx-4152893512\" + \" \" + \"header-row card-panel light-blue lighten-1 white-text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        className: \"jsx-4152893512\" + \" \" + \"card-panel-row row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        className: \"jsx-4152893512\" + \" \" + \"col s11\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        className: \"jsx-4152893512\" + \" \" + \"d-flex\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        className: \"jsx-4152893512\" + \" \" + \"icon-col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218\n        },\n        __self: this\n      }, __jsx(\"i\", {\n        className: \"jsx-4152893512\" + \" \" + \"icon-books-l\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219\n        },\n        __self: this\n      })), __jsx(\"div\", {\n        className: \"jsx-4152893512\" + \" \" + \"card-panel-text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        className: \"jsx-4152893512\" + \" \" + \"text-large\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }, \"Assign Lessons\")))), __jsx(\"div\", {\n        className: \"jsx-4152893512\" + \" \" + \"col s1 right-align\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        className: \"jsx-4152893512\" + \" \" + \"row icons-row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      }, __jsx(\"a\", {\n        href: \"#\",\n        onClick: this.onCloseModal,\n        className: \"jsx-4152893512\" + \" \" + \"modal-close close\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      }, __jsx(\"i\", {\n        className: \"jsx-4152893512\" + \" \" + \"icon-close-thin\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      })))))), __jsx(FilterSection, {\n        sort: sort,\n        typeFilters: typeFilters,\n        subjectFilters: subjectFilters,\n        onSetSort: this.onSetSort,\n        onClearFilters: this.onResetModal,\n        handleFilterClick: this.handleFilterClick,\n        onSetFilteredState: this.onSetFilteredState,\n        onUnsetFilteredState: this.onUnsetFilteredState,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231\n        },\n        __self: this\n      }), __jsx(\"div\", {\n        className: \"jsx-4152893512\" + \" \" + \"card-content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        className: \"jsx-4152893512\" + \" \" + \"card-body\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        className: \"jsx-4152893512\" + \" \" + \"result-row center-align\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243\n        },\n        __self: this\n      }, __jsx(\"b\", {\n        className: \"jsx-4152893512\" + \" \" + \"result\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244\n        },\n        __self: this\n      }, \" - \", this.getMappableLessons().length, \" results -\")), __jsx(\"div\", {\n        className: \"jsx-4152893512\" + \" \" + \"checkboxes-section row d-flex-content card-width-322\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246\n        },\n        __self: this\n      }, this.mapLessons())))), __jsx(\"div\", {\n        className: \"jsx-4152893512\" + \" \" + \"add-btn-block\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252\n        },\n        __self: this\n      }, __jsx(\"a\", {\n        href: \"#\",\n        onClick: this.onToggleAssignSelectedDropdown,\n        \"data-target\": \"dropdown_assign_selected_lessons\",\n        className: \"jsx-4152893512\" + \" \" + \"dropdown-trigger waves-effect waves-teal btn add-btn\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253\n        },\n        __self: this\n      }, __jsx(\"i\", {\n        className: \"jsx-4152893512\" + \" \" + \"material-icons\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259\n        },\n        __self: this\n      }, \"add\"), \" Assign Selected\"), __jsx(\"ul\", {\n        id: \"dropdown_assign_selected_lessons\",\n        style: {\n          display: assignSelectedDropdownOpen ? 'block' : '0',\n          opacity: assignSelectedDropdownOpen ? '1' : '0'\n        },\n        className: \"jsx-4152893512\" + \" \" + 'dropdown-content',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261\n        },\n        __self: this\n      }, __jsx(\"li\", {\n        className: \"jsx-4152893512\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 266\n        },\n        __self: this\n      }, __jsx(\"a\", {\n        href: \"#\",\n        onClick: function onClick() {\n          return _this2.assignLessons('today');\n        },\n        className: \"jsx-4152893512\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 266\n        },\n        __self: this\n      }, \"For Today\")), __jsx(\"li\", {\n        className: \"jsx-4152893512\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267\n        },\n        __self: this\n      }, __jsx(\"a\", {\n        href: \"#\",\n        onClick: function onClick() {\n          return _this2.assignLessons('tomorrow');\n        },\n        className: \"jsx-4152893512\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267\n        },\n        __self: this\n      }, \"For Tomorrow\")), __jsx(\"li\", {\n        className: \"jsx-4152893512\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268\n        },\n        __self: this\n      }, __jsx(\"a\", {\n        href: \"#\",\n        onClick: function onClick() {\n          return _this2.assignLessons('nextSession');\n        },\n        className: \"jsx-4152893512\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268\n        },\n        __self: this\n      }, \"For Next Session\")), __jsx(\"li\", {\n        className: \"jsx-4152893512\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 269\n        },\n        __self: this\n      }, __jsx(\"a\", {\n        href: \"#\",\n        onClick: function onClick() {\n          return _this2.assignLessons('customDate');\n        },\n        className: \"jsx-4152893512\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 269\n        },\n        __self: this\n      }, \"For Date...\"))))), __jsx(_JSXStyle, {\n        id: \"4152893512\",\n        __self: this\n      }, \".card-modal.jsx-4152893512{margin:0;border-radius:6px;}.modal-custom.jsx-4152893512{opacity:1;visibility:visible;}.modal-footer.jsx-4152893512{background-color:white;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy93b2xmL0RvY3VtZW50cy9jbGVhcmNob2ljZS9hZG1pbi9mZWF0dXJlLXZpZXctdXBkYXRlZC1jb3Vyc2UvY2xlYXItY2hvaWNlLWFkbWluL2NvbXBvbmVudHMvRGFzaGJvYXJkL2NvbXBvbmVudHMvTW9kYWxzL0Fzc2lnbkxlc3Nvbk1vZGFsL2luZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQWtSVyxBQUd3QixBQUlDLEFBSWEsU0FQTCxDQUlDLGFBSXJCLElBUEEsRUFJQSIsImZpbGUiOiIvVXNlcnMvd29sZi9Eb2N1bWVudHMvY2xlYXJjaG9pY2UvYWRtaW4vZmVhdHVyZS12aWV3LXVwZGF0ZWQtY291cnNlL2NsZWFyLWNob2ljZS1hZG1pbi9jb21wb25lbnRzL0Rhc2hib2FyZC9jb21wb25lbnRzL01vZGFscy9Bc3NpZ25MZXNzb25Nb2RhbC9pbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IHVwZGF0ZSBmcm9tICdpbW11dGFiaWxpdHktaGVscGVyJztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcblxuaW1wb3J0IEZpbHRlclNlY3Rpb24gZnJvbSAnLi9jb21wb25lbnRzL0ZpbHRlclNlY3Rpb24nO1xuaW1wb3J0IExlc3NvbkNhcmQgZnJvbSAnLi9jb21wb25lbnRzL0xlc3NvbkNhcmQnO1xuaW1wb3J0IHNhbXBsZUxlc3NvbnMgZnJvbSAnLi4vLi4vLi4vdXRpbHMvc2FtcGxlTGVzc29ucyc7XG5pbXBvcnQgeyBwYWdlTnVtYmVyU29ydCwgcHJvYmxlbVNvcnQsIHRpbWVFc3RpbWF0ZVNvcnQsIHN1YmplY3RTb3J0IH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvc29ydE9wdGlvbnMnO1xuXG5jb25zdCBsZXNzb25UeXBlTWFwID0ge1xuICAnQ2hhbGxlbmdlICsgUHJhY3RpY2UnOiAnY2hhbGxlbmdlJyxcbiAgJ0hvbWV3b3JrIERyaWxsJzogJ2hvbWV3b3JrJyxcbiAgJ1JlYWRpbmcgZnJvbSBXb3JrYm9vayc6ICdyZWFkaW5nRnJvbVdvcmtib29rJyxcbn07XG5cbmNsYXNzIEFzc2lnbkxlc3Nvbk1vZGFsIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIHNvcnQ6ICcnLFxuICAgICAgdW5pdEZpbHRlcjogJycsXG4gICAgICB0aXRsZUZpbHRlcjogJycsXG4gICAgICB0eXBlRmlsdGVyczogW10sXG4gICAgICBzdWJqZWN0RmlsdGVyczogW10sXG4gICAgICBzZWxlY3RlZExlc3NvbnM6IFtdLFxuICAgICAgbGVzc29uczogc2FtcGxlTGVzc29ucyxcbiAgICAgIGRyb3Bkb3duSW5kZXg6IG51bGwsXG4gICAgICBkcm9wZG93bklzT3BlbjogZmFsc2UsXG4gICAgICBhc3NpZ25TZWxlY3RlZERyb3Bkb3duT3BlbjogZmFsc2UsXG4gICAgfTtcbiAgfVxuXG4gIG9uVG9nZ2xlQXNzaWduU2VsZWN0ZWREcm9wZG93biA9ICgpID0+IHRoaXMuc2V0U3RhdGUoKHsgYXNzaWduU2VsZWN0ZWREcm9wZG93bk9wZW4gfSkgPT4gKHsgYXNzaWduU2VsZWN0ZWREcm9wZG93bk9wZW46ICFhc3NpZ25TZWxlY3RlZERyb3Bkb3duT3BlbiB9KSlcblxuICBvblNldERyb3Bkb3duID0gKGRyb3Bkb3duSW5kZXgpID0+IHRoaXMuc2V0U3RhdGUoeyBkcm9wZG93bkluZGV4LCBkcm9wZG93bklzT3BlbjogdHJ1ZSB9KTtcbiAgb25DbG9zZURyb3Bkb3duID0gKCkgPT4gdGhpcy5zZXRTdGF0ZSh7IGRyb3Bkb3duSXNPcGVuOiBmYWxzZSB9KTtcblxuICBvblJlc2V0TW9kYWwgPSAoKSA9PiB0aGlzLnNldFN0YXRlKHsgc3ViamVjdEZpbHRlcnM6IFtdLCB0eXBlRmlsdGVyczogW10sIHNvcnQ6ICcnIH0pXG4gIG9uU2V0U29ydCA9IChzb3J0KSA9PiB0aGlzLnNldFN0YXRlKHsgc29ydCB9KVxuXG4gIG9uU2V0RmlsdGVyZWRTdGF0ZSA9ICh0aXRsZUZpbHRlciwgdmFsdWUpID0+IHRoaXMuc2V0U3RhdGUoeyBbdGl0bGVGaWx0ZXJdOiB2YWx1ZSB9KVxuICBvblVuc2V0RmlsdGVyZWRTdGF0ZSA9ICh0aXRsZUZpbHRlcikgPT4gdGhpcy5zZXRTdGF0ZSh7IFt0aXRsZUZpbHRlcl06ICcnIH0pXG5cbiAgb25DbG9zZU1vZGFsID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgb25DbG9zZSB9ID0gdGhpcy5wcm9wcztcbiAgICBvbkNsb3NlKCk7XG4gICAgdGhpcy5vblJlc2V0TW9kYWwoKTtcbiAgfVxuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjb25zaXN0ZW50LXJldHVyblxuICBvblNvcnRMZXNzb25zID0gKGxlc3NvbnMpID0+IHtcbiAgICBjb25zdCB7IHNvcnQgfSA9IHRoaXMuc3RhdGU7XG4gICAgc3dpdGNoIChzb3J0KSB7XG4gICAgICBjYXNlICdwYWdlTnVtYmVyJzpcbiAgICAgICAgcmV0dXJuIGxlc3NvbnMuc29ydChwYWdlTnVtYmVyU29ydCk7XG4gICAgICBjYXNlICdwcm9ibGVtcyc6XG4gICAgICAgIHJldHVybiBsZXNzb25zLnNvcnQocHJvYmxlbVNvcnQpO1xuICAgICAgY2FzZSAndGltZUVzdGltYXRlJzpcbiAgICAgICAgcmV0dXJuIGxlc3NvbnMuc29ydCh0aW1lRXN0aW1hdGVTb3J0KTtcbiAgICAgIGNhc2UgJ3N1YmplY3QnOlxuICAgICAgICByZXR1cm4gbGVzc29ucy5zb3J0KHN1YmplY3RTb3J0KTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIG9uRmlsdGVyQnlUaXRsZSA9ICgpID0+IHtcbiAgICBjb25zdCB7IGxlc3NvbnMsIHRpdGxlRmlsdGVyIH0gPSB0aGlzLnN0YXRlO1xuICAgIHJldHVybiBsZXNzb25zLnJlZHVjZSgoZmluYWxBcnIsIGN1cnJlbnRMZXNzb24pID0+IHtcbiAgICAgIGNvbnN0IHsgdGl0bGUgfSA9IGN1cnJlbnRMZXNzb247XG4gICAgICBjb25zdCBsZXNzb25TdHJpbmcgPSB0aXRsZS5yZXBsYWNlKC9cXHMvZywgXCJcIikudG9Mb3dlckNhc2UoKTtcbiAgICAgIGlmIChsZXNzb25TdHJpbmcuaW5kZXhPZih0aXRsZUZpbHRlcikgIT09IC0xICYmIGZpbmFsQXJyLmluZGV4T2YoY3VycmVudExlc3NvbikgPT09IC0xKSB7XG4gICAgICAgIGZpbmFsQXJyLnB1c2goY3VycmVudExlc3Nvbik7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmluYWxBcnI7XG4gICAgfSwgW10pO1xuICB9XG5cbiAgb25GaWx0ZXJCeVVuaXQgPSAoKSA9PiB7XG4gICAgY29uc3QgeyBsZXNzb25zLCB1bml0RmlsdGVyIH0gPSB0aGlzLnN0YXRlO1xuICAgIHJldHVybiBsZXNzb25zLnJlZHVjZSgoZmluYWxBcnIsIGN1cnJlbnRMZXNzb24pID0+IHtcbiAgICAgIGNvbnN0IHsgdW5pdCB9ID0gY3VycmVudExlc3NvbjtcbiAgICAgIGNvbnN0IGxlc3NvblN0cmluZyA9IHVuaXQucmVwbGFjZSgvXFxzL2csIFwiXCIpLnRvTG93ZXJDYXNlKCk7XG4gICAgICBpZiAobGVzc29uU3RyaW5nLmluZGV4T2YodW5pdEZpbHRlcikgIT09IC0xICYmIGZpbmFsQXJyLmluZGV4T2YoY3VycmVudExlc3NvbikgPT09IC0xKSB7XG4gICAgICAgIGZpbmFsQXJyLnB1c2goY3VycmVudExlc3Nvbik7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmluYWxBcnI7XG4gICAgfSwgW10pO1xuICB9XG5cbiAgb25GaWx0ZXJMZXNzb25zID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgc3ViamVjdEZpbHRlcnMsIHR5cGVGaWx0ZXJzLCBsZXNzb25zOiBhbGxMZXNzb25zIH0gPSB0aGlzLnN0YXRlO1xuICAgIGxldCBsZXNzb25zID0gYWxsTGVzc29ucztcbiAgICBpZiAoc3ViamVjdEZpbHRlcnMubGVuZ3RoKSB7XG4gICAgICBsZXNzb25zID0gbGVzc29ucy5maWx0ZXIobGVzc29uID0+IHN1YmplY3RGaWx0ZXJzLmluZGV4T2YobGVzc29uLnN1YmplY3QpICE9PSAtMSk7XG4gICAgfVxuICAgIGlmICh0eXBlRmlsdGVycy5sZW5ndGgpIHtcbiAgICAgIGxlc3NvbnMgPSBsZXNzb25zLmZpbHRlcihsZXNzb24gPT4gdHlwZUZpbHRlcnMuaW5kZXhPZihsZXNzb25UeXBlTWFwW2xlc3Nvbi50eXBlXSkgIT09IC0xKTtcbiAgICB9XG4gICAgcmV0dXJuIGxlc3NvbnM7XG4gIH1cblxuICBnZXRNYXBwYWJsZUxlc3NvbnMgPSAoKSA9PiB7XG4gICAgY29uc3QgeyBzdWJqZWN0RmlsdGVycywgdHlwZUZpbHRlcnMsIHNvcnQsIHVuaXRGaWx0ZXIsIHRpdGxlRmlsdGVyLCBsZXNzb25zIH0gPSB0aGlzLnN0YXRlO1xuICAgIGxldCBtYXBwYWJsZUxlc3NvbnMgPSBsZXNzb25zO1xuICAgIGlmICh0aXRsZUZpbHRlci5sZW5ndGgpIHtcbiAgICAgIG1hcHBhYmxlTGVzc29ucyA9IHRoaXMub25GaWx0ZXJCeVRpdGxlKCk7XG4gICAgfVxuICAgIGlmICh1bml0RmlsdGVyLmxlbmd0aCkge1xuICAgICAgbWFwcGFibGVMZXNzb25zID0gdGhpcy5vbkZpbHRlckJ5VW5pdCgpO1xuICAgIH1cbiAgICBpZiAoc3ViamVjdEZpbHRlcnMubGVuZ3RoIHx8IHR5cGVGaWx0ZXJzLmxlbmd0aCkge1xuICAgICAgbWFwcGFibGVMZXNzb25zID0gdGhpcy5vbkZpbHRlckxlc3NvbnMoKTtcbiAgICB9XG4gICAgaWYgKHNvcnQpIHtcbiAgICAgIHJldHVybiB0aGlzLm9uU29ydExlc3NvbnMobWFwcGFibGVMZXNzb25zKTtcbiAgICB9XG4gICAgcmV0dXJuIG1hcHBhYmxlTGVzc29ucztcbiAgfVxuXG4gIGhhbmRsZUZpbHRlckNsaWNrID0gKGZpbHRlclR5cGUsIGZpbHRlcikgPT4ge1xuICAgIGNvbnN0IHsgc3ViamVjdEZpbHRlcnM6IGN1cnJlbnRTdWJqZWN0RmlsdGVycywgdHlwZUZpbHRlcnM6IGN1cnJlbnRUeXBlRmlsdGVycyB9ID0gdGhpcy5zdGF0ZTtcbiAgICBsZXQgbW9kaWZpZWRGaWx0ZXJDdXJyZW50U3RhdGU7XG4gICAgbGV0IG1vZGlmaWVkRmlsdGVyTmFtZTtcbiAgICBsZXQgbW9kaWZpZWRGaWx0ZXJVcGRhdGVkU3RhdGU7XG4gICAgc3dpdGNoIChmaWx0ZXJUeXBlKSB7XG4gICAgICBjYXNlICdzdWJqZWN0JzpcbiAgICAgICAgbW9kaWZpZWRGaWx0ZXJDdXJyZW50U3RhdGUgPSBjdXJyZW50U3ViamVjdEZpbHRlcnM7XG4gICAgICAgIG1vZGlmaWVkRmlsdGVyTmFtZSA9ICdzdWJqZWN0RmlsdGVycyc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAndHlwZSc6XG4gICAgICAgIG1vZGlmaWVkRmlsdGVyQ3VycmVudFN0YXRlID0gY3VycmVudFR5cGVGaWx0ZXJzO1xuICAgICAgICBtb2RpZmllZEZpbHRlck5hbWUgPSAndHlwZUZpbHRlcnMnO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBpZiAobW9kaWZpZWRGaWx0ZXJDdXJyZW50U3RhdGUuaW5kZXhPZihmaWx0ZXIpID09PSAtMSkge1xuICAgICAgbW9kaWZpZWRGaWx0ZXJVcGRhdGVkU3RhdGUgPSB1cGRhdGUobW9kaWZpZWRGaWx0ZXJDdXJyZW50U3RhdGUsIHtcbiAgICAgICAgJHB1c2g6IFtmaWx0ZXJdLFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGZpbHRlckluZGV4ID0gbW9kaWZpZWRGaWx0ZXJDdXJyZW50U3RhdGUuaW5kZXhPZihmaWx0ZXIpO1xuICAgICAgbW9kaWZpZWRGaWx0ZXJVcGRhdGVkU3RhdGUgPSB1cGRhdGUobW9kaWZpZWRGaWx0ZXJDdXJyZW50U3RhdGUsIHtcbiAgICAgICAgJHNwbGljZTogW1sgZmlsdGVySW5kZXgsIDEgXV0sXG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5zZXRTdGF0ZSh7IFttb2RpZmllZEZpbHRlck5hbWVdOiBtb2RpZmllZEZpbHRlclVwZGF0ZWRTdGF0ZSB9KTtcbiAgfVxuXG4gIGhhbmRsZUxlc3NvbkNsaWNrID0gKGxlc3NvbikgPT4ge1xuICAgIGNvbnN0IHsgc2VsZWN0ZWRMZXNzb25zIH0gPSB0aGlzLnN0YXRlO1xuICAgIGxldCBtb2RpZmllZExlc3NvbnM7XG4gICAgaWYgKHNlbGVjdGVkTGVzc29ucy5pbmRleE9mKGxlc3NvbikgPT09IC0xKSB7XG4gICAgICBtb2RpZmllZExlc3NvbnMgPSB1cGRhdGUoc2VsZWN0ZWRMZXNzb25zLCB7XG4gICAgICAgICRwdXNoOiBbbGVzc29uXSxcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBsZXNzb25JbmRleCA9IHNlbGVjdGVkTGVzc29ucy5pbmRleE9mKGxlc3Nvbik7XG4gICAgICBtb2RpZmllZExlc3NvbnMgPSB1cGRhdGUoc2VsZWN0ZWRMZXNzb25zLCB7XG4gICAgICAgICRzcGxpY2U6IFtbIGxlc3NvbkluZGV4LCAxIF1dLFxuICAgICAgfSk7XG4gICAgfVxuICAgIHRoaXMuc2V0U3RhdGUoeyBzZWxlY3RlZExlc3NvbnM6IG1vZGlmaWVkTGVzc29ucyB9KTtcbiAgfVxuXG4gIGFzc2lnbkxlc3NvbnMgPSAoZGF0ZSkgPT4ge1xuICAgIGNvbnN0IHsgb25Bc3NpZ25MZXNzb25zIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHsgc2VsZWN0ZWRMZXNzb25zIH0gPSB0aGlzLnN0YXRlO1xuICAgIGxldCBhc3NpZ25EYXRlO1xuICAgIHN3aXRjaCAoZGF0ZSkge1xuICAgICAgY2FzZSAndG9kYXknOlxuICAgICAgICBhc3NpZ25EYXRlID0gbW9tZW50KCkuZm9ybWF0KCdNTS9ERC9ZWScpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3RvbW9ycm93JzpcbiAgICAgICAgYXNzaWduRGF0ZSA9IG1vbWVudCgpLmFkZCgxLCAnZGF5cycpLmZvcm1hdCgnTU0vREQvWVknKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICduZXh0U2Vzc2lvbic6XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnY3VzdG9tRGF0ZSc6XG4gICAgICAgIGFzc2lnbkRhdGUgPSAnMDEvMDUvMTknO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICB0aGlzLm9uVG9nZ2xlQXNzaWduU2VsZWN0ZWREcm9wZG93bigpO1xuICAgIHRoaXMub25SZXNldE1vZGFsKCk7XG4gICAgb25Bc3NpZ25MZXNzb25zKHNlbGVjdGVkTGVzc29ucywgYXNzaWduRGF0ZSk7XG4gIH1cblxuICBtYXBMZXNzb25zID0gKCkgPT4gdGhpcy5nZXRNYXBwYWJsZUxlc3NvbnMoKS5tYXAoKGxlc3NvbiwgaW5kZXgpID0+IChcbiAgICA8TGVzc29uQ2FyZFxuICAgICAgbGVzc29uPXtsZXNzb259XG4gICAgICBpbmRleD17aW5kZXh9XG4gICAgICBrZXk9e2xlc3Nvbi5pZH1cbiAgICAgIG9uU2V0RHJvcGRvd249e3RoaXMub25TZXREcm9wZG93bn1cbiAgICAgIG9uQ2xvc2VEcm9wZG93bj17dGhpcy5vbkNsb3NlRHJvcGRvd259XG4gICAgICBkcm9wZG93bkluZGV4PXt0aGlzLnN0YXRlLmRyb3Bkb3duSW5kZXh9XG4gICAgICBkcm9wZG93bklzT3Blbj17dGhpcy5zdGF0ZS5kcm9wZG93bklzT3Blbn1cbiAgICAgIGhhbmRsZUxlc3NvbkNsaWNrPXt0aGlzLmhhbmRsZUxlc3NvbkNsaWNrfVxuICAgICAgc2VsZWN0ZWRMZXNzb25zPXt0aGlzLnN0YXRlLnNlbGVjdGVkTGVzc29uc31cbiAgICAvPlxuICApKVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IG9wZW4gfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgeyBhc3NpZ25TZWxlY3RlZERyb3Bkb3duT3Blbiwgc3ViamVjdEZpbHRlcnMsIHR5cGVGaWx0ZXJzLCBzb3J0IH0gPSB0aGlzLnN0YXRlO1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2PlxuICAgICAgICB7b3BlbiAmJiAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3cmFwcGVyXCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2FyZC1tb2RhbCBjYXJkLW1haW4gY2FyZCBzd2l0Y2hlci1zZWN0aW9uIGdyZXkgbGlnaHRlbi0zXCIgc3R5bGUgPSB7e21pbldpZHRoOlwiMTAwJVwifX0+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJoZWFkZXItcm93IGNhcmQtcGFuZWwgbGlnaHQtYmx1ZSBsaWdodGVuLTEgd2hpdGUtdGV4dFwiPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjYXJkLXBhbmVsLXJvdyByb3dcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2wgczExXCI+XG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJkLWZsZXhcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaWNvbi1jb2xcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiaWNvbi1ib29rcy1sXCI+PC9pPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNhcmQtcGFuZWwtdGV4dFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtbGFyZ2VcIj5Bc3NpZ24gTGVzc29uczwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbCBzMSByaWdodC1hbGlnblwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicm93IGljb25zLXJvd1wiPjxhIGhyZWY9XCIjXCIgb25DbGljaz17dGhpcy5vbkNsb3NlTW9kYWx9IGNsYXNzTmFtZT1cIm1vZGFsLWNsb3NlIGNsb3NlXCI+PGkgY2xhc3NOYW1lPVwiaWNvbi1jbG9zZS10aGluXCI+PC9pPjwvYT48L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8RmlsdGVyU2VjdGlvblxuICAgICAgICAgICAgICAgICAgc29ydD17c29ydH1cbiAgICAgICAgICAgICAgICAgIHR5cGVGaWx0ZXJzPXt0eXBlRmlsdGVyc31cbiAgICAgICAgICAgICAgICAgIHN1YmplY3RGaWx0ZXJzPXtzdWJqZWN0RmlsdGVyc31cbiAgICAgICAgICAgICAgICAgIG9uU2V0U29ydD17dGhpcy5vblNldFNvcnR9XG4gICAgICAgICAgICAgICAgICBvbkNsZWFyRmlsdGVycz17dGhpcy5vblJlc2V0TW9kYWx9XG4gICAgICAgICAgICAgICAgICBoYW5kbGVGaWx0ZXJDbGljaz17dGhpcy5oYW5kbGVGaWx0ZXJDbGlja31cbiAgICAgICAgICAgICAgICAgIG9uU2V0RmlsdGVyZWRTdGF0ZT17dGhpcy5vblNldEZpbHRlcmVkU3RhdGV9XG4gICAgICAgICAgICAgICAgICBvblVuc2V0RmlsdGVyZWRTdGF0ZT17dGhpcy5vblVuc2V0RmlsdGVyZWRTdGF0ZX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2FyZC1jb250ZW50XCI+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNhcmQtYm9keVwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInJlc3VsdC1yb3cgY2VudGVyLWFsaWduXCI+XG4gICAgICAgICAgICAgICAgICAgICAgPGIgY2xhc3NOYW1lPVwicmVzdWx0XCI+IC0ge3RoaXMuZ2V0TWFwcGFibGVMZXNzb25zKCkubGVuZ3RofSByZXN1bHRzIC08L2I+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNoZWNrYm94ZXMtc2VjdGlvbiByb3cgZC1mbGV4LWNvbnRlbnQgY2FyZC13aWR0aC0zMjJcIj5cbiAgICAgICAgICAgICAgICAgICAgICB7dGhpcy5tYXBMZXNzb25zKCl9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFkZC1idG4tYmxvY2tcIj5cbiAgICAgICAgICAgICAgICA8YVxuICAgICAgICAgICAgICAgICAgaHJlZj1cIiNcIlxuICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vblRvZ2dsZUFzc2lnblNlbGVjdGVkRHJvcGRvd259XG4gICAgICAgICAgICAgICAgICBkYXRhLXRhcmdldD0nZHJvcGRvd25fYXNzaWduX3NlbGVjdGVkX2xlc3NvbnMnXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJkcm9wZG93bi10cmlnZ2VyIHdhdmVzLWVmZmVjdCB3YXZlcy10ZWFsIGJ0biBhZGQtYnRuXCJcbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJtYXRlcmlhbC1pY29uc1wiPmFkZDwvaT4gQXNzaWduIFNlbGVjdGVkXG4gICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgIDx1bFxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSdkcm9wZG93bi1jb250ZW50J1xuICAgICAgICAgICAgICAgICAgaWQ9J2Ryb3Bkb3duX2Fzc2lnbl9zZWxlY3RlZF9sZXNzb25zJ1xuICAgICAgICAgICAgICAgICAgc3R5bGU9e3sgZGlzcGxheTogYXNzaWduU2VsZWN0ZWREcm9wZG93bk9wZW4gPyAnYmxvY2snIDogJzAnLCBvcGFjaXR5OiBhc3NpZ25TZWxlY3RlZERyb3Bkb3duT3BlbiA/ICcxJyA6ICcwJyB9fVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiI1wiIG9uQ2xpY2s9eygpID0+IHRoaXMuYXNzaWduTGVzc29ucygndG9kYXknKX0+Rm9yIFRvZGF5PC9hPjwvbGk+XG4gICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cIiNcIiBvbkNsaWNrPXsoKSA9PiB0aGlzLmFzc2lnbkxlc3NvbnMoJ3RvbW9ycm93Jyl9PkZvciBUb21vcnJvdzwvYT48L2xpPlxuICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCIjXCIgb25DbGljaz17KCkgPT4gdGhpcy5hc3NpZ25MZXNzb25zKCduZXh0U2Vzc2lvbicpfT5Gb3IgTmV4dCBTZXNzaW9uPC9hPjwvbGk+XG4gICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cIiNcIiBvbkNsaWNrPXsoKSA9PiB0aGlzLmFzc2lnbkxlc3NvbnMoJ2N1c3RvbURhdGUnKX0+Rm9yIERhdGUuLi48L2E+PC9saT5cbiAgICAgICAgICAgICAgICA8L3VsPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKX1cbiAgICAgICAgPHN0eWxlIGpzeD5cbiAgICAgICAgICB7YFxuICAgICAgICAgICAgLmNhcmQtbW9kYWwge1xuICAgICAgICAgICAgICBtYXJnaW46IDA7XG4gICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDZweDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC5tb2RhbC1jdXN0b20ge1xuICAgICAgICAgICAgICBvcGFjaXR5OiAxO1xuICAgICAgICAgICAgICB2aXNpYmlsaXR5OiB2aXNpYmxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLm1vZGFsLWZvb3RlciB7XG4gICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIGB9XG4gICAgICAgIDwvc3R5bGU+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG59XG5cbkFzc2lnbkxlc3Nvbk1vZGFsLnByb3BUeXBlcyA9IHtcbiAgb3BlbjogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgb25DbG9zZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgb25Bc3NpZ25MZXNzb25zOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxufTtcblxuZXhwb3J0IGRlZmF1bHQgQXNzaWduTGVzc29uTW9kYWw7XG4iXX0= */\\n/*@ sourceURL=/Users/wolf/Documents/clearchoice/admin/feature-view-updated-course/clear-choice-admin/components/Dashboard/components/Modals/AssignLessonModal/index.js */\"));\n    }\n  }]);\n\n  return AssignLessonModal;\n}(React.Component);\n\nAssignLessonModal.propTypes = {\n  open: PropTypes.bool.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onAssignLessons: PropTypes.func.isRequired\n};\nexport default AssignLessonModal;","map":{"version":3,"sources":["/Users/wolf/Documents/clearchoice/admin/feature-view-updated-course/clear-choice-admin/components/Dashboard/components/Modals/AssignLessonModal/index.js"],"names":["React","PropTypes","update","moment","FilterSection","LessonCard","sampleLessons","pageNumberSort","problemSort","timeEstimateSort","subjectSort","lessonTypeMap","AssignLessonModal","props","setState","assignSelectedDropdownOpen","dropdownIndex","dropdownIsOpen","subjectFilters","typeFilters","sort","titleFilter","value","onClose","onResetModal","lessons","state","reduce","finalArr","currentLesson","title","lessonString","replace","toLowerCase","indexOf","push","unitFilter","unit","allLessons","length","filter","lesson","subject","type","mappableLessons","onFilterByTitle","onFilterByUnit","onFilterLessons","onSortLessons","filterType","currentSubjectFilters","currentTypeFilters","modifiedFilterCurrentState","modifiedFilterName","modifiedFilterUpdatedState","$push","filterIndex","$splice","selectedLessons","modifiedLessons","lessonIndex","date","onAssignLessons","assignDate","format","add","onToggleAssignSelectedDropdown","getMappableLessons","map","index","id","onSetDropdown","onCloseDropdown","handleLessonClick","open","minWidth","onCloseModal","onSetSort","handleFilterClick","onSetFilteredState","onUnsetFilteredState","mapLessons","display","opacity","assignLessons","Component","propTypes","bool","isRequired","func"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport update from 'immutability-helper';\nimport moment from 'moment';\n\nimport FilterSection from './components/FilterSection';\nimport LessonCard from './components/LessonCard';\nimport sampleLessons from '../../../utils/sampleLessons';\nimport { pageNumberSort, problemSort, timeEstimateSort, subjectSort } from '../../../utils/sortOptions';\n\nconst lessonTypeMap = {\n  'Challenge + Practice': 'challenge',\n  'Homework Drill': 'homework',\n  'Reading from Workbook': 'readingFromWorkbook',\n};\n\nclass AssignLessonModal extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      sort: '',\n      unitFilter: '',\n      titleFilter: '',\n      typeFilters: [],\n      subjectFilters: [],\n      selectedLessons: [],\n      lessons: sampleLessons,\n      dropdownIndex: null,\n      dropdownIsOpen: false,\n      assignSelectedDropdownOpen: false,\n    };\n  }\n\n  onToggleAssignSelectedDropdown = () => this.setState(({ assignSelectedDropdownOpen }) => ({ assignSelectedDropdownOpen: !assignSelectedDropdownOpen }))\n\n  onSetDropdown = (dropdownIndex) => this.setState({ dropdownIndex, dropdownIsOpen: true });\n  onCloseDropdown = () => this.setState({ dropdownIsOpen: false });\n\n  onResetModal = () => this.setState({ subjectFilters: [], typeFilters: [], sort: '' })\n  onSetSort = (sort) => this.setState({ sort })\n\n  onSetFilteredState = (titleFilter, value) => this.setState({ [titleFilter]: value })\n  onUnsetFilteredState = (titleFilter) => this.setState({ [titleFilter]: '' })\n\n  onCloseModal = () => {\n    const { onClose } = this.props;\n    onClose();\n    this.onResetModal();\n  }\n\n  // eslint-disable-next-line consistent-return\n  onSortLessons = (lessons) => {\n    const { sort } = this.state;\n    switch (sort) {\n      case 'pageNumber':\n        return lessons.sort(pageNumberSort);\n      case 'problems':\n        return lessons.sort(problemSort);\n      case 'timeEstimate':\n        return lessons.sort(timeEstimateSort);\n      case 'subject':\n        return lessons.sort(subjectSort);\n      default:\n        break;\n    }\n  }\n\n  onFilterByTitle = () => {\n    const { lessons, titleFilter } = this.state;\n    return lessons.reduce((finalArr, currentLesson) => {\n      const { title } = currentLesson;\n      const lessonString = title.replace(/\\s/g, \"\").toLowerCase();\n      if (lessonString.indexOf(titleFilter) !== -1 && finalArr.indexOf(currentLesson) === -1) {\n        finalArr.push(currentLesson);\n      }\n      return finalArr;\n    }, []);\n  }\n\n  onFilterByUnit = () => {\n    const { lessons, unitFilter } = this.state;\n    return lessons.reduce((finalArr, currentLesson) => {\n      const { unit } = currentLesson;\n      const lessonString = unit.replace(/\\s/g, \"\").toLowerCase();\n      if (lessonString.indexOf(unitFilter) !== -1 && finalArr.indexOf(currentLesson) === -1) {\n        finalArr.push(currentLesson);\n      }\n      return finalArr;\n    }, []);\n  }\n\n  onFilterLessons = () => {\n    const { subjectFilters, typeFilters, lessons: allLessons } = this.state;\n    let lessons = allLessons;\n    if (subjectFilters.length) {\n      lessons = lessons.filter(lesson => subjectFilters.indexOf(lesson.subject) !== -1);\n    }\n    if (typeFilters.length) {\n      lessons = lessons.filter(lesson => typeFilters.indexOf(lessonTypeMap[lesson.type]) !== -1);\n    }\n    return lessons;\n  }\n\n  getMappableLessons = () => {\n    const { subjectFilters, typeFilters, sort, unitFilter, titleFilter, lessons } = this.state;\n    let mappableLessons = lessons;\n    if (titleFilter.length) {\n      mappableLessons = this.onFilterByTitle();\n    }\n    if (unitFilter.length) {\n      mappableLessons = this.onFilterByUnit();\n    }\n    if (subjectFilters.length || typeFilters.length) {\n      mappableLessons = this.onFilterLessons();\n    }\n    if (sort) {\n      return this.onSortLessons(mappableLessons);\n    }\n    return mappableLessons;\n  }\n\n  handleFilterClick = (filterType, filter) => {\n    const { subjectFilters: currentSubjectFilters, typeFilters: currentTypeFilters } = this.state;\n    let modifiedFilterCurrentState;\n    let modifiedFilterName;\n    let modifiedFilterUpdatedState;\n    switch (filterType) {\n      case 'subject':\n        modifiedFilterCurrentState = currentSubjectFilters;\n        modifiedFilterName = 'subjectFilters';\n        break;\n      case 'type':\n        modifiedFilterCurrentState = currentTypeFilters;\n        modifiedFilterName = 'typeFilters';\n        break;\n      default:\n        break;\n    }\n    if (modifiedFilterCurrentState.indexOf(filter) === -1) {\n      modifiedFilterUpdatedState = update(modifiedFilterCurrentState, {\n        $push: [filter],\n      });\n    } else {\n      const filterIndex = modifiedFilterCurrentState.indexOf(filter);\n      modifiedFilterUpdatedState = update(modifiedFilterCurrentState, {\n        $splice: [[ filterIndex, 1 ]],\n      });\n    }\n    this.setState({ [modifiedFilterName]: modifiedFilterUpdatedState });\n  }\n\n  handleLessonClick = (lesson) => {\n    const { selectedLessons } = this.state;\n    let modifiedLessons;\n    if (selectedLessons.indexOf(lesson) === -1) {\n      modifiedLessons = update(selectedLessons, {\n        $push: [lesson],\n      });\n    } else {\n      const lessonIndex = selectedLessons.indexOf(lesson);\n      modifiedLessons = update(selectedLessons, {\n        $splice: [[ lessonIndex, 1 ]],\n      });\n    }\n    this.setState({ selectedLessons: modifiedLessons });\n  }\n\n  assignLessons = (date) => {\n    const { onAssignLessons } = this.props;\n    const { selectedLessons } = this.state;\n    let assignDate;\n    switch (date) {\n      case 'today':\n        assignDate = moment().format('MM/DD/YY');\n        break;\n      case 'tomorrow':\n        assignDate = moment().add(1, 'days').format('MM/DD/YY');\n        break;\n      case 'nextSession':\n        break;\n      case 'customDate':\n        assignDate = '01/05/19';\n        break;\n      default:\n        break;\n    }\n    this.onToggleAssignSelectedDropdown();\n    this.onResetModal();\n    onAssignLessons(selectedLessons, assignDate);\n  }\n\n  mapLessons = () => this.getMappableLessons().map((lesson, index) => (\n    <LessonCard\n      lesson={lesson}\n      index={index}\n      key={lesson.id}\n      onSetDropdown={this.onSetDropdown}\n      onCloseDropdown={this.onCloseDropdown}\n      dropdownIndex={this.state.dropdownIndex}\n      dropdownIsOpen={this.state.dropdownIsOpen}\n      handleLessonClick={this.handleLessonClick}\n      selectedLessons={this.state.selectedLessons}\n    />\n  ))\n\n  render() {\n    const { open } = this.props;\n    const { assignSelectedDropdownOpen, subjectFilters, typeFilters, sort } = this.state;\n    return (\n      <div>\n        {open && (\n          <div className=\"wrapper\">\n              <div className=\"card-modal card-main card switcher-section grey lighten-3\" style = {{minWidth:\"100%\"}}>\n                <div className=\"header-row card-panel light-blue lighten-1 white-text\">\n                  <div className=\"card-panel-row row\">\n                    <div className=\"col s11\">\n                      <div className=\"d-flex\">\n                        <div className=\"icon-col\">\n                          <i className=\"icon-books-l\"></i>\n                        </div>\n                        <div className=\"card-panel-text\">\n                          <div className=\"text-large\">Assign Lessons</div>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"col s1 right-align\">\n                      <div className=\"row icons-row\"><a href=\"#\" onClick={this.onCloseModal} className=\"modal-close close\"><i className=\"icon-close-thin\"></i></a></div>\n                    </div>\n                  </div>\n                </div>\n                <FilterSection\n                  sort={sort}\n                  typeFilters={typeFilters}\n                  subjectFilters={subjectFilters}\n                  onSetSort={this.onSetSort}\n                  onClearFilters={this.onResetModal}\n                  handleFilterClick={this.handleFilterClick}\n                  onSetFilteredState={this.onSetFilteredState}\n                  onUnsetFilteredState={this.onUnsetFilteredState}\n                />\n                <div className=\"card-content\">\n                  <div className=\"card-body\">\n                    <div className=\"result-row center-align\">\n                      <b className=\"result\"> - {this.getMappableLessons().length} results -</b>\n                    </div>\n                    <div className=\"checkboxes-section row d-flex-content card-width-322\">\n                      {this.mapLessons()}\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div className=\"add-btn-block\">\n                <a\n                  href=\"#\"\n                  onClick={this.onToggleAssignSelectedDropdown}\n                  data-target='dropdown_assign_selected_lessons'\n                  className=\"dropdown-trigger waves-effect waves-teal btn add-btn\"\n                >\n                  <i className=\"material-icons\">add</i> Assign Selected\n                </a>\n                <ul\n                  className='dropdown-content'\n                  id='dropdown_assign_selected_lessons'\n                  style={{ display: assignSelectedDropdownOpen ? 'block' : '0', opacity: assignSelectedDropdownOpen ? '1' : '0' }}\n                >\n                  <li><a href=\"#\" onClick={() => this.assignLessons('today')}>For Today</a></li>\n                  <li><a href=\"#\" onClick={() => this.assignLessons('tomorrow')}>For Tomorrow</a></li>\n                  <li><a href=\"#\" onClick={() => this.assignLessons('nextSession')}>For Next Session</a></li>\n                  <li><a href=\"#\" onClick={() => this.assignLessons('customDate')}>For Date...</a></li>\n                </ul>\n              </div>\n          </div>\n        )}\n        <style jsx>\n          {`\n            .card-modal {\n              margin: 0;\n              border-radius: 6px;\n            }\n            .modal-custom {\n              opacity: 1;\n              visibility: visible;\n            }\n            .modal-footer {\n              background-color: white;\n            }\n          `}\n        </style>\n      </div>\n    );\n  }\n}\n\nAssignLessonModal.propTypes = {\n  open: PropTypes.bool.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onAssignLessons: PropTypes.func.isRequired,\n};\n\nexport default AssignLessonModal;\n"]},"metadata":{},"sourceType":"module"}