{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/wolf/Documents/clearchoice/admin/feature-view-updated-course/clear-choice-admin/components/Student/DropDownMenu/index.js\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from \"react\";\nimport { compose, bindActionCreators } from \"redux\";\nimport { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\nimport moment from 'moment';\nimport ClickOffComponentWrapper from \"../../ClickOffComponentWrapper\";\nimport { renderDropdownOptions } from \"../DetailLessonList/components/FullView/components/LessonCard/utils/\";\nimport RescheduleModal from \"../DetailLessonList/components/RescheduleModal\";\nimport { setIsVisibleTopBar, setActiveLesson, setOpenActivePage, rescheduleStudentLessons, unAssignLessonToStudent, resetStudentLessons } from \"../index/actions\";\n\nvar DropDownMenu =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(DropDownMenu, _React$Component);\n\n  function DropDownMenu() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, DropDownMenu);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(DropDownMenu)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      openRescheduleModal: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"leaveDetailView\", function () {\n      var _this$props = _this.props,\n          onSetIsVisibleTopbar = _this$props.onSetIsVisibleTopbar,\n          onSetActiveLesson = _this$props.onSetActiveLesson,\n          onSetOpenActivePage = _this$props.onSetOpenActivePage,\n          onCloseDetailModal = _this$props.onCloseDetailModal;\n      onSetIsVisibleTopbar(true);\n      onSetActiveLesson({});\n      onSetOpenActivePage(\"\");\n      onCloseDetailModal();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onToggleRescheduleModal\", function () {\n      return _this.setState({\n        openRescheduleModal: !_this.state.openRescheduleModal\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleAssignLesson\", function () {\n      var _this$props2 = _this.props,\n          onOpenModal = _this$props2.onOpenModal,\n          onAddCheckedLesson = _this$props2.onAddCheckedLesson,\n          lesson = _this$props2.lesson;\n      onOpenModal();\n      onAddCheckedLesson(lesson.lesson_id);\n\n      _this.leaveDetailView();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleRescheduleModalOpen\", function () {\n      var onCloseDropdown = _this.props.onCloseDropdown;\n      onCloseDropdown();\n\n      _this.onToggleRescheduleModal();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSaveScheduleChanges\", function (modalState) {\n      var _this$props3 = _this.props,\n          onRescheduleStudentLessons = _this$props3.onRescheduleStudentLessons,\n          lesson = _this$props3.lesson,\n          resetLessonSelections = _this$props3.resetLessonSelections,\n          onSetActiveLesson = _this$props3.onSetActiveLesson;\n      var payload = {\n        student_lesson_ids: [lesson.id],\n        assignment_date: moment(modalState.assignDate).format('YYYY-MM-DD'),\n        due_date: !modalState.isTimed ? moment(modalState.dueDate).format('YYYY-MM-DD') : null\n      };\n\n      if (_Object$keys(payload).length > 0 && typeof payload === 'object') {\n        onRescheduleStudentLessons(payload);\n\n        _this.onToggleRescheduleModal();\n\n        resetLessonSelections();\n        onSetActiveLesson(_objectSpread({}, lesson, {\n          assignment_date: moment(modalState.assignDate).format('YYYY-MM-DD'),\n          due_date: !modalState.isTimed ? moment(modalState.dueDate).format('YYYY-MM-DD') : null\n        }));\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleUnassignLesson\", function (lessonIds) {\n      var _this$props4 = _this.props,\n          onUnAssignLessonToStudent = _this$props4.onUnAssignLessonToStudent,\n          onCloseDropdown = _this$props4.onCloseDropdown,\n          resetLessonSelections = _this$props4.resetLessonSelections;\n\n      if (lessonIds && typeof lessonIds === 'object' && lessonIds.length > 0) {\n        onUnAssignLessonToStudent(lessonIds);\n        onCloseDropdown();\n\n        _this.leaveDetailView();\n\n        resetLessonSelections();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleResetLesson\", function (lessonIds) {\n      var _this$props5 = _this.props,\n          onResetStudentLessons = _this$props5.onResetStudentLessons,\n          onCloseDropdown = _this$props5.onCloseDropdown,\n          resetLessonSelections = _this$props5.resetLessonSelections;\n\n      if (lessonIds && typeof lessonIds === 'object' && lessonIds.length > 0) {\n        onResetStudentLessons(lessonIds);\n        onCloseDropdown();\n\n        _this.leaveDetailView();\n\n        resetLessonSelections();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"startMarkFlagsReviewed\", function (lessonIds) {\n      var _this$props6 = _this.props,\n          problems = _this$props6.problems,\n          updateProblemList = _this$props6.updateProblemList;\n\n      _this.props.handleMarkAllFlagsReviewed(lessonIds);\n\n      problems.map(function (problemList) {\n        problemList.problems.map(function (problem) {\n          if (problem.flag_status === 'FLAGGED') {\n            updateProblemList(problemList.type, _objectSpread({}, problem, {\n              flag_status: 'REVIEWED'\n            }));\n          }\n        });\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(DropDownMenu, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var lesson = this.props.lesson;\n      return __jsx(React.Fragment, null, __jsx(RescheduleModal, {\n        open: this.state.openRescheduleModal,\n        lesson: lesson,\n        onClose: this.handleRescheduleModalOpen,\n        onSave: this.onSaveScheduleChanges,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }), this.props.dropdownIsOpen ? __jsx(ClickOffComponentWrapper, {\n        onOuterClick: function onOuterClick() {\n          return _this2.props.onSetDropdown();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }, __jsx(\"ul\", {\n        id: \"dropdown01\",\n        className: \"dropdown-content dropdown-wide\",\n        style: {\n          display: \"block\",\n          opacity: \"1\",\n          transform: \"scaleX(1) scaleY(1)\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, renderDropdownOptions(lesson.status, this.handleAssignLesson, this.handleRescheduleModalOpen, this.props.handleExcuseLessonLateness, this.handleResetLesson, this.startMarkFlagsReviewed, this.handleUnassignLesson, [lesson.id]))) : null);\n    }\n  }]);\n\n  return DropDownMenu;\n}(React.Component);\n\nDropDownMenu.propTypes = {\n  onCloseDetailModal: PropTypes.func.isRequired,\n  user: PropTypes.object.isRequired,\n  lesson: PropTypes.object.isRequired,\n  onOpenModal: PropTypes.func.isRequired,\n  onAddCheckedLesson: PropTypes.func.isRequired,\n  onCloseDropdown: PropTypes.func.isRequired,\n  resetLessonSelections: PropTypes.func.isRequired\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return _defineProperty({\n    onSetIsVisibleTopbar: bindActionCreators(setIsVisibleTopBar, dispatch),\n    onSetActiveLesson: bindActionCreators(setActiveLesson, dispatch),\n    onSetOpenActivePage: bindActionCreators(setOpenActivePage, dispatch),\n    onRescheduleStudentLessons: bindActionCreators(rescheduleStudentLessons, dispatch),\n    onUnAssignLessonToStudent: bindActionCreators(unAssignLessonToStudent, dispatch),\n    onResetStudentLessons: bindActionCreators(resetStudentLessons, dispatch)\n  }, \"onSetActiveLesson\", bindActionCreators(setActiveLesson, dispatch));\n};\n\nvar withConnect = connect(null, mapDispatchToProps);\nexport default compose(withConnect)(DropDownMenu);","map":{"version":3,"sources":["/Users/wolf/Documents/clearchoice/admin/feature-view-updated-course/clear-choice-admin/components/Student/DropDownMenu/index.js"],"names":["React","compose","bindActionCreators","connect","PropTypes","moment","ClickOffComponentWrapper","renderDropdownOptions","RescheduleModal","setIsVisibleTopBar","setActiveLesson","setOpenActivePage","rescheduleStudentLessons","unAssignLessonToStudent","resetStudentLessons","DropDownMenu","openRescheduleModal","props","onSetIsVisibleTopbar","onSetActiveLesson","onSetOpenActivePage","onCloseDetailModal","setState","state","onOpenModal","onAddCheckedLesson","lesson","lesson_id","leaveDetailView","onCloseDropdown","onToggleRescheduleModal","modalState","onRescheduleStudentLessons","resetLessonSelections","payload","student_lesson_ids","id","assignment_date","assignDate","format","due_date","isTimed","dueDate","length","lessonIds","onUnAssignLessonToStudent","onResetStudentLessons","problems","updateProblemList","handleMarkAllFlagsReviewed","map","problemList","problem","flag_status","type","handleRescheduleModalOpen","onSaveScheduleChanges","dropdownIsOpen","onSetDropdown","display","opacity","transform","status","handleAssignLesson","handleExcuseLessonLateness","handleResetLesson","startMarkFlagsReviewed","handleUnassignLesson","Component","propTypes","func","isRequired","user","object","mapDispatchToProps","dispatch","withConnect"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,OAAT,EAAkBC,kBAAlB,QAA4C,OAA5C;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,OAAOC,wBAAP,MAAqC,gCAArC;AACA,SAASC,qBAAT,QAAsC,sEAAtC;AACA,OAAOC,eAAP,MAA4B,gDAA5B;AAEA,SACEC,kBADF,EAEEC,eAFF,EAGEC,iBAHF,EAIEC,wBAJF,EAKEC,uBALF,EAMEC,mBANF,QAOO,kBAPP;;IASMC,Y;;;;;;;;;;;;;;;;;;4DACI;AACNC,MAAAA,mBAAmB,EAAE;AADf,K;;sEAIU,YAAM;AAAA,wBAMlB,MAAKC,KANa;AAAA,UAEpBC,oBAFoB,eAEpBA,oBAFoB;AAAA,UAGpBC,iBAHoB,eAGpBA,iBAHoB;AAAA,UAIpBC,mBAJoB,eAIpBA,mBAJoB;AAAA,UAKpBC,kBALoB,eAKpBA,kBALoB;AAOtBH,MAAAA,oBAAoB,CAAC,IAAD,CAApB;AACAC,MAAAA,iBAAiB,CAAC,EAAD,CAAjB;AACAC,MAAAA,mBAAmB,CAAC,EAAD,CAAnB;AACAC,MAAAA,kBAAkB;AACnB,K;;8EAEyB;AAAA,aAAM,MAAKC,QAAL,CAAc;AAAEN,QAAAA,mBAAmB,EAAE,CAAC,MAAKO,KAAL,CAAWP;AAAnC,OAAd,CAAN;AAAA,K;;yEAEL,YAAM;AAAA,yBAKrB,MAAKC,KALgB;AAAA,UAEvBO,WAFuB,gBAEvBA,WAFuB;AAAA,UAGvBC,kBAHuB,gBAGvBA,kBAHuB;AAAA,UAIvBC,MAJuB,gBAIvBA,MAJuB;AAMzBF,MAAAA,WAAW;AACXC,MAAAA,kBAAkB,CAACC,MAAM,CAACC,SAAR,CAAlB;;AACA,YAAKC,eAAL;AACD,K;;gFAE2B,YAAM;AAAA,UACxBC,eADwB,GACJ,MAAKZ,KADD,CACxBY,eADwB;AAEhCA,MAAAA,eAAe;;AACf,YAAKC,uBAAL;AACD,K;;4EAEuB,UAACC,UAAD,EAAgB;AAAA,yBACmD,MAAKd,KADxD;AAAA,UAC9Be,0BAD8B,gBAC9BA,0BAD8B;AAAA,UACFN,MADE,gBACFA,MADE;AAAA,UACMO,qBADN,gBACMA,qBADN;AAAA,UAC6Bd,iBAD7B,gBAC6BA,iBAD7B;AAEtC,UAAMe,OAAO,GAAG;AACdC,QAAAA,kBAAkB,EAAE,CAACT,MAAM,CAACU,EAAR,CADN;AAEdC,QAAAA,eAAe,EAAEhC,MAAM,CAAC0B,UAAU,CAACO,UAAZ,CAAN,CAA8BC,MAA9B,CAAqC,YAArC,CAFH;AAGdC,QAAAA,QAAQ,EAAE,CAACT,UAAU,CAACU,OAAZ,GAAsBpC,MAAM,CAAC0B,UAAU,CAACW,OAAZ,CAAN,CAA2BH,MAA3B,CAAkC,YAAlC,CAAtB,GAAwE;AAHpE,OAAhB;;AAKA,UAAI,aAAYL,OAAZ,EAAqBS,MAArB,GAA8B,CAA9B,IAAmC,OAAOT,OAAP,KAAmB,QAA1D,EAAoE;AAClEF,QAAAA,0BAA0B,CAACE,OAAD,CAA1B;;AACA,cAAKJ,uBAAL;;AACAG,QAAAA,qBAAqB;AACrBd,QAAAA,iBAAiB,mBAAMO,MAAN;AAAcW,UAAAA,eAAe,EAAEhC,MAAM,CAAC0B,UAAU,CAACO,UAAZ,CAAN,CAA8BC,MAA9B,CAAqC,YAArC,CAA/B;AAAmFC,UAAAA,QAAQ,EAAE,CAACT,UAAU,CAACU,OAAZ,GAAsBpC,MAAM,CAAC0B,UAAU,CAACW,OAAZ,CAAN,CAA2BH,MAA3B,CAAkC,YAAlC,CAAtB,GAAwE;AAArK,WAAjB;AACD;AACF,K;;2EAEsB,UAAAK,SAAS,EAAI;AAAA,yBAC4C,MAAK3B,KADjD;AAAA,UAC1B4B,yBAD0B,gBAC1BA,yBAD0B;AAAA,UACChB,eADD,gBACCA,eADD;AAAA,UACkBI,qBADlB,gBACkBA,qBADlB;;AAElC,UAAIW,SAAS,IAAI,OAAOA,SAAP,KAAqB,QAAlC,IAA8CA,SAAS,CAACD,MAAV,GAAmB,CAArE,EAAwE;AACtEE,QAAAA,yBAAyB,CAACD,SAAD,CAAzB;AACAf,QAAAA,eAAe;;AACf,cAAKD,eAAL;;AACAK,QAAAA,qBAAqB;AACtB;AACF,K;;wEAEmB,UAAAW,SAAS,EAAI;AAAA,yBAC2C,MAAK3B,KADhD;AAAA,UACvB6B,qBADuB,gBACvBA,qBADuB;AAAA,UACAjB,eADA,gBACAA,eADA;AAAA,UACiBI,qBADjB,gBACiBA,qBADjB;;AAE/B,UAAIW,SAAS,IAAI,OAAOA,SAAP,KAAqB,QAAlC,IAA8CA,SAAS,CAACD,MAAV,GAAmB,CAArE,EAAwE;AACtEG,QAAAA,qBAAqB,CAACF,SAAD,CAArB;AACAf,QAAAA,eAAe;;AACf,cAAKD,eAAL;;AACAK,QAAAA,qBAAqB;AACtB;AACF,K;;6EAEwB,UAACW,SAAD,EAAe;AAAA,yBACE,MAAK3B,KADP;AAAA,UAC9B8B,QAD8B,gBAC9BA,QAD8B;AAAA,UACpBC,iBADoB,gBACpBA,iBADoB;;AAEtC,YAAK/B,KAAL,CAAWgC,0BAAX,CAAsCL,SAAtC;;AACAG,MAAAA,QAAQ,CAACG,GAAT,CAAa,UAAAC,WAAW,EAAI;AAC1BA,QAAAA,WAAW,CAACJ,QAAZ,CAAqBG,GAArB,CAAyB,UAAAE,OAAO,EAAI;AAClC,cAAIA,OAAO,CAACC,WAAR,KAAwB,SAA5B,EAAuC;AACrCL,YAAAA,iBAAiB,CAACG,WAAW,CAACG,IAAb,oBAAwBF,OAAxB;AAAiCC,cAAAA,WAAW,EAAE;AAA9C,eAAjB;AACD;AACF,SAJD;AAKD,OAND;AAOD,K;;;;;;;6BAEQ;AAAA;;AAAA,UACC3B,MADD,GACY,KAAKT,KADjB,CACCS,MADD;AAEP,aACE,4BACE,MAAC,eAAD;AACE,QAAA,IAAI,EAAE,KAAKH,KAAL,CAAWP,mBADnB;AAEE,QAAA,MAAM,EAAEU,MAFV;AAGE,QAAA,OAAO,EAAE,KAAK6B,yBAHhB;AAIE,QAAA,MAAM,EAAE,KAAKC,qBAJf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAOiB,KAAKvC,KAAL,CAAWwC,cAP5B,GAQI,MAAC,wBAAD;AAA0B,QAAA,YAAY,EAAE;AAAA,iBAAM,MAAI,CAACxC,KAAL,CAAWyC,aAAX,EAAN;AAAA,SAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AACE,QAAA,EAAE,EAAC,YADL;AAEE,QAAA,SAAS,EAAC,gCAFZ;AAGE,QAAA,KAAK,EAAE;AACLC,UAAAA,OAAO,EAAE,OADJ;AAELC,UAAAA,OAAO,EAAE,GAFJ;AAGLC,UAAAA,SAAS,EAAE;AAHN,SAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SASGtD,qBAAqB,CACpBmB,MAAM,CAACoC,MADa,EAEpB,KAAKC,kBAFe,EAGpB,KAAKR,yBAHe,EAIpB,KAAKtC,KAAL,CAAW+C,0BAJS,EAKpB,KAAKC,iBALe,EAMpB,KAAKC,sBANe,EAOpB,KAAKC,oBAPe,EAQpB,CAACzC,MAAM,CAACU,EAAR,CARoB,CATxB,CADF,CARJ,QADF;AAkCD;;;;EAxHwBpC,KAAK,CAACoE,S;;AA2HjCrD,YAAY,CAACsD,SAAb,GAAyB;AACvBhD,EAAAA,kBAAkB,EAAEjB,SAAS,CAACkE,IAAV,CAAeC,UADZ;AAEvBC,EAAAA,IAAI,EAAEpE,SAAS,CAACqE,MAAV,CAAiBF,UAFA;AAGvB7C,EAAAA,MAAM,EAAEtB,SAAS,CAACqE,MAAV,CAAiBF,UAHF;AAIvB/C,EAAAA,WAAW,EAAEpB,SAAS,CAACkE,IAAV,CAAeC,UAJL;AAKvB9C,EAAAA,kBAAkB,EAAErB,SAAS,CAACkE,IAAV,CAAeC,UALZ;AAMvB1C,EAAAA,eAAe,EAAEzB,SAAS,CAACkE,IAAV,CAAeC,UANT;AAOvBtC,EAAAA,qBAAqB,EAAE7B,SAAS,CAACkE,IAAV,CAAeC;AAPf,CAAzB;;AAUA,IAAMG,kBAAkB,GAAG,SAArBA,kBAAqB,CAACC,QAAD;AAAA;AACzBzD,IAAAA,oBAAoB,EAAEhB,kBAAkB,CAACO,kBAAD,EAAqBkE,QAArB,CADf;AAEzBxD,IAAAA,iBAAiB,EAAEjB,kBAAkB,CAACQ,eAAD,EAAkBiE,QAAlB,CAFZ;AAGzBvD,IAAAA,mBAAmB,EAAElB,kBAAkB,CAACS,iBAAD,EAAoBgE,QAApB,CAHd;AAIzB3C,IAAAA,0BAA0B,EAAE9B,kBAAkB,CAACU,wBAAD,EAA2B+D,QAA3B,CAJrB;AAKzB9B,IAAAA,yBAAyB,EAAE3C,kBAAkB,CAACW,uBAAD,EAA0B8D,QAA1B,CALpB;AAMzB7B,IAAAA,qBAAqB,EAAE5C,kBAAkB,CAACY,mBAAD,EAAsB6D,QAAtB;AANhB,0BAONzE,kBAAkB,CAACQ,eAAD,EAAkBiE,QAAlB,CAPZ;AAAA,CAA3B;;AAUA,IAAMC,WAAW,GAAGzE,OAAO,CAAC,IAAD,EAAOuE,kBAAP,CAA3B;AAEA,eAAezE,OAAO,CAAC2E,WAAD,CAAP,CAAqB7D,YAArB,CAAf","sourcesContent":["import React from \"react\";\nimport { compose, bindActionCreators } from \"redux\";\nimport { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\nimport moment from 'moment';\nimport ClickOffComponentWrapper from \"../../ClickOffComponentWrapper\";\nimport { renderDropdownOptions } from \"../DetailLessonList/components/FullView/components/LessonCard/utils/\";\nimport RescheduleModal from \"../DetailLessonList/components/RescheduleModal\";\n\nimport {\n  setIsVisibleTopBar,\n  setActiveLesson,\n  setOpenActivePage,\n  rescheduleStudentLessons,\n  unAssignLessonToStudent,\n  resetStudentLessons,\n} from \"../index/actions\";\n\nclass DropDownMenu extends React.Component {\n  state = {\n    openRescheduleModal: false,\n  }\n\n  leaveDetailView = () => {\n    const {\n      onSetIsVisibleTopbar,\n      onSetActiveLesson,\n      onSetOpenActivePage,\n      onCloseDetailModal,\n    } = this.props;\n    onSetIsVisibleTopbar(true);\n    onSetActiveLesson({});\n    onSetOpenActivePage(\"\");\n    onCloseDetailModal();\n  }\n\n  onToggleRescheduleModal = () => this.setState({ openRescheduleModal: !this.state.openRescheduleModal })\n\n  handleAssignLesson = () => {\n    const {\n      onOpenModal,\n      onAddCheckedLesson,\n      lesson,\n    } = this.props;\n    onOpenModal();\n    onAddCheckedLesson(lesson.lesson_id);\n    this.leaveDetailView();\n  };\n\n  handleRescheduleModalOpen = () => {\n    const { onCloseDropdown } = this.props;\n    onCloseDropdown();\n    this.onToggleRescheduleModal();\n  };\n\n  onSaveScheduleChanges = (modalState) => {\n    const { onRescheduleStudentLessons, lesson, resetLessonSelections, onSetActiveLesson } = this.props;\n    const payload = {\n      student_lesson_ids: [lesson.id],\n      assignment_date: moment(modalState.assignDate).format('YYYY-MM-DD'),\n      due_date: !modalState.isTimed ? moment(modalState.dueDate).format('YYYY-MM-DD') : null,\n    };\n    if (Object.keys(payload).length > 0 && typeof payload === 'object') {\n      onRescheduleStudentLessons(payload);\n      this.onToggleRescheduleModal();\n      resetLessonSelections();\n      onSetActiveLesson({ ...lesson, assignment_date: moment(modalState.assignDate).format('YYYY-MM-DD'), due_date: !modalState.isTimed ? moment(modalState.dueDate).format('YYYY-MM-DD') : null });\n    }\n  };\n\n  handleUnassignLesson = lessonIds => {\n    const { onUnAssignLessonToStudent, onCloseDropdown, resetLessonSelections } = this.props;\n    if (lessonIds && typeof lessonIds === 'object' && lessonIds.length > 0) {\n      onUnAssignLessonToStudent(lessonIds);\n      onCloseDropdown();\n      this.leaveDetailView();\n      resetLessonSelections();\n    }\n  };\n\n  handleResetLesson = lessonIds => {\n    const { onResetStudentLessons, onCloseDropdown, resetLessonSelections } = this.props;\n    if (lessonIds && typeof lessonIds === 'object' && lessonIds.length > 0) {\n      onResetStudentLessons(lessonIds);\n      onCloseDropdown();\n      this.leaveDetailView();\n      resetLessonSelections();\n    }\n  };\n\n  startMarkFlagsReviewed = (lessonIds) => {\n    const { problems, updateProblemList } = this.props;\n    this.props.handleMarkAllFlagsReviewed(lessonIds);\n    problems.map(problemList => {\n      problemList.problems.map(problem => {\n        if (problem.flag_status === 'FLAGGED') {\n          updateProblemList(problemList.type, { ...problem, flag_status: 'REVIEWED' });\n        }\n      });\n    });\n  }\n\n  render() {\n    const { lesson } = this.props;\n    return (\n      <>\n        <RescheduleModal\n          open={this.state.openRescheduleModal}\n          lesson={lesson}\n          onClose={this.handleRescheduleModalOpen}\n          onSave={this.onSaveScheduleChanges}\n        />\n        <If condition={this.props.dropdownIsOpen}>\n          <ClickOffComponentWrapper onOuterClick={() => this.props.onSetDropdown()}>\n            <ul\n              id=\"dropdown01\"\n              className=\"dropdown-content dropdown-wide\"\n              style={{\n                display: \"block\",\n                opacity: \"1\",\n                transform: \"scaleX(1) scaleY(1)\",\n              }}\n            >\n              {renderDropdownOptions(\n                lesson.status,\n                this.handleAssignLesson,\n                this.handleRescheduleModalOpen,\n                this.props.handleExcuseLessonLateness,\n                this.handleResetLesson,\n                this.startMarkFlagsReviewed,\n                this.handleUnassignLesson,\n                [lesson.id],\n              )}\n            </ul>\n          </ClickOffComponentWrapper>\n        </If>\n      </>\n    );\n  }\n}\n\nDropDownMenu.propTypes = {\n  onCloseDetailModal: PropTypes.func.isRequired,\n  user: PropTypes.object.isRequired,\n  lesson: PropTypes.object.isRequired,\n  onOpenModal: PropTypes.func.isRequired,\n  onAddCheckedLesson: PropTypes.func.isRequired,\n  onCloseDropdown: PropTypes.func.isRequired,\n  resetLessonSelections: PropTypes.func.isRequired,\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n  onSetIsVisibleTopbar: bindActionCreators(setIsVisibleTopBar, dispatch),\n  onSetActiveLesson: bindActionCreators(setActiveLesson, dispatch),\n  onSetOpenActivePage: bindActionCreators(setOpenActivePage, dispatch),\n  onRescheduleStudentLessons: bindActionCreators(rescheduleStudentLessons, dispatch),\n  onUnAssignLessonToStudent: bindActionCreators(unAssignLessonToStudent, dispatch),\n  onResetStudentLessons: bindActionCreators(resetStudentLessons, dispatch),\n  onSetActiveLesson: bindActionCreators(setActiveLesson, dispatch),\n});\n\nconst withConnect = connect(null, mapDispatchToProps);\n\nexport default compose(withConnect)(DropDownMenu);\n"]},"metadata":{},"sourceType":"module"}