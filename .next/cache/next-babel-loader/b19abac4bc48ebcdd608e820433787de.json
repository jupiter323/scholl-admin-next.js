{"ast":null,"code":"import _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport update from 'immutability-helper';\nimport moment from 'moment';\nimport Portal from '../../../../Portal';\nimport FilterSection from './components/FilterSection';\nimport WorksheetCard from './components/WorksheetCard';\nimport { difficultySort, problemSort, timeEstimateSort, subjectSort } from '../../../utils/sortOptions';\nimport sampleWorksheets from '../../../utils/sampleWorksheets';\nimport { worksheetTypeMap, worksheetSourceMap, worksheetDifficultyMap, worksheetSubjectMap } from '../../../utils/worksheetModalMaps';\n\nclass AssignWorksheetModal extends React.Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"onToggleAssignSelectedDropdown\", () => this.setState(({\n      assignSelectedDropdownOpen\n    }) => ({\n      assignSelectedDropdownOpen: !assignSelectedDropdownOpen\n    })));\n\n    _defineProperty(this, \"onSetDropdown\", dropdownIndex => this.setState({\n      dropdownIndex,\n      dropdownIsOpen: true\n    }));\n\n    _defineProperty(this, \"onCloseDropdown\", () => this.setState({\n      dropdownIsOpen: false\n    }));\n\n    _defineProperty(this, \"onResetModal\", () => this.setState({\n      sourceFilters: [],\n      difficultyFilters: [],\n      subjectFilters: [],\n      typeFilters: [],\n      sort: ''\n    }));\n\n    _defineProperty(this, \"onSetSort\", sort => this.setState({\n      sort\n    }));\n\n    _defineProperty(this, \"onSetFilteredState\", (titleFilter, value) => this.setState({\n      [titleFilter]: value\n    }));\n\n    _defineProperty(this, \"onUnsetFilteredState\", titleFilter => this.setState({\n      [titleFilter]: ''\n    }));\n\n    _defineProperty(this, \"onCloseModal\", () => {\n      const {\n        onClose\n      } = this.props;\n      onClose();\n      this.onResetModal();\n    });\n\n    _defineProperty(this, \"onSortWorksheets\", worksheets => {\n      const {\n        sort\n      } = this.state;\n\n      switch (sort) {\n        case 'difficulty':\n          return worksheets.sort(difficultySort);\n\n        case 'problems':\n          return worksheets.sort(problemSort);\n\n        case 'timeEstimate':\n          return worksheets.sort(timeEstimateSort);\n\n        case 'subject':\n          return worksheets.sort(subjectSort);\n\n        default:\n          break;\n      }\n    });\n\n    _defineProperty(this, \"onFilterByTitle\", () => {\n      const {\n        worksheets,\n        titleFilter\n      } = this.state;\n      return worksheets.reduce((finalArr, currentWorksheet) => {\n        const {\n          title\n        } = currentWorksheet;\n        const worksheetString = title.replace(/\\s/g, \"\").toLowerCase();\n\n        if (worksheetString.indexOf(titleFilter) !== -1 && finalArr.indexOf(currentWorksheet) === -1) {\n          finalArr.push(currentWorksheet);\n        }\n\n        return finalArr;\n      }, []);\n    });\n\n    _defineProperty(this, \"onFilterByUnit\", () => {\n      const {\n        worksheets,\n        unitFilter\n      } = this.state;\n      return worksheets.reduce((finalArr, currentWorksheet) => {\n        const {\n          unit\n        } = currentWorksheet;\n        const worksheetString = unit.replace(/\\s/g, \"\").toLowerCase();\n\n        if (worksheetString.indexOf(unitFilter) !== -1 && finalArr.indexOf(currentWorksheet) === -1) {\n          finalArr.push(currentWorksheet);\n        }\n\n        return finalArr;\n      }, []);\n    });\n\n    _defineProperty(this, \"onFilterWorksheets\", () => {\n      const {\n        subjectFilters,\n        typeFilters,\n        sourceFilters,\n        difficultyFilters,\n        worksheets: allWorksheets\n      } = this.state;\n      let worksheets = allWorksheets;\n\n      if (subjectFilters.length) {\n        worksheets = worksheets.filter(worksheet => subjectFilters.indexOf(worksheetSubjectMap[worksheet.subject]) !== -1);\n      }\n\n      if (typeFilters.length) {\n        worksheets = worksheets.filter(worksheet => typeFilters.indexOf(worksheetTypeMap[worksheet.type]) !== -1);\n      }\n\n      if (sourceFilters.length) {\n        worksheets = worksheets.filter(worksheet => sourceFilters.indexOf(worksheetSourceMap[worksheet.source]) !== -1);\n      }\n\n      if (difficultyFilters.length) {\n        worksheets = worksheets.filter(worksheet => difficultyFilters.indexOf(worksheetDifficultyMap[worksheet.difficulty]) !== -1);\n      }\n\n      return worksheets;\n    });\n\n    _defineProperty(this, \"getMappableWorksheets\", () => {\n      const {\n        subjectFilters,\n        typeFilters,\n        difficultyFilters,\n        sourceFilters,\n        sort,\n        unitFilter,\n        titleFilter,\n        worksheets\n      } = this.state;\n      let mappableWorksheets = worksheets;\n\n      if (titleFilter.length) {\n        mappableWorksheets = this.onFilterByTitle();\n      }\n\n      if (unitFilter.length) {\n        mappableWorksheets = this.onFilterByUnit();\n      }\n\n      if (subjectFilters.length || typeFilters.length || difficultyFilters.length || sourceFilters.length) {\n        mappableWorksheets = this.onFilterWorksheets();\n      }\n\n      if (sort) {\n        return this.onSortWorksheets(mappableWorksheets);\n      }\n\n      return mappableWorksheets;\n    });\n\n    _defineProperty(this, \"handleFilterClick\", (filterType, filter) => {\n      const {\n        sourceFilters: currentSourceFilters,\n        difficultyFilters: currentDifficultyFilters,\n        subjectFilters: currentSubjectFilters,\n        typeFilters: currentTypeFilters\n      } = this.state;\n      let modifiedFilterCurrentState;\n      let modifiedFilterName;\n      let modifiedFilterUpdatedState;\n\n      switch (filterType) {\n        case 'subject':\n          modifiedFilterCurrentState = currentSubjectFilters;\n          modifiedFilterName = 'subjectFilters';\n          break;\n\n        case 'type':\n          modifiedFilterCurrentState = currentTypeFilters;\n          modifiedFilterName = 'typeFilters';\n          break;\n\n        case 'source':\n          modifiedFilterCurrentState = currentSourceFilters;\n          modifiedFilterName = 'sourceFilters';\n          break;\n\n        case 'difficulty':\n          modifiedFilterCurrentState = currentDifficultyFilters;\n          modifiedFilterName = 'difficultyFilters';\n          break;\n\n        default:\n          break;\n      }\n\n      if (modifiedFilterCurrentState.indexOf(filter) === -1) {\n        modifiedFilterUpdatedState = update(modifiedFilterCurrentState, {\n          $push: [filter]\n        });\n      } else {\n        const filterIndex = modifiedFilterCurrentState.indexOf(filter);\n        modifiedFilterUpdatedState = update(modifiedFilterCurrentState, {\n          $splice: [[filterIndex, 1]]\n        });\n      }\n\n      this.setState({\n        [modifiedFilterName]: modifiedFilterUpdatedState\n      });\n    });\n\n    _defineProperty(this, \"handleWorksheetClick\", worksheet => {\n      const {\n        selectedWorksheets\n      } = this.state;\n      let modifiedWorksheets;\n\n      if (selectedWorksheets.indexOf(worksheet) === -1) {\n        modifiedWorksheets = update(selectedWorksheets, {\n          $push: [worksheet]\n        });\n      } else {\n        const worksheetIndex = selectedWorksheets.indexOf(worksheet);\n        modifiedWorksheets = update(selectedWorksheets, {\n          $splice: [[worksheetIndex, 1]]\n        });\n      }\n\n      this.setState({\n        selectedWorksheets: modifiedWorksheets\n      });\n    });\n\n    _defineProperty(this, \"assignWorksheets\", date => {\n      const {\n        onAssignWorksheets\n      } = this.props;\n      const {\n        selectedWorksheets\n      } = this.state;\n      let assignDate;\n\n      switch (date) {\n        case 'today':\n          assignDate = moment().format('MM/DD/YY');\n          break;\n\n        case 'tomorrow':\n          assignDate = moment().add(1, 'days').format('MM/DD/YY');\n          break;\n\n        case 'nextSession':\n          break;\n\n        case 'customDate':\n          assignDate = '01/05/19';\n          break;\n\n        default:\n          break;\n      }\n\n      this.onToggleAssignSelectedDropdown();\n      onAssignWorksheets(selectedWorksheets, assignDate);\n    });\n\n    _defineProperty(this, \"mapWorksheets\", () => this.getMappableWorksheets().map((worksheet, index) => __jsx(WorksheetCard, {\n      worksheet: worksheet,\n      index: index,\n      key: worksheet.id,\n      onSetDropdown: this.onSetDropdown,\n      onCloseDropdown: this.onCloseDropdown,\n      dropdownIndex: this.state.dropdownIndex,\n      dropdownIsOpen: this.state.dropdownIsOpen,\n      handleWorksheetClick: this.handleWorksheetClick,\n      selectedWorksheets: this.state.selectedWorksheets\n    })));\n\n    this.state = {\n      sort: '',\n      unitFilter: '',\n      titleFilter: '',\n      typeFilters: [],\n      sourceFilters: [],\n      subjectFilters: [],\n      selectedWorksheets: [],\n      difficultyFilters: [],\n      worksheets: sampleWorksheets,\n      dropdownIndex: null,\n      dropdownIsOpen: false,\n      assignSelectedDropdownOpen: false\n    };\n  }\n\n  render() {\n    const {\n      open\n    } = this.props;\n    const {\n      assignSelectedDropdownOpen,\n      typeFilters,\n      sourceFilters,\n      subjectFilters,\n      difficultyFilters,\n      sort\n    } = this.state;\n    return __jsx(\"div\", {\n      className: \"jsx-2666520574\"\n    }, open && __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"wrapper\"\n    }, __jsx(\"div\", {\n      style: {\n        minWidth: \"100%\"\n      },\n      className: \"jsx-2666520574\" + \" \" + \"card-modal card-main card switcher-section grey lighten-3\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"header-row card-panel light-blue lighten-1 white-text\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"card-panel-row row\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"col s11\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"d-flex\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"icon-col\"\n    }, __jsx(\"i\", {\n      className: \"jsx-2666520574\" + \" \" + \"icon-sheets-w\"\n    })), __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"card-panel-text\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"text-large\"\n    }, \"Assign Worksheets\")))), __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"col s1 right-align\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"row icons-row\"\n    }, __jsx(\"a\", {\n      href: \"#\",\n      onClick: this.onCloseModal,\n      className: \"jsx-2666520574\" + \" \" + \"modal-close close\"\n    }, __jsx(\"i\", {\n      className: \"jsx-2666520574\" + \" \" + \"icon-close-thin\"\n    })))))), __jsx(FilterSection, {\n      sort: sort,\n      typeFilters: typeFilters,\n      sourceFilters: sourceFilters,\n      subjectFilters: subjectFilters,\n      difficultyFilters: difficultyFilters,\n      onSetSort: this.onSetSort,\n      onClearFilters: this.onResetModal,\n      handleFilterClick: this.handleFilterClick,\n      onSetFilteredState: this.onSetFilteredState,\n      onUnsetFilteredState: this.onUnsetFilteredState\n    }), __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"card-content\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"card-body\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"result-row center-align\"\n    }, __jsx(\"b\", {\n      className: \"jsx-2666520574\" + \" \" + \"result\"\n    }, \" - \", this.getMappableWorksheets().length, \" results -\")), __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"checkboxes-section row d-flex-content card-width-322\"\n    }, this.mapWorksheets())))), __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"add-btn-block\"\n    }, __jsx(\"a\", {\n      href: \"#\",\n      \"data-target\": \"dropdown_assign_selected\",\n      onClick: this.onToggleAssignSelectedDropdown,\n      className: \"jsx-2666520574\" + \" \" + \"dropdown-trigger waves-effect waves-teal btn add-btn\"\n    }, __jsx(\"i\", {\n      className: \"jsx-2666520574\" + \" \" + \"material-icons\"\n    }, \"add\"), \" Assign Selected\"), __jsx(\"ul\", {\n      id: \"dropdown_assign_selected\",\n      style: {\n        display: assignSelectedDropdownOpen ? 'block' : '0',\n        opacity: assignSelectedDropdownOpen ? '1' : '0'\n      },\n      className: \"jsx-2666520574\" + \" \" + 'dropdown-content'\n    }, __jsx(\"li\", {\n      className: \"jsx-2666520574\"\n    }, __jsx(\"a\", {\n      href: \"#\",\n      onClick: () => this.assignWorksheets('today'),\n      className: \"jsx-2666520574\"\n    }, \"For Today\")), __jsx(\"li\", {\n      className: \"jsx-2666520574\"\n    }, __jsx(\"a\", {\n      href: \"#\",\n      onClick: () => this.assignWorksheets('tomorrow'),\n      className: \"jsx-2666520574\"\n    }, \"For Tomorrow\")), __jsx(\"li\", {\n      className: \"jsx-2666520574\"\n    }, __jsx(\"a\", {\n      href: \"#\",\n      onClick: () => this.assignWorksheets('nextSession'),\n      className: \"jsx-2666520574\"\n    }, \"For Next Session\")), __jsx(\"li\", {\n      className: \"jsx-2666520574\"\n    }, __jsx(\"a\", {\n      href: \"#\",\n      onClick: () => this.assignWorksheets('customDate'),\n      className: \"jsx-2666520574\"\n    }, \"For Date...\"))))), __jsx(_JSXStyle, {\n      id: \"2666520574\"\n    }, \".card-modal.jsx-2666520574{margin:0;border-radius:6px;}.wrapper.jsx-2666520574{min-height:0px;}.modal-custom.jsx-2666520574{opacity:1;visibility:visible;}.modal-footer.jsx-2666520574{background-color:white;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Wb2x1bWVzL0hERC9TaXRlcy9jbGVhcmNob2ljZXRlc3RwcmVwL2NsZWFyLWNob2ljZS1hZG1pbi9jb21wb25lbnRzL0Rhc2hib2FyZC9jb21wb25lbnRzL01vZGFscy9Bc3NpZ25Xb3Jrc2hlZXRNb2RhbC9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFpU1csQUFHd0IsQUFJTSxBQUdMLEFBSWEsU0FWTCxDQU9DLEtBSHJCLFFBT0EsSUFWQSxFQU9BIiwiZmlsZSI6Ii9Wb2x1bWVzL0hERC9TaXRlcy9jbGVhcmNob2ljZXRlc3RwcmVwL2NsZWFyLWNob2ljZS1hZG1pbi9jb21wb25lbnRzL0Rhc2hib2FyZC9jb21wb25lbnRzL01vZGFscy9Bc3NpZ25Xb3Jrc2hlZXRNb2RhbC9pbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IHVwZGF0ZSBmcm9tICdpbW11dGFiaWxpdHktaGVscGVyJztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcblxuaW1wb3J0IFBvcnRhbCBmcm9tICcuLi8uLi8uLi8uLi9Qb3J0YWwnO1xuXG5pbXBvcnQgRmlsdGVyU2VjdGlvbiBmcm9tICcuL2NvbXBvbmVudHMvRmlsdGVyU2VjdGlvbic7XG5pbXBvcnQgV29ya3NoZWV0Q2FyZCBmcm9tICcuL2NvbXBvbmVudHMvV29ya3NoZWV0Q2FyZCc7XG5pbXBvcnQgeyBkaWZmaWN1bHR5U29ydCwgcHJvYmxlbVNvcnQsIHRpbWVFc3RpbWF0ZVNvcnQsIHN1YmplY3RTb3J0IH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvc29ydE9wdGlvbnMnO1xuaW1wb3J0IHNhbXBsZVdvcmtzaGVldHMgZnJvbSAnLi4vLi4vLi4vdXRpbHMvc2FtcGxlV29ya3NoZWV0cyc7XG5pbXBvcnQgeyB3b3Jrc2hlZXRUeXBlTWFwLCB3b3Jrc2hlZXRTb3VyY2VNYXAsIHdvcmtzaGVldERpZmZpY3VsdHlNYXAsIHdvcmtzaGVldFN1YmplY3RNYXAgfSBmcm9tICcuLi8uLi8uLi91dGlscy93b3Jrc2hlZXRNb2RhbE1hcHMnO1xuXG5jbGFzcyBBc3NpZ25Xb3Jrc2hlZXRNb2RhbCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBzb3J0OiAnJyxcbiAgICAgIHVuaXRGaWx0ZXI6ICcnLFxuICAgICAgdGl0bGVGaWx0ZXI6ICcnLFxuICAgICAgdHlwZUZpbHRlcnM6IFtdLFxuICAgICAgc291cmNlRmlsdGVyczogW10sXG4gICAgICBzdWJqZWN0RmlsdGVyczogW10sXG4gICAgICBzZWxlY3RlZFdvcmtzaGVldHM6IFtdLFxuICAgICAgZGlmZmljdWx0eUZpbHRlcnM6IFtdLFxuICAgICAgd29ya3NoZWV0czogc2FtcGxlV29ya3NoZWV0cyxcbiAgICAgIGRyb3Bkb3duSW5kZXg6IG51bGwsXG4gICAgICBkcm9wZG93bklzT3BlbjogZmFsc2UsXG4gICAgICBhc3NpZ25TZWxlY3RlZERyb3Bkb3duT3BlbjogZmFsc2UsXG4gICAgfTtcbiAgfVxuXG4gIG9uVG9nZ2xlQXNzaWduU2VsZWN0ZWREcm9wZG93biA9ICgpID0+IHRoaXMuc2V0U3RhdGUoKHsgYXNzaWduU2VsZWN0ZWREcm9wZG93bk9wZW4gfSkgPT4gKHsgYXNzaWduU2VsZWN0ZWREcm9wZG93bk9wZW46ICFhc3NpZ25TZWxlY3RlZERyb3Bkb3duT3BlbiB9KSlcblxuICBvblNldERyb3Bkb3duID0gKGRyb3Bkb3duSW5kZXgpID0+IHRoaXMuc2V0U3RhdGUoeyBkcm9wZG93bkluZGV4LCBkcm9wZG93bklzT3BlbjogdHJ1ZSB9KTtcbiAgb25DbG9zZURyb3Bkb3duID0gKCkgPT4gdGhpcy5zZXRTdGF0ZSh7IGRyb3Bkb3duSXNPcGVuOiBmYWxzZSB9KTtcblxuICBvblJlc2V0TW9kYWwgPSAoKSA9PiB0aGlzLnNldFN0YXRlKHsgc291cmNlRmlsdGVyczogW10sIGRpZmZpY3VsdHlGaWx0ZXJzOiBbXSwgc3ViamVjdEZpbHRlcnM6IFtdLCB0eXBlRmlsdGVyczogW10sIHNvcnQ6ICcnIH0pXG4gIG9uU2V0U29ydCA9IChzb3J0KSA9PiB0aGlzLnNldFN0YXRlKHsgc29ydCB9KVxuXG4gIG9uU2V0RmlsdGVyZWRTdGF0ZSA9ICh0aXRsZUZpbHRlciwgdmFsdWUpID0+IHRoaXMuc2V0U3RhdGUoeyBbdGl0bGVGaWx0ZXJdOiB2YWx1ZSB9KVxuICBvblVuc2V0RmlsdGVyZWRTdGF0ZSA9ICh0aXRsZUZpbHRlcikgPT4gdGhpcy5zZXRTdGF0ZSh7IFt0aXRsZUZpbHRlcl06ICcnIH0pXG5cbiAgb25DbG9zZU1vZGFsID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgb25DbG9zZSB9ID0gdGhpcy5wcm9wcztcbiAgICBvbkNsb3NlKCk7XG4gICAgdGhpcy5vblJlc2V0TW9kYWwoKTtcbiAgfVxuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjb25zaXN0ZW50LXJldHVyblxuICBvblNvcnRXb3Jrc2hlZXRzID0gKHdvcmtzaGVldHMpID0+IHtcbiAgICBjb25zdCB7IHNvcnQgfSA9IHRoaXMuc3RhdGU7XG4gICAgc3dpdGNoIChzb3J0KSB7XG4gICAgICBjYXNlICdkaWZmaWN1bHR5JzpcbiAgICAgICAgcmV0dXJuIHdvcmtzaGVldHMuc29ydChkaWZmaWN1bHR5U29ydCk7XG4gICAgICBjYXNlICdwcm9ibGVtcyc6XG4gICAgICAgIHJldHVybiB3b3Jrc2hlZXRzLnNvcnQocHJvYmxlbVNvcnQpO1xuICAgICAgY2FzZSAndGltZUVzdGltYXRlJzpcbiAgICAgICAgcmV0dXJuIHdvcmtzaGVldHMuc29ydCh0aW1lRXN0aW1hdGVTb3J0KTtcbiAgICAgIGNhc2UgJ3N1YmplY3QnOlxuICAgICAgICByZXR1cm4gd29ya3NoZWV0cy5zb3J0KHN1YmplY3RTb3J0KTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIG9uRmlsdGVyQnlUaXRsZSA9ICgpID0+IHtcbiAgICBjb25zdCB7IHdvcmtzaGVldHMsIHRpdGxlRmlsdGVyIH0gPSB0aGlzLnN0YXRlO1xuICAgIHJldHVybiB3b3Jrc2hlZXRzLnJlZHVjZSgoZmluYWxBcnIsIGN1cnJlbnRXb3Jrc2hlZXQpID0+IHtcbiAgICAgIGNvbnN0IHsgdGl0bGUgfSA9IGN1cnJlbnRXb3Jrc2hlZXQ7XG4gICAgICBjb25zdCB3b3Jrc2hlZXRTdHJpbmcgPSB0aXRsZS5yZXBsYWNlKC9cXHMvZywgXCJcIikudG9Mb3dlckNhc2UoKTtcbiAgICAgIGlmICh3b3Jrc2hlZXRTdHJpbmcuaW5kZXhPZih0aXRsZUZpbHRlcikgIT09IC0xICYmIGZpbmFsQXJyLmluZGV4T2YoY3VycmVudFdvcmtzaGVldCkgPT09IC0xKSB7XG4gICAgICAgIGZpbmFsQXJyLnB1c2goY3VycmVudFdvcmtzaGVldCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmluYWxBcnI7XG4gICAgfSwgW10pO1xuICB9XG5cbiAgb25GaWx0ZXJCeVVuaXQgPSAoKSA9PiB7XG4gICAgY29uc3QgeyB3b3Jrc2hlZXRzLCB1bml0RmlsdGVyIH0gPSB0aGlzLnN0YXRlO1xuICAgIHJldHVybiB3b3Jrc2hlZXRzLnJlZHVjZSgoZmluYWxBcnIsIGN1cnJlbnRXb3Jrc2hlZXQpID0+IHtcbiAgICAgIGNvbnN0IHsgdW5pdCB9ID0gY3VycmVudFdvcmtzaGVldDtcbiAgICAgIGNvbnN0IHdvcmtzaGVldFN0cmluZyA9IHVuaXQucmVwbGFjZSgvXFxzL2csIFwiXCIpLnRvTG93ZXJDYXNlKCk7XG4gICAgICBpZiAod29ya3NoZWV0U3RyaW5nLmluZGV4T2YodW5pdEZpbHRlcikgIT09IC0xICYmIGZpbmFsQXJyLmluZGV4T2YoY3VycmVudFdvcmtzaGVldCkgPT09IC0xKSB7XG4gICAgICAgIGZpbmFsQXJyLnB1c2goY3VycmVudFdvcmtzaGVldCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmluYWxBcnI7XG4gICAgfSwgW10pO1xuICB9XG5cbiAgb25GaWx0ZXJXb3Jrc2hlZXRzID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgc3ViamVjdEZpbHRlcnMsIHR5cGVGaWx0ZXJzLCBzb3VyY2VGaWx0ZXJzLCBkaWZmaWN1bHR5RmlsdGVycywgd29ya3NoZWV0czogYWxsV29ya3NoZWV0cyB9ID0gdGhpcy5zdGF0ZTtcbiAgICBsZXQgd29ya3NoZWV0cyA9IGFsbFdvcmtzaGVldHM7XG4gICAgaWYgKHN1YmplY3RGaWx0ZXJzLmxlbmd0aCkge1xuICAgICAgd29ya3NoZWV0cyA9IHdvcmtzaGVldHMuZmlsdGVyKHdvcmtzaGVldCA9PiBzdWJqZWN0RmlsdGVycy5pbmRleE9mKHdvcmtzaGVldFN1YmplY3RNYXBbd29ya3NoZWV0LnN1YmplY3RdKSAhPT0gLTEpO1xuICAgIH1cbiAgICBpZiAodHlwZUZpbHRlcnMubGVuZ3RoKSB7XG4gICAgICB3b3Jrc2hlZXRzID0gd29ya3NoZWV0cy5maWx0ZXIod29ya3NoZWV0ID0+IHR5cGVGaWx0ZXJzLmluZGV4T2Yod29ya3NoZWV0VHlwZU1hcFt3b3Jrc2hlZXQudHlwZV0pICE9PSAtMSk7XG4gICAgfVxuICAgIGlmIChzb3VyY2VGaWx0ZXJzLmxlbmd0aCkge1xuICAgICAgd29ya3NoZWV0cyA9IHdvcmtzaGVldHMuZmlsdGVyKHdvcmtzaGVldCA9PiBzb3VyY2VGaWx0ZXJzLmluZGV4T2Yod29ya3NoZWV0U291cmNlTWFwW3dvcmtzaGVldC5zb3VyY2VdKSAhPT0gLTEpO1xuICAgIH1cbiAgICBpZiAoZGlmZmljdWx0eUZpbHRlcnMubGVuZ3RoKSB7XG4gICAgICB3b3Jrc2hlZXRzID0gd29ya3NoZWV0cy5maWx0ZXIod29ya3NoZWV0ID0+IGRpZmZpY3VsdHlGaWx0ZXJzLmluZGV4T2Yod29ya3NoZWV0RGlmZmljdWx0eU1hcFt3b3Jrc2hlZXQuZGlmZmljdWx0eV0pICE9PSAtMSk7XG4gICAgfVxuICAgIHJldHVybiB3b3Jrc2hlZXRzO1xuICB9XG5cbiAgZ2V0TWFwcGFibGVXb3Jrc2hlZXRzID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgc3ViamVjdEZpbHRlcnMsIHR5cGVGaWx0ZXJzLCBkaWZmaWN1bHR5RmlsdGVycywgc291cmNlRmlsdGVycywgc29ydCwgdW5pdEZpbHRlciwgdGl0bGVGaWx0ZXIsIHdvcmtzaGVldHMgfSA9IHRoaXMuc3RhdGU7XG4gICAgbGV0IG1hcHBhYmxlV29ya3NoZWV0cyA9IHdvcmtzaGVldHM7XG4gICAgaWYgKHRpdGxlRmlsdGVyLmxlbmd0aCkge1xuICAgICAgbWFwcGFibGVXb3Jrc2hlZXRzID0gdGhpcy5vbkZpbHRlckJ5VGl0bGUoKTtcbiAgICB9XG4gICAgaWYgKHVuaXRGaWx0ZXIubGVuZ3RoKSB7XG4gICAgICBtYXBwYWJsZVdvcmtzaGVldHMgPSB0aGlzLm9uRmlsdGVyQnlVbml0KCk7XG4gICAgfVxuICAgIGlmIChzdWJqZWN0RmlsdGVycy5sZW5ndGggfHwgdHlwZUZpbHRlcnMubGVuZ3RoIHx8IGRpZmZpY3VsdHlGaWx0ZXJzLmxlbmd0aCB8fCBzb3VyY2VGaWx0ZXJzLmxlbmd0aCkge1xuICAgICAgbWFwcGFibGVXb3Jrc2hlZXRzID0gdGhpcy5vbkZpbHRlcldvcmtzaGVldHMoKTtcbiAgICB9XG4gICAgaWYgKHNvcnQpIHtcbiAgICAgIHJldHVybiB0aGlzLm9uU29ydFdvcmtzaGVldHMobWFwcGFibGVXb3Jrc2hlZXRzKTtcbiAgICB9XG4gICAgcmV0dXJuIG1hcHBhYmxlV29ya3NoZWV0cztcbiAgfVxuXG4gIGhhbmRsZUZpbHRlckNsaWNrID0gKGZpbHRlclR5cGUsIGZpbHRlcikgPT4ge1xuICAgIGNvbnN0IHsgc291cmNlRmlsdGVyczogY3VycmVudFNvdXJjZUZpbHRlcnMsIGRpZmZpY3VsdHlGaWx0ZXJzOiBjdXJyZW50RGlmZmljdWx0eUZpbHRlcnMsXG4gICAgICBzdWJqZWN0RmlsdGVyczogY3VycmVudFN1YmplY3RGaWx0ZXJzLCB0eXBlRmlsdGVyczogY3VycmVudFR5cGVGaWx0ZXJzIH0gPSB0aGlzLnN0YXRlO1xuICAgIGxldCBtb2RpZmllZEZpbHRlckN1cnJlbnRTdGF0ZTtcbiAgICBsZXQgbW9kaWZpZWRGaWx0ZXJOYW1lO1xuICAgIGxldCBtb2RpZmllZEZpbHRlclVwZGF0ZWRTdGF0ZTtcbiAgICBzd2l0Y2ggKGZpbHRlclR5cGUpIHtcbiAgICAgIGNhc2UgJ3N1YmplY3QnOlxuICAgICAgICBtb2RpZmllZEZpbHRlckN1cnJlbnRTdGF0ZSA9IGN1cnJlbnRTdWJqZWN0RmlsdGVycztcbiAgICAgICAgbW9kaWZpZWRGaWx0ZXJOYW1lID0gJ3N1YmplY3RGaWx0ZXJzJztcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICd0eXBlJzpcbiAgICAgICAgbW9kaWZpZWRGaWx0ZXJDdXJyZW50U3RhdGUgPSBjdXJyZW50VHlwZUZpbHRlcnM7XG4gICAgICAgIG1vZGlmaWVkRmlsdGVyTmFtZSA9ICd0eXBlRmlsdGVycyc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnc291cmNlJzpcbiAgICAgICAgbW9kaWZpZWRGaWx0ZXJDdXJyZW50U3RhdGUgPSBjdXJyZW50U291cmNlRmlsdGVycztcbiAgICAgICAgbW9kaWZpZWRGaWx0ZXJOYW1lID0gJ3NvdXJjZUZpbHRlcnMnO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2RpZmZpY3VsdHknOlxuICAgICAgICBtb2RpZmllZEZpbHRlckN1cnJlbnRTdGF0ZSA9IGN1cnJlbnREaWZmaWN1bHR5RmlsdGVycztcbiAgICAgICAgbW9kaWZpZWRGaWx0ZXJOYW1lID0gJ2RpZmZpY3VsdHlGaWx0ZXJzJztcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBicmVhaztcbiAgICB9XG4gICAgaWYgKG1vZGlmaWVkRmlsdGVyQ3VycmVudFN0YXRlLmluZGV4T2YoZmlsdGVyKSA9PT0gLTEpIHtcbiAgICAgIG1vZGlmaWVkRmlsdGVyVXBkYXRlZFN0YXRlID0gdXBkYXRlKG1vZGlmaWVkRmlsdGVyQ3VycmVudFN0YXRlLCB7XG4gICAgICAgICRwdXNoOiBbZmlsdGVyXSxcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBmaWx0ZXJJbmRleCA9IG1vZGlmaWVkRmlsdGVyQ3VycmVudFN0YXRlLmluZGV4T2YoZmlsdGVyKTtcbiAgICAgIG1vZGlmaWVkRmlsdGVyVXBkYXRlZFN0YXRlID0gdXBkYXRlKG1vZGlmaWVkRmlsdGVyQ3VycmVudFN0YXRlLCB7XG4gICAgICAgICRzcGxpY2U6IFtbIGZpbHRlckluZGV4LCAxIF1dLFxuICAgICAgfSk7XG4gICAgfVxuICAgIHRoaXMuc2V0U3RhdGUoeyBbbW9kaWZpZWRGaWx0ZXJOYW1lXTogbW9kaWZpZWRGaWx0ZXJVcGRhdGVkU3RhdGUgfSk7XG4gIH1cblxuICBoYW5kbGVXb3Jrc2hlZXRDbGljayA9ICh3b3Jrc2hlZXQpID0+IHtcbiAgICBjb25zdCB7IHNlbGVjdGVkV29ya3NoZWV0cyB9ID0gdGhpcy5zdGF0ZTtcbiAgICBsZXQgbW9kaWZpZWRXb3Jrc2hlZXRzO1xuICAgIGlmIChzZWxlY3RlZFdvcmtzaGVldHMuaW5kZXhPZih3b3Jrc2hlZXQpID09PSAtMSkge1xuICAgICAgbW9kaWZpZWRXb3Jrc2hlZXRzID0gdXBkYXRlKHNlbGVjdGVkV29ya3NoZWV0cywge1xuICAgICAgICAkcHVzaDogW3dvcmtzaGVldF0sXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3Qgd29ya3NoZWV0SW5kZXggPSBzZWxlY3RlZFdvcmtzaGVldHMuaW5kZXhPZih3b3Jrc2hlZXQpO1xuICAgICAgbW9kaWZpZWRXb3Jrc2hlZXRzID0gdXBkYXRlKHNlbGVjdGVkV29ya3NoZWV0cywge1xuICAgICAgICAkc3BsaWNlOiBbWyB3b3Jrc2hlZXRJbmRleCwgMSBdXSxcbiAgICAgIH0pO1xuICAgIH1cbiAgICB0aGlzLnNldFN0YXRlKHsgc2VsZWN0ZWRXb3Jrc2hlZXRzOiBtb2RpZmllZFdvcmtzaGVldHMgfSk7XG4gIH1cblxuICBhc3NpZ25Xb3Jrc2hlZXRzID0gKGRhdGUpID0+IHtcbiAgICBjb25zdCB7IG9uQXNzaWduV29ya3NoZWV0cyB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB7IHNlbGVjdGVkV29ya3NoZWV0cyB9ID0gdGhpcy5zdGF0ZTtcbiAgICBsZXQgYXNzaWduRGF0ZTtcbiAgICBzd2l0Y2ggKGRhdGUpIHtcbiAgICAgIGNhc2UgJ3RvZGF5JzpcbiAgICAgICAgYXNzaWduRGF0ZSA9IG1vbWVudCgpLmZvcm1hdCgnTU0vREQvWVknKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICd0b21vcnJvdyc6XG4gICAgICAgIGFzc2lnbkRhdGUgPSBtb21lbnQoKS5hZGQoMSwgJ2RheXMnKS5mb3JtYXQoJ01NL0REL1lZJyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnbmV4dFNlc3Npb24nOlxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2N1c3RvbURhdGUnOlxuICAgICAgICBhc3NpZ25EYXRlID0gJzAxLzA1LzE5JztcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBicmVhaztcbiAgICB9XG4gICAgdGhpcy5vblRvZ2dsZUFzc2lnblNlbGVjdGVkRHJvcGRvd24oKTtcbiAgICBvbkFzc2lnbldvcmtzaGVldHMoc2VsZWN0ZWRXb3Jrc2hlZXRzLCBhc3NpZ25EYXRlKTtcbiAgfVxuXG4gIG1hcFdvcmtzaGVldHMgPSAoKSA9PiB0aGlzLmdldE1hcHBhYmxlV29ya3NoZWV0cygpLm1hcCgod29ya3NoZWV0LCBpbmRleCkgPT4gKFxuICAgIDxXb3Jrc2hlZXRDYXJkXG4gICAgICB3b3Jrc2hlZXQ9e3dvcmtzaGVldH1cbiAgICAgIGluZGV4PXtpbmRleH1cbiAgICAgIGtleT17d29ya3NoZWV0LmlkfVxuICAgICAgb25TZXREcm9wZG93bj17dGhpcy5vblNldERyb3Bkb3dufVxuICAgICAgb25DbG9zZURyb3Bkb3duPXt0aGlzLm9uQ2xvc2VEcm9wZG93bn1cbiAgICAgIGRyb3Bkb3duSW5kZXg9e3RoaXMuc3RhdGUuZHJvcGRvd25JbmRleH1cbiAgICAgIGRyb3Bkb3duSXNPcGVuPXt0aGlzLnN0YXRlLmRyb3Bkb3duSXNPcGVufVxuICAgICAgaGFuZGxlV29ya3NoZWV0Q2xpY2s9e3RoaXMuaGFuZGxlV29ya3NoZWV0Q2xpY2t9XG4gICAgICBzZWxlY3RlZFdvcmtzaGVldHM9e3RoaXMuc3RhdGUuc2VsZWN0ZWRXb3Jrc2hlZXRzfVxuICAgIC8+XG4gICkpXG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgb3BlbiB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB7IGFzc2lnblNlbGVjdGVkRHJvcGRvd25PcGVuLCB0eXBlRmlsdGVycywgc291cmNlRmlsdGVycywgc3ViamVjdEZpbHRlcnMsIGRpZmZpY3VsdHlGaWx0ZXJzLCBzb3J0IH0gPSB0aGlzLnN0YXRlO1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2PlxuICAgICAgICB7b3BlbiAmJiAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3cmFwcGVyXCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2FyZC1tb2RhbCBjYXJkLW1haW4gY2FyZCBzd2l0Y2hlci1zZWN0aW9uIGdyZXkgbGlnaHRlbi0zXCIgc3R5bGUgPSB7e21pbldpZHRoOlwiMTAwJVwifX0+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJoZWFkZXItcm93IGNhcmQtcGFuZWwgbGlnaHQtYmx1ZSBsaWdodGVuLTEgd2hpdGUtdGV4dFwiPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjYXJkLXBhbmVsLXJvdyByb3dcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2wgczExXCI+XG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJkLWZsZXhcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaWNvbi1jb2xcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiaWNvbi1zaGVldHMtd1wiPjwvaT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjYXJkLXBhbmVsLXRleHRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LWxhcmdlXCI+QXNzaWduIFdvcmtzaGVldHM8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2wgczEgcmlnaHQtYWxpZ25cIj5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInJvdyBpY29ucy1yb3dcIj48YSBocmVmPVwiI1wiIG9uQ2xpY2s9e3RoaXMub25DbG9zZU1vZGFsfSBjbGFzc05hbWU9XCJtb2RhbC1jbG9zZSBjbG9zZVwiPjxpIGNsYXNzTmFtZT1cImljb24tY2xvc2UtdGhpblwiPjwvaT48L2E+PC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPEZpbHRlclNlY3Rpb25cbiAgICAgICAgICAgICAgICAgIHNvcnQ9e3NvcnR9XG4gICAgICAgICAgICAgICAgICB0eXBlRmlsdGVycz17dHlwZUZpbHRlcnN9XG4gICAgICAgICAgICAgICAgICBzb3VyY2VGaWx0ZXJzPXtzb3VyY2VGaWx0ZXJzfVxuICAgICAgICAgICAgICAgICAgc3ViamVjdEZpbHRlcnM9e3N1YmplY3RGaWx0ZXJzfVxuICAgICAgICAgICAgICAgICAgZGlmZmljdWx0eUZpbHRlcnM9e2RpZmZpY3VsdHlGaWx0ZXJzfVxuICAgICAgICAgICAgICAgICAgb25TZXRTb3J0PXt0aGlzLm9uU2V0U29ydH1cbiAgICAgICAgICAgICAgICAgIG9uQ2xlYXJGaWx0ZXJzPXt0aGlzLm9uUmVzZXRNb2RhbH1cbiAgICAgICAgICAgICAgICAgIGhhbmRsZUZpbHRlckNsaWNrPXt0aGlzLmhhbmRsZUZpbHRlckNsaWNrfVxuICAgICAgICAgICAgICAgICAgb25TZXRGaWx0ZXJlZFN0YXRlPXt0aGlzLm9uU2V0RmlsdGVyZWRTdGF0ZX1cbiAgICAgICAgICAgICAgICAgIG9uVW5zZXRGaWx0ZXJlZFN0YXRlPXt0aGlzLm9uVW5zZXRGaWx0ZXJlZFN0YXRlfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjYXJkLWNvbnRlbnRcIj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2FyZC1ib2R5XCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicmVzdWx0LXJvdyBjZW50ZXItYWxpZ25cIj5cbiAgICAgICAgICAgICAgICAgICAgICA8YiBjbGFzc05hbWU9XCJyZXN1bHRcIj4gLSB7dGhpcy5nZXRNYXBwYWJsZVdvcmtzaGVldHMoKS5sZW5ndGh9IHJlc3VsdHMgLTwvYj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2hlY2tib3hlcy1zZWN0aW9uIHJvdyBkLWZsZXgtY29udGVudCBjYXJkLXdpZHRoLTMyMlwiPlxuICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLm1hcFdvcmtzaGVldHMoKX1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWRkLWJ0bi1ibG9ja1wiPlxuICAgICAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgICAgICBocmVmPVwiI1wiXG4gICAgICAgICAgICAgICAgICBkYXRhLXRhcmdldD0nZHJvcGRvd25fYXNzaWduX3NlbGVjdGVkJ1xuICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vblRvZ2dsZUFzc2lnblNlbGVjdGVkRHJvcGRvd259XG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJkcm9wZG93bi10cmlnZ2VyIHdhdmVzLWVmZmVjdCB3YXZlcy10ZWFsIGJ0biBhZGQtYnRuXCJcbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJtYXRlcmlhbC1pY29uc1wiPmFkZDwvaT4gQXNzaWduIFNlbGVjdGVkXG4gICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgIDx1bFxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSdkcm9wZG93bi1jb250ZW50J1xuICAgICAgICAgICAgICAgICAgaWQ9J2Ryb3Bkb3duX2Fzc2lnbl9zZWxlY3RlZCdcbiAgICAgICAgICAgICAgICAgIHN0eWxlPXt7IGRpc3BsYXk6IGFzc2lnblNlbGVjdGVkRHJvcGRvd25PcGVuID8gJ2Jsb2NrJyA6ICcwJywgb3BhY2l0eTogYXNzaWduU2VsZWN0ZWREcm9wZG93bk9wZW4gPyAnMScgOiAnMCcgfX1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cIiNcIiBvbkNsaWNrPXsoKSA9PiB0aGlzLmFzc2lnbldvcmtzaGVldHMoJ3RvZGF5Jyl9PkZvciBUb2RheTwvYT48L2xpPlxuICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCIjXCIgb25DbGljaz17KCkgPT4gdGhpcy5hc3NpZ25Xb3Jrc2hlZXRzKCd0b21vcnJvdycpfT5Gb3IgVG9tb3Jyb3c8L2E+PC9saT5cbiAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiI1wiIG9uQ2xpY2s9eygpID0+IHRoaXMuYXNzaWduV29ya3NoZWV0cygnbmV4dFNlc3Npb24nKX0+Rm9yIE5leHQgU2Vzc2lvbjwvYT48L2xpPlxuICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCIjXCIgb25DbGljaz17KCkgPT4gdGhpcy5hc3NpZ25Xb3Jrc2hlZXRzKCdjdXN0b21EYXRlJyl9PkZvciBEYXRlLi4uPC9hPjwvbGk+XG4gICAgICAgICAgICAgICAgPC91bD5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICl9XG4gICAgICAgIDxzdHlsZSBqc3g+XG4gICAgICAgICAge2BcbiAgICAgICAgICAgIC5jYXJkLW1vZGFsIHtcbiAgICAgICAgICAgICAgbWFyZ2luOiAwO1xuICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiA2cHg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAud3JhcHBlciB7XG4gICAgICAgICAgICAgIG1pbi1oZWlnaHQ6IDBweDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC5tb2RhbC1jdXN0b20ge1xuICAgICAgICAgICAgICBvcGFjaXR5OiAxO1xuICAgICAgICAgICAgICB2aXNpYmlsaXR5OiB2aXNpYmxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLm1vZGFsLWZvb3RlciB7XG4gICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIGB9XG4gICAgICAgIDwvc3R5bGU+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG59XG5cbkFzc2lnbldvcmtzaGVldE1vZGFsLnByb3BUeXBlcyA9IHtcbiAgb3BlbjogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgb25DbG9zZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgb25Bc3NpZ25Xb3Jrc2hlZXRzOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxufTtcblxuZXhwb3J0IGRlZmF1bHQgQXNzaWduV29ya3NoZWV0TW9kYWw7XG4iXX0= */\\n/*@ sourceURL=/Volumes/HDD/Sites/clearchoicetestprep/clear-choice-admin/components/Dashboard/components/Modals/AssignWorksheetModal/index.js */\"));\n  }\n\n}\n\nAssignWorksheetModal.propTypes = {\n  open: PropTypes.bool.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onAssignWorksheets: PropTypes.func.isRequired\n};\nexport default AssignWorksheetModal;","map":{"version":3,"sources":["/Volumes/HDD/Sites/clearchoicetestprep/clear-choice-admin/components/Dashboard/components/Modals/AssignWorksheetModal/index.js"],"names":["React","PropTypes","update","moment","Portal","FilterSection","WorksheetCard","difficultySort","problemSort","timeEstimateSort","subjectSort","sampleWorksheets","worksheetTypeMap","worksheetSourceMap","worksheetDifficultyMap","worksheetSubjectMap","AssignWorksheetModal","Component","constructor","props","setState","assignSelectedDropdownOpen","dropdownIndex","dropdownIsOpen","sourceFilters","difficultyFilters","subjectFilters","typeFilters","sort","titleFilter","value","onClose","onResetModal","worksheets","state","reduce","finalArr","currentWorksheet","title","worksheetString","replace","toLowerCase","indexOf","push","unitFilter","unit","allWorksheets","length","filter","worksheet","subject","type","source","difficulty","mappableWorksheets","onFilterByTitle","onFilterByUnit","onFilterWorksheets","onSortWorksheets","filterType","currentSourceFilters","currentDifficultyFilters","currentSubjectFilters","currentTypeFilters","modifiedFilterCurrentState","modifiedFilterName","modifiedFilterUpdatedState","$push","filterIndex","$splice","selectedWorksheets","modifiedWorksheets","worksheetIndex","date","onAssignWorksheets","assignDate","format","add","onToggleAssignSelectedDropdown","getMappableWorksheets","map","index","id","onSetDropdown","onCloseDropdown","handleWorksheetClick","render","open","minWidth","onCloseModal","onSetSort","handleFilterClick","onSetFilteredState","onUnsetFilteredState","mapWorksheets","display","opacity","assignWorksheets","propTypes","bool","isRequired","func"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport update from 'immutability-helper';\nimport moment from 'moment';\n\nimport Portal from '../../../../Portal';\n\nimport FilterSection from './components/FilterSection';\nimport WorksheetCard from './components/WorksheetCard';\nimport { difficultySort, problemSort, timeEstimateSort, subjectSort } from '../../../utils/sortOptions';\nimport sampleWorksheets from '../../../utils/sampleWorksheets';\nimport { worksheetTypeMap, worksheetSourceMap, worksheetDifficultyMap, worksheetSubjectMap } from '../../../utils/worksheetModalMaps';\n\nclass AssignWorksheetModal extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      sort: '',\n      unitFilter: '',\n      titleFilter: '',\n      typeFilters: [],\n      sourceFilters: [],\n      subjectFilters: [],\n      selectedWorksheets: [],\n      difficultyFilters: [],\n      worksheets: sampleWorksheets,\n      dropdownIndex: null,\n      dropdownIsOpen: false,\n      assignSelectedDropdownOpen: false,\n    };\n  }\n\n  onToggleAssignSelectedDropdown = () => this.setState(({ assignSelectedDropdownOpen }) => ({ assignSelectedDropdownOpen: !assignSelectedDropdownOpen }))\n\n  onSetDropdown = (dropdownIndex) => this.setState({ dropdownIndex, dropdownIsOpen: true });\n  onCloseDropdown = () => this.setState({ dropdownIsOpen: false });\n\n  onResetModal = () => this.setState({ sourceFilters: [], difficultyFilters: [], subjectFilters: [], typeFilters: [], sort: '' })\n  onSetSort = (sort) => this.setState({ sort })\n\n  onSetFilteredState = (titleFilter, value) => this.setState({ [titleFilter]: value })\n  onUnsetFilteredState = (titleFilter) => this.setState({ [titleFilter]: '' })\n\n  onCloseModal = () => {\n    const { onClose } = this.props;\n    onClose();\n    this.onResetModal();\n  }\n\n  // eslint-disable-next-line consistent-return\n  onSortWorksheets = (worksheets) => {\n    const { sort } = this.state;\n    switch (sort) {\n      case 'difficulty':\n        return worksheets.sort(difficultySort);\n      case 'problems':\n        return worksheets.sort(problemSort);\n      case 'timeEstimate':\n        return worksheets.sort(timeEstimateSort);\n      case 'subject':\n        return worksheets.sort(subjectSort);\n      default:\n        break;\n    }\n  }\n\n  onFilterByTitle = () => {\n    const { worksheets, titleFilter } = this.state;\n    return worksheets.reduce((finalArr, currentWorksheet) => {\n      const { title } = currentWorksheet;\n      const worksheetString = title.replace(/\\s/g, \"\").toLowerCase();\n      if (worksheetString.indexOf(titleFilter) !== -1 && finalArr.indexOf(currentWorksheet) === -1) {\n        finalArr.push(currentWorksheet);\n      }\n      return finalArr;\n    }, []);\n  }\n\n  onFilterByUnit = () => {\n    const { worksheets, unitFilter } = this.state;\n    return worksheets.reduce((finalArr, currentWorksheet) => {\n      const { unit } = currentWorksheet;\n      const worksheetString = unit.replace(/\\s/g, \"\").toLowerCase();\n      if (worksheetString.indexOf(unitFilter) !== -1 && finalArr.indexOf(currentWorksheet) === -1) {\n        finalArr.push(currentWorksheet);\n      }\n      return finalArr;\n    }, []);\n  }\n\n  onFilterWorksheets = () => {\n    const { subjectFilters, typeFilters, sourceFilters, difficultyFilters, worksheets: allWorksheets } = this.state;\n    let worksheets = allWorksheets;\n    if (subjectFilters.length) {\n      worksheets = worksheets.filter(worksheet => subjectFilters.indexOf(worksheetSubjectMap[worksheet.subject]) !== -1);\n    }\n    if (typeFilters.length) {\n      worksheets = worksheets.filter(worksheet => typeFilters.indexOf(worksheetTypeMap[worksheet.type]) !== -1);\n    }\n    if (sourceFilters.length) {\n      worksheets = worksheets.filter(worksheet => sourceFilters.indexOf(worksheetSourceMap[worksheet.source]) !== -1);\n    }\n    if (difficultyFilters.length) {\n      worksheets = worksheets.filter(worksheet => difficultyFilters.indexOf(worksheetDifficultyMap[worksheet.difficulty]) !== -1);\n    }\n    return worksheets;\n  }\n\n  getMappableWorksheets = () => {\n    const { subjectFilters, typeFilters, difficultyFilters, sourceFilters, sort, unitFilter, titleFilter, worksheets } = this.state;\n    let mappableWorksheets = worksheets;\n    if (titleFilter.length) {\n      mappableWorksheets = this.onFilterByTitle();\n    }\n    if (unitFilter.length) {\n      mappableWorksheets = this.onFilterByUnit();\n    }\n    if (subjectFilters.length || typeFilters.length || difficultyFilters.length || sourceFilters.length) {\n      mappableWorksheets = this.onFilterWorksheets();\n    }\n    if (sort) {\n      return this.onSortWorksheets(mappableWorksheets);\n    }\n    return mappableWorksheets;\n  }\n\n  handleFilterClick = (filterType, filter) => {\n    const { sourceFilters: currentSourceFilters, difficultyFilters: currentDifficultyFilters,\n      subjectFilters: currentSubjectFilters, typeFilters: currentTypeFilters } = this.state;\n    let modifiedFilterCurrentState;\n    let modifiedFilterName;\n    let modifiedFilterUpdatedState;\n    switch (filterType) {\n      case 'subject':\n        modifiedFilterCurrentState = currentSubjectFilters;\n        modifiedFilterName = 'subjectFilters';\n        break;\n      case 'type':\n        modifiedFilterCurrentState = currentTypeFilters;\n        modifiedFilterName = 'typeFilters';\n        break;\n      case 'source':\n        modifiedFilterCurrentState = currentSourceFilters;\n        modifiedFilterName = 'sourceFilters';\n        break;\n      case 'difficulty':\n        modifiedFilterCurrentState = currentDifficultyFilters;\n        modifiedFilterName = 'difficultyFilters';\n        break;\n      default:\n        break;\n    }\n    if (modifiedFilterCurrentState.indexOf(filter) === -1) {\n      modifiedFilterUpdatedState = update(modifiedFilterCurrentState, {\n        $push: [filter],\n      });\n    } else {\n      const filterIndex = modifiedFilterCurrentState.indexOf(filter);\n      modifiedFilterUpdatedState = update(modifiedFilterCurrentState, {\n        $splice: [[ filterIndex, 1 ]],\n      });\n    }\n    this.setState({ [modifiedFilterName]: modifiedFilterUpdatedState });\n  }\n\n  handleWorksheetClick = (worksheet) => {\n    const { selectedWorksheets } = this.state;\n    let modifiedWorksheets;\n    if (selectedWorksheets.indexOf(worksheet) === -1) {\n      modifiedWorksheets = update(selectedWorksheets, {\n        $push: [worksheet],\n      });\n    } else {\n      const worksheetIndex = selectedWorksheets.indexOf(worksheet);\n      modifiedWorksheets = update(selectedWorksheets, {\n        $splice: [[ worksheetIndex, 1 ]],\n      });\n    }\n    this.setState({ selectedWorksheets: modifiedWorksheets });\n  }\n\n  assignWorksheets = (date) => {\n    const { onAssignWorksheets } = this.props;\n    const { selectedWorksheets } = this.state;\n    let assignDate;\n    switch (date) {\n      case 'today':\n        assignDate = moment().format('MM/DD/YY');\n        break;\n      case 'tomorrow':\n        assignDate = moment().add(1, 'days').format('MM/DD/YY');\n        break;\n      case 'nextSession':\n        break;\n      case 'customDate':\n        assignDate = '01/05/19';\n        break;\n      default:\n        break;\n    }\n    this.onToggleAssignSelectedDropdown();\n    onAssignWorksheets(selectedWorksheets, assignDate);\n  }\n\n  mapWorksheets = () => this.getMappableWorksheets().map((worksheet, index) => (\n    <WorksheetCard\n      worksheet={worksheet}\n      index={index}\n      key={worksheet.id}\n      onSetDropdown={this.onSetDropdown}\n      onCloseDropdown={this.onCloseDropdown}\n      dropdownIndex={this.state.dropdownIndex}\n      dropdownIsOpen={this.state.dropdownIsOpen}\n      handleWorksheetClick={this.handleWorksheetClick}\n      selectedWorksheets={this.state.selectedWorksheets}\n    />\n  ))\n\n  render() {\n    const { open } = this.props;\n    const { assignSelectedDropdownOpen, typeFilters, sourceFilters, subjectFilters, difficultyFilters, sort } = this.state;\n    return (\n      <div>\n        {open && (\n          <div className=\"wrapper\">\n              <div className=\"card-modal card-main card switcher-section grey lighten-3\" style = {{minWidth:\"100%\"}}>\n                <div className=\"header-row card-panel light-blue lighten-1 white-text\">\n                  <div className=\"card-panel-row row\">\n                    <div className=\"col s11\">\n                      <div className=\"d-flex\">\n                        <div className=\"icon-col\">\n                          <i className=\"icon-sheets-w\"></i>\n                        </div>\n                        <div className=\"card-panel-text\">\n                          <div className=\"text-large\">Assign Worksheets</div>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"col s1 right-align\">\n                      <div className=\"row icons-row\"><a href=\"#\" onClick={this.onCloseModal} className=\"modal-close close\"><i className=\"icon-close-thin\"></i></a></div>\n                    </div>\n                  </div>\n                </div>\n                <FilterSection\n                  sort={sort}\n                  typeFilters={typeFilters}\n                  sourceFilters={sourceFilters}\n                  subjectFilters={subjectFilters}\n                  difficultyFilters={difficultyFilters}\n                  onSetSort={this.onSetSort}\n                  onClearFilters={this.onResetModal}\n                  handleFilterClick={this.handleFilterClick}\n                  onSetFilteredState={this.onSetFilteredState}\n                  onUnsetFilteredState={this.onUnsetFilteredState}\n                />\n                <div className=\"card-content\">\n                  <div className=\"card-body\">\n                    <div className=\"result-row center-align\">\n                      <b className=\"result\"> - {this.getMappableWorksheets().length} results -</b>\n                    </div>\n                    <div className=\"checkboxes-section row d-flex-content card-width-322\">\n                      {this.mapWorksheets()}\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div className=\"add-btn-block\">\n                <a\n                  href=\"#\"\n                  data-target='dropdown_assign_selected'\n                  onClick={this.onToggleAssignSelectedDropdown}\n                  className=\"dropdown-trigger waves-effect waves-teal btn add-btn\"\n                >\n                  <i className=\"material-icons\">add</i> Assign Selected\n                </a>\n                <ul\n                  className='dropdown-content'\n                  id='dropdown_assign_selected'\n                  style={{ display: assignSelectedDropdownOpen ? 'block' : '0', opacity: assignSelectedDropdownOpen ? '1' : '0' }}\n                >\n                  <li><a href=\"#\" onClick={() => this.assignWorksheets('today')}>For Today</a></li>\n                  <li><a href=\"#\" onClick={() => this.assignWorksheets('tomorrow')}>For Tomorrow</a></li>\n                  <li><a href=\"#\" onClick={() => this.assignWorksheets('nextSession')}>For Next Session</a></li>\n                  <li><a href=\"#\" onClick={() => this.assignWorksheets('customDate')}>For Date...</a></li>\n                </ul>\n              </div>\n          </div>\n        )}\n        <style jsx>\n          {`\n            .card-modal {\n              margin: 0;\n              border-radius: 6px;\n            }\n            .wrapper {\n              min-height: 0px;\n            }\n            .modal-custom {\n              opacity: 1;\n              visibility: visible;\n            }\n            .modal-footer {\n              background-color: white;\n            }\n          `}\n        </style>\n      </div>\n    );\n  }\n}\n\nAssignWorksheetModal.propTypes = {\n  open: PropTypes.bool.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onAssignWorksheets: PropTypes.func.isRequired,\n};\n\nexport default AssignWorksheetModal;\n"]},"metadata":{},"sourceType":"module"}