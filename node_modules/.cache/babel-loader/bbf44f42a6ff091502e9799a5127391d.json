{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport update from 'immutability-helper';\nimport Owner from './components/Owner';\nimport LocationContactInfo from './components/LocationContactInfo';\nimport LocationEmailSettings from './components/LocationEmailSettings';\nimport { nestedEditFieldValidation } from '../../utils/fieldValidation';\n\nvar DetailAccountPage =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(DetailAccountPage, _React$Component);\n\n  function DetailAccountPage(props) {\n    var _this;\n\n    _classCallCheck(this, DetailAccountPage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(DetailAccountPage).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"componentWillReceiveProps\", function (nextProps) {\n      if (!_this.state.originalLocation || nextProps.location.id !== _this.state.originalLocation.id) {\n        var _nextProps$location = nextProps.location;\n        _nextProps$location = _nextProps$location === void 0 ? {} : _nextProps$location;\n        var id = _nextProps$location.id,\n            owner = _nextProps$location.owner,\n            locationEmailSettings = _nextProps$location.locationEmailSettings,\n            locationContactInfo = _nextProps$location.locationContactInfo;\n        var updatedLocation = {\n          id: id,\n          locationEmailSettings: locationEmailSettings,\n          locationContactInfo: locationContactInfo\n        };\n        var originalLocationState = _this.state.originalLocation;\n        var originalLocation = update(originalLocationState, {\n          $merge: nextProps.location\n        });\n\n        _this.setState({\n          originalLocation: originalLocation,\n          updatedLocation: updatedLocation,\n          owner: owner\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSetValidation\", function (validation, cb) {\n      return _this.setState({\n        validation: validation\n      }, cb);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSaveChanges\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(event) {\n        var updatedLocation, valid;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                event.preventDefault(); // const { onSavePassageChanges, onSaveChangesError, onSetPassageValidation } = this.props;\n\n                updatedLocation = _this.state.updatedLocation;\n                _context.next = 4;\n                return nestedEditFieldValidation(_this.state, _this.state.updatedLocation, _this.onSetValidation, function (validation) {\n                  return console.warn('validation', validation);\n                });\n\n              case 4:\n                valid = _context.sent;\n\n                if (!valid) {\n                  // return onSaveChangesError();\n                  console.warn('not valid');\n                }\n\n                _this.setState({\n                  originalLocation: updatedLocation\n                }); // return onSavePassageChanges(updatedLocation);\n\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"initialLocationMount\", function () {\n      return _this.state.originalLocation.id !== _this.props.location.id;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDetailsChange\", function (event, name, section) {\n      var previousLocationState = _this.state.updatedLocation;\n      var value = event.target ? event.target.value : event;\n      var updatedLocation = update(previousLocationState, _defineProperty({}, section, {\n        $merge: _defineProperty({}, name, value)\n      }));\n\n      _this.setState({\n        updatedLocation: updatedLocation\n      });\n    });\n\n    _this.state = {\n      owner: {\n        firstName: '',\n        lastName: '',\n        email: ''\n      },\n      originalLocation: {\n        locationEmailSettings: {\n          automatedEmailOrigin: '',\n          automatedEmailSalutation: ''\n        },\n        locationContactInfo: {\n          locationName: '',\n          locationNickname: '',\n          locationEmail: '',\n          locationPhoneNumber: '',\n          website: '',\n          locationStreetAddress: '',\n          locationCity: '',\n          locationState: '',\n          locationZip: ''\n        }\n      },\n      updatedLocation: {\n        locationEmailSettings: {\n          automatedEmailOrigin: '',\n          automatedEmailSalutation: ''\n        },\n        locationContactInfo: {\n          locationName: '',\n          locationNickname: '',\n          locationEmail: '',\n          locationPhoneNumber: '',\n          website: '',\n          locationStreetAddress: '',\n          locationCity: '',\n          locationState: '',\n          locationZip: ''\n        }\n      },\n      validation: {\n        locationEmailSettings: {\n          automatedEmailOriginAddress: true,\n          automatedEmailSalutation: true\n        },\n        locationContactInfo: {\n          locationName: true,\n          locationNickname: true,\n          locationEmail: true\n        }\n      }\n    };\n    return _this;\n  }\n\n  _createClass(DetailAccountPage, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props$location = this.props.location;\n      _this$props$location = _this$props$location === void 0 ? {} : _this$props$location;\n      var id = _this$props$location.id,\n          owner = _this$props$location.owner,\n          locationEmailSettings = _this$props$location.locationEmailSettings,\n          locationContactInfo = _this$props$location.locationContactInfo;\n      var updatedLocation = {\n        id: id,\n        locationEmailSettings: locationEmailSettings,\n        locationContactInfo: locationContactInfo\n      };\n      var originalLocationState = this.state.originalLocation;\n      var originalLocation = update(originalLocationState, {\n        $merge: updatedLocation\n      });\n      this.setState({\n        originalLocation: originalLocation,\n        updatedLocation: updatedLocation,\n        owner: owner\n      }); // eslint-disable-line\n    } // TODO: This seems to be working well - confirm that only one isntance of this edit modal is opening on the location edit page\n    // This resets the component state to reflect the details of the next location the location clicks on\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      // TODO: Update navbar info with actual sample location data\n      var _this$state$updatedLo = this.state.updatedLocation,\n          updatedLocationEmailSettings = _this$state$updatedLo.locationEmailSettings,\n          updatedLocationContactInfo = _this$state$updatedLo.locationContactInfo;\n      var _this$props$location2 = this.props.location,\n          owner = _this$props$location2.owner,\n          locationEmailSettings = _this$props$location2.locationEmailSettings,\n          locationContactInfo = _this$props$location2.locationContactInfo;\n      return React.createElement(\"div\", {\n        className: \"content-section\"\n      }, React.createElement(\"div\", {\n        className: \"content-section-holder\"\n      }, React.createElement(\"div\", {\n        className: \"row mb-0 d-flex-content large\"\n      }, React.createElement(\"div\", {\n        className: \"col s12 l5\"\n      }, React.createElement(Owner, {\n        state: owner\n      }), React.createElement(LocationEmailSettings, {\n        state: this.initialLocationMount() ? locationEmailSettings : updatedLocationEmailSettings,\n        handleDetailsChange: this.handleDetailsChange\n      })), React.createElement(LocationContactInfo, {\n        state: this.initialLocationMount() ? locationContactInfo : updatedLocationContactInfo,\n        handleDetailsChange: this.handleDetailsChange\n      })), React.createElement(\"div\", {\n        className: \"btn-holder align-right-sm\"\n      }, React.createElement(\"a\", {\n        href: \"#\",\n        className: \"btn\",\n        onClick: this.onSaveChanges\n      }, \"Save\"))));\n    }\n  }]);\n\n  return DetailAccountPage;\n}(React.Component);\n\nexport default DetailAccountPage;","map":null,"metadata":{},"sourceType":"module"}