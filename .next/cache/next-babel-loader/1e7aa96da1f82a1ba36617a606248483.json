{"ast":null,"code":"import _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\n\n/* eslint-disable array-callback-return */\nimport React from 'react';\nimport update from 'immutability-helper';\nimport Portal from '../../../Portal';\nimport ClickOffComponentWrapper from '../../../ClickOffComponentWrapper';\nimport OwnerSection from '../SharedModalComponents/OwnerSection';\nimport LocationContactInfo from '../SharedModalComponents/LocationContactInfo';\nimport LocationEmailSettings from '../SharedModalComponents/LocationEmailSettings';\nimport LocationBranding from '../SharedModalComponents/LocationBranding';\nimport sampleOwners from '../NewLocationModal/utils/sampleOwners';\nimport { nestedEditFieldValidation } from '../../../utils/fieldValidation'; // TODO: Render only one instance of this modal\n\nclass LocationDetailsModal extends React.Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"componentWillReceiveProps\", nextProps => {\n      if (!this.state.originalLocation || nextProps.location.id !== this.state.originalLocation.id) {\n        const {\n          location: {\n            owner,\n            id,\n            locationContactInfo,\n            locationEmailSettings,\n            locationBranding\n          } = {}\n        } = nextProps;\n        const updatedLocation = {\n          owner,\n          id,\n          locationContactInfo,\n          locationEmailSettings,\n          locationBranding\n        };\n        const {\n          originalLocation: originalLocationState\n        } = this.state;\n        const originalLocation = update(originalLocationState, {\n          $merge: nextProps.location\n        });\n        this.setState({\n          originalLocation,\n          updatedLocation\n        });\n      }\n    });\n\n    _defineProperty(this, \"onOpenUserListModal\", () => this.setState({\n      userListModalOpen: true,\n      changeModalOpen: false\n    }));\n\n    _defineProperty(this, \"onCloseUserListModal\", () => this.setState({\n      userListModalOpen: false\n    }));\n\n    _defineProperty(this, \"onOpenChangeModal\", () => this.setState({\n      changeModalOpen: true\n    }));\n\n    _defineProperty(this, \"onCloseChangeModal\", () => this.setState({\n      changeModalOpen: false\n    }));\n\n    _defineProperty(this, \"onSetValidation\", (validation, cb) => this.setState({\n      validation\n    }, cb));\n\n    _defineProperty(this, \"onSubmit\", async event => {\n      event.preventDefault();\n      const {\n        updatedLocation\n      } = this.state;\n      const {\n        onSaveLocationChanges,\n        onSaveLocationError,\n        onClose\n      } = this.props; // const valid = true;\n\n      const valid = await nestedEditFieldValidation(this.state, this.state.updatedLocation, this.onSetValidation, this.props.onSetLocationValidation);\n\n      if (!valid) {\n        return onSaveLocationError();\n      }\n\n      onSaveLocationChanges(updatedLocation);\n      return onClose();\n    });\n\n    _defineProperty(this, \"initialLocationMount\", () => this.state.originalLocation.id !== this.props.location.id);\n\n    _defineProperty(this, \"handleDetailsChange\", (event, name, stateKey) => {\n      const {\n        updatedLocation: previousLocationState\n      } = this.state;\n      let value;\n\n      if (event.hex) {\n        value = event.hex;\n      } else if (event.target) {\n        value = event.target.value;\n      } else {\n        value = event;\n      }\n\n      let updatedLocation;\n\n      if (name === 'owner') {\n        updatedLocation = update(previousLocationState, {\n          owner: {\n            $set: event\n          }\n        });\n      } else {\n        updatedLocation = update(previousLocationState, {\n          [stateKey]: {\n            $merge: {\n              [name]: value\n            }\n          }\n        });\n      }\n\n      this.setState({\n        updatedLocation\n      });\n    });\n\n    this.state = {\n      owner: null,\n      userListModalOpen: false,\n      changeModalOpen: false,\n      originalLocation: {\n        id: '',\n        locationContactInfo: {\n          locationName: '',\n          locationNickname: '',\n          locationEmail: '',\n          locationPhoneNumber: '',\n          website: '',\n          locationStreetAddress: '',\n          locationCity: '',\n          locationState: '',\n          locationZip: ''\n        },\n        locationEmailSettings: {\n          automatedEmailOrigin: '',\n          automatedEmailSalutation: ''\n        },\n        locationBranding: {\n          locationUrl: '',\n          headerColor1: '',\n          headerColor2: '',\n          headerLogoBackgroundColor: '',\n          headerLogoBackgroundAlpha: '',\n          horizontalLogoVariation: '',\n          squareLogoVariation: '',\n          backgroundImage: '',\n          backgroundBlur: '',\n          backgroundOverlayAlpha: '',\n          studentWelcomeVideo: '',\n          instructorWelcomeVideo: ''\n        }\n      },\n      updatedLocation: {\n        id: '',\n        locationContactInfo: {\n          locationName: '',\n          locationNickname: '',\n          locationEmail: '',\n          locationPhoneNumber: '',\n          website: '',\n          locationStreetAddress: '',\n          locationCity: '',\n          locationState: '',\n          locationZip: ''\n        },\n        locationEmailSettings: {\n          automatedEmailOrigin: '',\n          automatedEmailSalutation: ''\n        },\n        locationBranding: {\n          locationUrl: '',\n          headerColor1: '',\n          headerColor2: '',\n          headerLogoBackgroundColor: '',\n          headerLogoBackgroundAlpha: '',\n          horizontalLogoVariation: '',\n          squareLogoVariation: '',\n          backgroundImage: '',\n          backgroundBlur: '',\n          backgroundOverlayAlpha: '',\n          studentWelcomeVideo: '',\n          instructorWelcomeVideo: ''\n        }\n      },\n      validation: {\n        locationContactInfo: {\n          locationName: true,\n          locationNickname: true,\n          locationEmail: true\n        },\n        locationEmailSettings: {\n          automatedEmailOrigin: true,\n          automatedEmailSalutation: true\n        },\n        locationBranding: {\n          locationUrl: true,\n          headerColor1: true,\n          headerColor2: true,\n          headerLogoBackgroundColor: true,\n          headerLogoBackgroundAlpha: true,\n          horizontalLogoVariation: true,\n          squareLogoVariation: true,\n          backgroundImage: true,\n          backgroundBlur: true,\n          backgroundOverlayAlpha: true\n        }\n      }\n    };\n  }\n\n  componentDidMount() {\n    const {\n      location: {\n        owner,\n        id,\n        locationContactInfo,\n        locationEmailSettings,\n        locationBranding\n      } = {}\n    } = this.props;\n    const updatedLocation = {\n      owner,\n      id,\n      locationContactInfo,\n      locationEmailSettings,\n      locationBranding\n    };\n    const {\n      originalLocation: originalLocationState\n    } = this.state;\n    const originalLocation = update(originalLocationState, {\n      $merge: updatedLocation\n    });\n    this.setState({\n      originalLocation,\n      updatedLocation\n    }); // eslint-disable-line\n  } // TODO: This seems to be working well - confirm that only one isntance of this edit modal is opening on the user edit page\n  // This resets the component state to reflect the details of the next user the user clicks on\n\n\n  render() {\n    const {\n      open,\n      onClose,\n      location\n    } = this.props;\n    const {\n      owner,\n      locationContactInfo,\n      locationEmailSettings,\n      locationBranding\n    } = location;\n    const {\n      updatedLocation: {\n        owner: updatedOwner,\n        locationContactInfo: updatedLocationContactInfo,\n        locationEmailSettings: updatedLocationEmailSettings,\n        locationBranding: updatedLocationBranding\n      },\n      validation: {\n        locationContactInfo: locationContactInfoValidation,\n        locationEmailSettings: locationEmailSettingsValidation,\n        locationBranding: locationBrandingValidation\n      },\n      userListModalOpen,\n      changeModalOpen\n    } = this.state;\n    return __jsx(Portal, {\n      selector: \"#modal\"\n    }, open && __jsx(\"form\", {\n      className: \"jsx-3756323712\"\n    }, __jsx(\"div\", {\n      className: \"jsx-3756323712\" + \" \" + \"overlay\"\n    }, __jsx(ClickOffComponentWrapper, {\n      nestedModals: userListModalOpen || changeModalOpen,\n      onOuterClick: onClose\n    }, __jsx(\"div\", {\n      id: \"modal_location_create\",\n      className: \"jsx-3756323712\" + \" \" + \"modal modal-custom modal-custom-large modal-gray\"\n    }, __jsx(\"div\", {\n      className: \"jsx-3756323712\" + \" \" + \"card-modal card-main card grey lighten-3\"\n    }, __jsx(\"div\", {\n      className: \"jsx-3756323712\" + \" \" + \"card-panel card-panel-title green lighten-1 white-text\"\n    }, __jsx(\"div\", {\n      className: \"jsx-3756323712\" + \" \" + \"card-panel-row row\"\n    }, __jsx(\"div\", {\n      className: \"jsx-3756323712\" + \" \" + \"col\"\n    }, __jsx(\"h3\", {\n      className: \"jsx-3756323712\" + \" \" + \"h2\"\n    }, __jsx(\"span\", {\n      className: \"jsx-3756323712\" + \" \" + \"heading-holder\"\n    }, __jsx(\"span\", {\n      className: \"jsx-3756323712\" + \" \" + \"heading-block\"\n    }, \"Edit Location\")))), __jsx(\"div\", {\n      style: {\n        textAlign: 'right'\n      },\n      className: \"jsx-3756323712\" + \" \" + \"col\"\n    }, __jsx(\"span\", {\n      className: \"jsx-3756323712\" + \" \" + \"block-icon\"\n    }, __jsx(\"i\", {\n      className: \"jsx-3756323712\" + \" \" + \"icon-location\"\n    }), __jsx(\"span\", {\n      className: \"jsx-3756323712\" + \" \" + \"text-icon\"\n    }, \"Location\"))))), __jsx(\"div\", {\n      className: \"jsx-3756323712\" + \" \" + \"card-content\"\n    }, __jsx(\"div\", {\n      className: \"jsx-3756323712\" + \" \" + \"card-body\"\n    }, __jsx(\"div\", {\n      className: \"jsx-3756323712\" + \" \" + \"row mb-0\"\n    }, __jsx(\"div\", {\n      className: \"jsx-3756323712\" + \" \" + \"col s12 l6\"\n    }, __jsx(OwnerSection, {\n      owner: this.initialLocationMount() ? owner : updatedOwner,\n      userList: sampleOwners,\n      handleDetailsChange: this.handleDetailsChange,\n      userListModalOpen: userListModalOpen,\n      changeModalOpen: changeModalOpen,\n      onOpenUserListModal: this.onOpenUserListModal,\n      onCloseUserListModal: this.onCloseUserListModal,\n      onOpenChangeModal: this.onOpenChangeModal,\n      onCloseChangeModal: this.onCloseChangeModal\n    }), __jsx(LocationContactInfo, {\n      state: this.initialLocationMount() ? locationContactInfo : updatedLocationContactInfo,\n      handleDetailsChange: this.handleDetailsChange,\n      validation: locationContactInfoValidation,\n      noColumn: true\n    }), __jsx(LocationEmailSettings, {\n      state: this.initialLocationMount() ? locationEmailSettings : updatedLocationEmailSettings,\n      handleDetailsChange: this.handleDetailsChange,\n      validation: locationEmailSettingsValidation,\n      noColumn: true\n    })), __jsx(LocationBranding, {\n      state: this.initialLocationMount() ? locationBranding : updatedLocationBranding,\n      handleDetailsChange: this.handleDetailsChange,\n      validation: locationBrandingValidation\n    }))), __jsx(\"div\", {\n      className: \"jsx-3756323712\" + \" \" + \"modal-footer\"\n    }, __jsx(\"a\", {\n      href: \"#!\",\n      onClick: onClose,\n      className: \"jsx-3756323712\" + \" \" + \"modal-close waves-effect waves-teal btn-flat pink-text text-darken-1\"\n    }, \"Cancel\"), __jsx(\"a\", {\n      href: \"#\",\n      style: {\n        color: 'white'\n      },\n      onClick: this.onSubmit,\n      className: \"jsx-3756323712\" + \" \" + \"btn\"\n    }, \"Save\")))))))), __jsx(_JSXStyle, {\n      id: \"3756323712\"\n    }, [\"h4.jsx-3756323712{font-size:2.28rem;line-height:110%;margin:1.52rem 0 .912rem 0;margin-top:0;}\", \"p.jsx-3756323712{font-size:16px;color:#343434;}\", \"p.passage.jsx-3756323712{font-size:14px;}\", \"a.jsx-3756323712{color:#343434;}\", \".overlay.jsx-3756323712{position:fixed;background-color:rgba(0,0,0,0.7);top:0;right:0;bottom:0;left:0;z-index:1999;}\", \".modal.jsx-3756323712{display:block;background-color:transparent;position:absolute;top:10%;right:10%;left:10%;box-shadow:0 24px 38px 3px rgba(0,0,0,0.14),0 9px 46px 8px rgba(0,0,0,0.12),0 11px 15px -7px rgba(0,0,0,0.2);}\", \".modal-footer.jsx-3756323712{background-color:white;}\", \".modal-custom.jsx-3756323712{opacity:1;visibility:visible;}\", \".modal-full-size.jsx-3756323712{z-index:999;width:100%;left:0;top:0;right:0;bottom:0;}\"]));\n  }\n\n}\n\nexport default LocationDetailsModal;","map":null,"metadata":{},"sourceType":"module"}