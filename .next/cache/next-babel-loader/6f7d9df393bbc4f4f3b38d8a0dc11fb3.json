{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React from \"react\";\nimport Portal from \"../../../../Portal\";\nimport update from 'immutability-helper';\nimport ClickOffComponentWrapper from '../../../../ClickOffComponentWrapper';\nimport AccountInfo from '../SharedModalComponents/AccountInfo';\nimport ContactInfo from '../SharedModalComponents/ContactInfo';\nimport Locations from '../SharedModalComponents/Locations';\nimport { nestedEditFieldValidation } from '../../../../utils/fieldValidation';\n\nvar ClassDetailModal =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ClassDetailModal, _React$Component);\n\n  function ClassDetailModal(props) {\n    var _this;\n\n    _classCallCheck(this, ClassDetailModal);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ClassDetailModal).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"componentWillReceiveProps\", function (nextProps) {\n      if (!_this.state.originalClassRoom || nextProps.classroom.id !== _this.state.originalClassRoom.id) {\n        var _nextProps$classroom = nextProps.classroom;\n        _nextProps$classroom = _nextProps$classroom === void 0 ? {} : _nextProps$classroom;\n        var id = _nextProps$classroom.id,\n            basicInfo = _nextProps$classroom.basicInfo,\n            _accountInfo = _nextProps$classroom.accountInfo,\n            _contactInfo = _nextProps$classroom.contactInfo,\n            _locations = _nextProps$classroom.locations,\n            summary = _nextProps$classroom.summary;\n        var updatedClassRoom = {\n          id: id,\n          basicInfo: basicInfo,\n          accountInfo: _accountInfo,\n          contactInfo: _contactInfo,\n          locations: _locations,\n          summary: summary\n        };\n        var originalClassRoomState = _this.state.originalClassRoom;\n        var originalClassRoom = update(originalClassRoomState, {\n          $merge: nextProps.classroom\n        });\n\n        _this.setState({\n          originalClassRoom: originalClassRoom,\n          updatedClassRoom: updatedClassRoom\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDetailsChange\", function (event, name, section) {\n      var value = event.target ? event.target.value : event;\n      var updatedClassRoom = update(_this.state.updatedClassRoom, _defineProperty({}, section, {\n        $merge: _defineProperty({}, name, value)\n      }));\n\n      _this.setState({\n        updatedClassRoom: updatedClassRoom\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"initialClassRoomMount\", function () {\n      return _this.state.originalClassRoom.id !== _this.props.classroom.id;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderModalHeader\", function () {\n      var _this$props$classroom = _this.props.classroom.accountInfo,\n          initialLastName = _this$props$classroom.lastName,\n          initialFIrstName = _this$props$classroom.firstName,\n          initialEmail = _this$props$classroom.email;\n      var _this$state$updatedCl = _this.state.updatedClassRoom.accountInfo,\n          updatedLastName = _this$state$updatedCl.lastName,\n          updatedFirstName = _this$state$updatedCl.firstName,\n          updatedEmail = _this$state$updatedCl.email;\n      var lastName;\n      var firstName;\n      var email;\n\n      if (_this.initialClassRoomMount()) {\n        lastName = initialLastName;\n        firstName = initialFIrstName;\n        email = initialEmail;\n      } else {\n        lastName = updatedLastName;\n        firstName = updatedFirstName;\n        email = updatedEmail;\n      }\n\n      return __jsx(React.Fragment, null, __jsx(\"h4\", {\n        className: \"h3\"\n      }, lastName, \", \", firstName), __jsx(\"a\", {\n        href: \"mailto:\".concat(email)\n      }, email));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSetValidation\", function (validation, cb) {\n      return _this.setState({\n        validation: validation\n      }, cb);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSubmit\", function _callee(event) {\n      var _this$state$updatedCl2, id, basicInfo, accountInfo, contactInfo, locations, summary, _this$props, onSaveLocationError, onSaveClassChanges, onClose, valid, postBody;\n\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              event.preventDefault();\n              _this$state$updatedCl2 = _this.state.updatedClassRoom, id = _this$state$updatedCl2.id, basicInfo = _this$state$updatedCl2.basicInfo, accountInfo = _this$state$updatedCl2.accountInfo, contactInfo = _this$state$updatedCl2.contactInfo, locations = _this$state$updatedCl2.locations, summary = _this$state$updatedCl2.summary;\n              _this$props = _this.props, onSaveLocationError = _this$props.onSaveLocationError, onSaveClassChanges = _this$props.onSaveClassChanges, onClose = _this$props.onClose; // NOTE: Swap out what instance of valid is active if you want to test saving a new location without worrying about validation\n              // const valid = true;\n\n              _context.next = 5;\n              return _regeneratorRuntime.awrap(nestedEditFieldValidation(_this.state, _this.state.updatedClassRoom, _this.onSetValidation, function (validation) {\n                return console.warn('validation', validation);\n              }));\n\n            case 5:\n              valid = _context.sent;\n\n              if (!valid) {\n                // return onSaveLocationError();\n                console.warn('not valid');\n              }\n\n              postBody = {\n                id: id,\n                basicInfo: basicInfo,\n                accountInfo: accountInfo,\n                contactInfo: contactInfo,\n                locations: locations,\n                summary: summary\n              };\n              onSaveClassChanges(postBody);\n              onClose();\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onCancelChanges\", function () {\n      var onClose = _this.props.onClose;\n      var originalClassRoom = _this.state.originalClassRoom;\n\n      _this.setState({\n        updatedClassRoom: originalClassRoom\n      }, onClose());\n    });\n\n    _this.state = {\n      deleteLocationModalOpen: false,\n      newLocationModalOpen: false,\n      editLocationModalOpen: false,\n      pendingLocationDelete: {},\n      activeLocation: {},\n      dropdownIsOpen: false,\n      dropdownIndex: null,\n      originalClassRoom: {\n        summary: {\n          amount_students: '',\n          start_date: '',\n          end_date: '',\n          improvement: 0,\n          coursework_assigned: 0,\n          coursework_completed: 0,\n          problems_flagged_review: 0,\n          average_score: 0,\n          achieved_target_score: 0,\n          average_practice_tests_completed: 0,\n          instruction: 0\n        },\n        accountInfo: {\n          firstName: '',\n          lastName: '',\n          email: '',\n          gender: ''\n        },\n        contactInfo: {\n          phone: '',\n          streetAddress: '',\n          city: '',\n          state: '',\n          zip: ''\n        },\n        locations: []\n      },\n      updatedClassRoom: {\n        summary: {\n          amount_students: '',\n          start_date: '',\n          end_date: '',\n          improvement: 0,\n          coursework_assigned: 0,\n          coursework_completed: 0,\n          problems_flagged_review: 0,\n          average_score: 0,\n          achieved_target_score: 0,\n          average_practice_tests_completed: 0,\n          instruction: 0\n        },\n        accountInfo: {\n          firstName: '',\n          lastName: '',\n          email: '',\n          gender: ''\n        },\n        contactInfo: {\n          phone: '',\n          streetAddress: '',\n          city: '',\n          state: '',\n          zip: ''\n        },\n        locations: []\n      },\n      validation: {\n        accountInfo: {\n          firstName: true,\n          lastName: true,\n          email: true,\n          gender: true\n        }\n      }\n    };\n    return _this;\n  }\n\n  _createClass(ClassDetailModal, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props$classroom2 = this.props.classroom;\n      _this$props$classroom2 = _this$props$classroom2 === void 0 ? {} : _this$props$classroom2;\n      var id = _this$props$classroom2.id,\n          basicInfo = _this$props$classroom2.basicInfo,\n          accountInfo = _this$props$classroom2.accountInfo,\n          contactInfo = _this$props$classroom2.contactInfo,\n          locations = _this$props$classroom2.locations,\n          summary = _this$props$classroom2.summary;\n      var updatedClassRoom = {\n        id: id,\n        basicInfo: basicInfo,\n        accountInfo: accountInfo,\n        contactInfo: contactInfo,\n        locations: locations,\n        summary: summary\n      };\n      var originalClassRoomState = this.state.originalClassRoom;\n      var originalClassRoom = update(originalClassRoomState, {\n        $merge: updatedClassRoom\n      });\n      this.setState({\n        originalClassRoom: originalClassRoom,\n        updatedClassRoom: updatedClassRoom\n      }); // eslint-disable-line\n    } // This resets the component state to reflect the details of the next classroom the user clicks on\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          open = _this$props2.open,\n          onOpenDeleteModal = _this$props2.onOpenDeleteModal,\n          onDeleteClass = _this$props2.onDeleteClass,\n          deleteModalOpen = _this$props2.deleteModalOpen,\n          index = _this$props2.index;\n      var _this$state = this.state,\n          dropdownIsOpen = _this$state.dropdownIsOpen,\n          dropdownIndex = _this$state.dropdownIndex,\n          activeLocation = _this$state.activeLocation,\n          deleteLocationModalOpen = _this$state.deleteLocationModalOpen,\n          pendingLocationDelete = _this$state.pendingLocationDelete,\n          newLocationModalOpen = _this$state.newLocationModalOpen,\n          editLocationModalOpen = _this$state.editLocationModalOpen,\n          _this$state$updatedCl3 = _this$state.updatedClassRoom,\n          updatedAccountInfo = _this$state$updatedCl3.accountInfo,\n          updatedContactInfo = _this$state$updatedCl3.contactInfo,\n          updatedLocations = _this$state$updatedCl3.locations;\n      return __jsx(Portal, {\n        selector: \"#modal\"\n      }, open && __jsx(\"div\", {\n        className: \"jsx-2557376288\" + \" \" + \"overlay\"\n      }, __jsx(ClickOffComponentWrapper, {\n        onOuterClick: this.onCancelChanges,\n        nestedModals: deleteModalOpen || deleteLocationModalOpen || editLocationModalOpen || newLocationModalOpen\n      }, __jsx(\"div\", {\n        id: \"modal_user_edit\",\n        className: \"jsx-2557376288\" + \" \" + \"modal modal-custom modal-custom-large modal-gray\"\n      }, __jsx(\"div\", {\n        className: \"jsx-2557376288\" + \" \" + \"card-modal card-main card grey lighten-3\"\n      }, __jsx(\"div\", {\n        style: {\n          backgroundColor: \"#31837a\",\n          color: \"#fff\"\n        },\n        className: \"jsx-2557376288\" + \" \" + \"owner-box card-panel card-panel-title\"\n      }, __jsx(\"div\", {\n        className: \"jsx-2557376288\" + \" \" + \"card-panel-row row\"\n      }, __jsx(\"div\", {\n        className: \"jsx-2557376288\" + \" \" + \"col s9\"\n      }, __jsx(\"div\", {\n        className: \"jsx-2557376288\" + \" \" + \"user-block\"\n      }, __jsx(\"div\", {\n        style: {\n          backgroundColor: \"#0085ce\",\n          color: \"#fff\"\n        },\n        className: \"jsx-2557376288\" + \" \" + \"user-circle\"\n      }, __jsx(\"img\", {\n        src: \"./static/images/img-owner01.jpg\",\n        alt: \"\",\n        className: \"jsx-2557376288\"\n      })), __jsx(\"div\", {\n        style: {\n          color: \"#fff\"\n        },\n        className: \"jsx-2557376288\" + \" \" + \"user-text\"\n      }, this.renderModalHeader()))), __jsx(\"div\", {\n        style: {\n          textAlign: \"right\"\n        },\n        className: \"jsx-2557376288\" + \" \" + \"col\"\n      }, __jsx(\"span\", {\n        className: \"jsx-2557376288\" + \" \" + \"block-icon\"\n      }, __jsx(\"i\", {\n        className: \"jsx-2557376288\" + \" \" + \"icon-owner\"\n      }), __jsx(\"span\", {\n        className: \"jsx-2557376288\" + \" \" + \"text-icon\"\n      }, \"Owner\"))))), __jsx(\"div\", {\n        className: \"jsx-2557376288\" + \" \" + \"card-content\"\n      }, __jsx(\"div\", {\n        className: \"jsx-2557376288\" + \" \" + \"card-body\"\n      }, __jsx(\"div\", {\n        className: \"jsx-2557376288\" + \" \" + \"row mb-0\"\n      }, __jsx(\"div\", {\n        className: \"jsx-2557376288\" + \" \" + \"col s12 l6\"\n      }, __jsx(AccountInfo, {\n        state: this.initialClassRoomMount() ? accountInfo : updatedAccountInfo,\n        handleDetailsChange: this.handleDetailsChange\n      }), __jsx(ContactInfo, {\n        state: this.initialClassRoomMount() ? contactInfo : updatedContactInfo,\n        handleDetailsChange: this.handleDetailsChange\n      })), __jsx(\"div\", {\n        className: \"jsx-2557376288\" + \" \" + \"col s12 l6\"\n      }, __jsx(Locations, {\n        state: this.initialClassRoomMount() ? locations : updatedLocations,\n        handleDetailsChange: this.handleDetailsChange,\n        dropdownIsOpen: dropdownIsOpen,\n        dropdownIndex: dropdownIndex,\n        activeLocation: activeLocation,\n        deleteLocationModalOpen: deleteLocationModalOpen,\n        pendingLocationDelete: pendingLocationDelete,\n        newLocationModalOpen: newLocationModalOpen,\n        editLocationModalOpen: editLocationModalOpen,\n        onSetDropdown: this.onSetDropdown,\n        onCloseDropdown: this.onCloseDropdown,\n        onOpenNewLocationModal: this.onOpenNewLocationModal,\n        onOpenEditLocationModal: this.onOpenEditLocationModal,\n        onCloseNewLocationModal: this.onCloseNewLocationModal,\n        onCloseEditLocationModal: this.onCloseEditLocationModal,\n        onOpenDeleteLocationModal: this.onOpenDeleteLocationModal,\n        onCloseDeleteLocationModal: this.onCloseDeleteLocationModal\n      })))), __jsx(\"div\", {\n        className: \"jsx-2557376288\" + \" \" + \"modal-footer\"\n      }, __jsx(\"a\", {\n        href: \"#\",\n        onClick: function onClick() {\n          return onDeleteClass(index);\n        },\n        className: \"jsx-2557376288\" + \" \" + \"waves-effect waves-teal btn-flat pink-text text-darken-1\"\n      }, \"Delete\"), __jsx(\"a\", {\n        href: \"#\",\n        onClick: this.onCancelChanges,\n        className: \"jsx-2557376288\" + \" \" + \"modal-close waves-effect waves-teal btn-flat grey-text text-darken-1\"\n      }, \"Cancel\"), __jsx(\"a\", {\n        href: \"#\",\n        onClick: this.onSubmit,\n        className: \"jsx-2557376288\" + \" \" + \"btn\"\n      }, \"Save\"))))))), __jsx(_JSXStyle, {\n        id: \"2557376288\"\n      }, [\".overlay.jsx-2557376288{position:fixed;background-color:rgba(0,0,0,0.7);top:0;right:0;bottom:0;left:0;z-index:1999;}\", \".card-modal.jsx-2557376288{margin:0;border-radius:6px;}\", \".modal.jsx-2557376288{display:block;background-color:white;position:absolute;top:10%;right:10%;left:10%;box-shadow:0 24px 38px 3px rgba(0,0,0,0.14),0 9px 46px 8px rgba(0,0,0,0.12),0 11px 15px -7px rgba(0,0,0,0.2);}\", \".modal-custom.jsx-2557376288{opacity:1;visibility:visible;}\", \".modal-footer.jsx-2557376288{background-color:white;}\"]));\n    }\n  }]);\n\n  return ClassDetailModal;\n}(React.Component);\n\nexport default ClassDetailModal;","map":null,"metadata":{},"sourceType":"module"}