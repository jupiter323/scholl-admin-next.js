{"ast":null,"code":"import _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport update from 'immutability-helper';\nimport Owner from './components/Owner';\nimport LocationContactInfo from './components/LocationContactInfo';\nimport LocationEmailSettings from './components/LocationEmailSettings';\nimport { nestedEditFieldValidation } from '../../utils/fieldValidation';\n\nclass DetailAccountPage extends React.Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"componentWillReceiveProps\", nextProps => {\n      if (!this.state.originalLocation || nextProps.location.id !== this.state.originalLocation.id) {\n        const {\n          location: {\n            id,\n            owner,\n            locationEmailSettings,\n            locationContactInfo\n          } = {}\n        } = nextProps;\n        const updatedLocation = {\n          id,\n          locationEmailSettings,\n          locationContactInfo\n        };\n        const {\n          originalLocation: originalLocationState\n        } = this.state;\n        const originalLocation = update(originalLocationState, {\n          $merge: nextProps.location\n        });\n        this.setState({\n          originalLocation,\n          updatedLocation,\n          owner\n        });\n      }\n    });\n\n    _defineProperty(this, \"onSetValidation\", (validation, cb) => this.setState({\n      validation\n    }, cb));\n\n    _defineProperty(this, \"onSaveChanges\", async event => {\n      event.preventDefault(); // const { onSavePassageChanges, onSaveChangesError, onSetPassageValidation } = this.props;\n\n      const {\n        updatedLocation\n      } = this.state;\n      const valid = await nestedEditFieldValidation(this.state, this.state.updatedLocation, this.onSetValidation, validation => console.warn('validation', validation));\n\n      if (!valid) {\n        // return onSaveChangesError();\n        console.warn('not valid');\n      }\n\n      this.setState({\n        originalLocation: updatedLocation\n      }); // return onSavePassageChanges(updatedLocation);\n    });\n\n    _defineProperty(this, \"initialLocationMount\", () => this.state.originalLocation.id !== this.props.location.id);\n\n    _defineProperty(this, \"handleDetailsChange\", (event, name, section) => {\n      const {\n        updatedLocation: previousLocationState\n      } = this.state;\n      const value = event.target ? event.target.value : event;\n      const updatedLocation = update(previousLocationState, {\n        [section]: {\n          $merge: {\n            [name]: value\n          }\n        }\n      });\n      this.setState({\n        updatedLocation\n      });\n    });\n\n    this.state = {\n      owner: {\n        firstName: '',\n        lastName: '',\n        email: ''\n      },\n      originalLocation: {\n        locationEmailSettings: {\n          automatedEmailOrigin: '',\n          automatedEmailSalutation: ''\n        },\n        locationContactInfo: {\n          locationName: '',\n          locationNickname: '',\n          locationEmail: '',\n          locationPhoneNumber: '',\n          website: '',\n          locationStreetAddress: '',\n          locationCity: '',\n          locationState: '',\n          locationZip: ''\n        }\n      },\n      updatedLocation: {\n        locationEmailSettings: {\n          automatedEmailOrigin: '',\n          automatedEmailSalutation: ''\n        },\n        locationContactInfo: {\n          locationName: '',\n          locationNickname: '',\n          locationEmail: '',\n          locationPhoneNumber: '',\n          website: '',\n          locationStreetAddress: '',\n          locationCity: '',\n          locationState: '',\n          locationZip: ''\n        }\n      },\n      validation: {\n        locationEmailSettings: {\n          automatedEmailOriginAddress: true,\n          automatedEmailSalutation: true\n        },\n        locationContactInfo: {\n          locationName: true,\n          locationNickname: true,\n          locationEmail: true\n        }\n      }\n    };\n  }\n\n  componentDidMount() {\n    const {\n      location: {\n        id,\n        owner,\n        locationEmailSettings,\n        locationContactInfo\n      } = {}\n    } = this.props;\n    const updatedLocation = {\n      id,\n      locationEmailSettings,\n      locationContactInfo\n    };\n    const {\n      originalLocation: originalLocationState\n    } = this.state;\n    const originalLocation = update(originalLocationState, {\n      $merge: updatedLocation\n    });\n    this.setState({\n      originalLocation,\n      updatedLocation,\n      owner\n    }); // eslint-disable-line\n  } // TODO: This seems to be working well - confirm that only one isntance of this edit modal is opening on the location edit page\n  // This resets the component state to reflect the details of the next location the location clicks on\n\n\n  render() {\n    // TODO: Update navbar info with actual sample location data\n    const {\n      updatedLocation: {\n        locationEmailSettings: updatedLocationEmailSettings,\n        locationContactInfo: updatedLocationContactInfo\n      }\n    } = this.state;\n    const {\n      location: {\n        owner,\n        locationEmailSettings,\n        locationContactInfo\n      }\n    } = this.props;\n    return __jsx(\"div\", {\n      className: \"content-section\"\n    }, __jsx(\"div\", {\n      className: \"content-section-holder\"\n    }, __jsx(\"div\", {\n      className: \"row mb-0 d-flex-content large\"\n    }, __jsx(\"div\", {\n      className: \"col s12 l5\"\n    }, __jsx(Owner, {\n      state: owner\n    }), __jsx(LocationEmailSettings, {\n      state: this.initialLocationMount() ? locationEmailSettings : updatedLocationEmailSettings,\n      handleDetailsChange: this.handleDetailsChange\n    })), __jsx(LocationContactInfo, {\n      state: this.initialLocationMount() ? locationContactInfo : updatedLocationContactInfo,\n      handleDetailsChange: this.handleDetailsChange\n    })), __jsx(\"div\", {\n      className: \"btn-holder align-right-sm\"\n    }, __jsx(\"a\", {\n      href: \"#\",\n      className: \"btn\",\n      onClick: this.onSaveChanges\n    }, \"Save\"))));\n  }\n\n}\n\nexport default DetailAccountPage;","map":null,"metadata":{},"sourceType":"module"}