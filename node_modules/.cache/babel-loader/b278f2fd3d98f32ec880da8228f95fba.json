{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\n\n/* eslint-disable no-unused-vars */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport update from 'immutability-helper';\nimport UserInfo from './components/UserInfo';\nimport ContactInfo from './components/ContactInfo';\nimport UserLocation from './components/UserLocation';\nimport LocationModal from '../../Location/components/LocationModal';\nimport { nestedEditFieldValidation } from '../../utils/fieldValidation';\n\nvar DetailAccountPage =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(DetailAccountPage, _React$Component);\n\n  function DetailAccountPage(props) {\n    var _this;\n\n    _classCallCheck(this, DetailAccountPage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(DetailAccountPage).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"componentWillReceiveProps\", function (nextProps) {\n      if (!_this.state.originalUser || nextProps.user.id !== _this.state.originalUser.id) {\n        var _nextProps$user = nextProps.user;\n        _nextProps$user = _nextProps$user === void 0 ? {} : _nextProps$user;\n        var id = _nextProps$user.id,\n            userInfo = _nextProps$user.userInfo,\n            contactInfo = _nextProps$user.contactInfo,\n            userLocation = _nextProps$user.userLocation;\n        var updatedUser = {\n          id: id,\n          userInfo: userInfo,\n          contactInfo: contactInfo,\n          userLocation: userLocation\n        };\n        var originalUserState = _this.state.originalUser;\n        var originalUser = update(originalUserState, {\n          $merge: nextProps.user\n        });\n\n        _this.setState({\n          originalUser: originalUser,\n          updatedUser: updatedUser\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onOpenLocationModal\", function () {\n      return _this.setState({\n        locationModalOpen: true\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onCloseLocationModal\", function () {\n      return _this.setState({\n        locationModalOpen: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSetValidation\", function (validation, cb) {\n      return _this.setState({\n        validation: validation\n      }, cb);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSaveChanges\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(event) {\n        var updatedUser, valid;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                event.preventDefault(); // const { onSavePassageChanges, onSaveChangesError, onSetPassageValidation } = this.props;\n\n                updatedUser = _this.state.updatedUser;\n                _context.next = 4;\n                return nestedEditFieldValidation(_this.state, _this.state.updatedUser, _this.onSetValidation, function (validation) {\n                  return console.warn('validation', validation);\n                });\n\n              case 4:\n                valid = _context.sent;\n\n                if (!valid) {\n                  // return onSaveChangesError();\n                  console.warn('not valid');\n                }\n\n                _this.setState({\n                  originalUser: _this.state.updatedUser\n                }); // return onSavePassageChanges(updatedUser);\n\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"onRemoveOption\", function (optionIndex, section, array) {\n      var updatedUser = update(_this.state.updatedUser, _defineProperty({}, section, _defineProperty({}, array, {\n        $splice: [[optionIndex, 1]]\n      })));\n\n      _this.setState({\n        updatedUser: updatedUser\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"initialUserMount\", function () {\n      return _this.state.originalUser.id !== _this.props.user.id;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDetailsChange\", function (event, name, section) {\n      var previousUserState = _this.state.updatedUser;\n      var value = event.target ? event.target.value : event;\n      var updatedUser = update(previousUserState, _defineProperty({}, section, {\n        $merge: _defineProperty({}, name, value)\n      }));\n\n      _this.setState({\n        updatedUser: updatedUser\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleOptionsChange\", function (selectedOptions, section, array) {\n      var updatedUser = update(_this.state.updatedUser, _defineProperty({}, section, _defineProperty({}, array, {\n        $set: selectedOptions\n      })));\n\n      _this.setState({\n        updatedUser: updatedUser\n      });\n    });\n\n    _this.state = {\n      locationModalOpen: false,\n      originalUser: {\n        userInfo: {\n          firstName: '',\n          lastName: '',\n          email: '',\n          gender: ''\n        },\n        contactInfo: {\n          phone: '',\n          streetAddress: '',\n          city: '',\n          state: '',\n          zip: ''\n        },\n        userLocation: {\n          locations: []\n        }\n      },\n      updatedUser: {\n        userInfo: {\n          firstName: '',\n          lastName: '',\n          email: '',\n          gender: ''\n        },\n        contactInfo: {\n          phone: '',\n          streetAddress: '',\n          city: '',\n          state: '',\n          zip: ''\n        },\n        userLocation: {\n          locations: []\n        }\n      },\n      validation: {\n        userInfo: {\n          firstName: true,\n          lastName: true,\n          email: true,\n          gender: true\n        }\n      }\n    };\n    return _this;\n  }\n\n  _createClass(DetailAccountPage, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props$user = this.props.user;\n      _this$props$user = _this$props$user === void 0 ? {} : _this$props$user;\n      var id = _this$props$user.id,\n          userInfo = _this$props$user.userInfo,\n          contactInfo = _this$props$user.contactInfo,\n          userLocation = _this$props$user.userLocation;\n      var updatedUser = {\n        id: id,\n        userInfo: userInfo,\n        contactInfo: contactInfo,\n        userLocation: userLocation\n      };\n      var originalUserState = this.state.originalUser;\n      var originalUser = update(originalUserState, {\n        $merge: updatedUser\n      });\n      this.setState({\n        originalUser: originalUser,\n        updatedUser: updatedUser\n      }); // eslint-disable-line\n    } // TODO: This seems to be working well - confirm that only one isntance of this edit modal is opening on the user edit page\n    // This resets the component state to reflect the details of the next user the user clicks on\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state = this.state,\n          locationModalOpen = _this$state.locationModalOpen,\n          _this$state$updatedUs = _this$state.updatedUser,\n          updatedUserInfo = _this$state$updatedUs.userInfo,\n          updatedContactInfo = _this$state$updatedUs.contactInfo,\n          updatedUserLocation = _this$state$updatedUs.userLocation;\n      var _this$props$user2 = this.props.user,\n          userInfo = _this$props$user2.userInfo,\n          contactInfo = _this$props$user2.contactInfo,\n          userLocation = _this$props$user2.userLocation;\n      return React.createElement(React.Fragment, null, React.createElement(LocationModal, {\n        open: locationModalOpen,\n        onClose: this.onCloseLocationModal,\n        handleLocationsChange: function handleLocationsChange(selectedLocations) {\n          return _this2.handleOptionsChange(selectedLocations, 'userLocation', 'locations');\n        }\n      }), React.createElement(\"div\", {\n        className: \"content-section\"\n      }, React.createElement(\"div\", {\n        className: \"content-section-holder\"\n      }, React.createElement(\"div\", {\n        className: \"row mb-0 d-flex-content large\"\n      }, React.createElement(\"div\", {\n        className: \"col s12 l5\"\n      }, React.createElement(UserInfo, {\n        state: this.initialUserMount() ? userInfo : updatedUserInfo,\n        handleDetailsChange: this.handleDetailsChange\n      }), React.createElement(ContactInfo, {\n        state: this.initialUserMount() ? contactInfo : updatedContactInfo,\n        handleDetailsChange: this.handleDetailsChange\n      })), React.createElement(UserLocation, {\n        state: this.initialUserMount() ? userLocation : updatedUserLocation,\n        onOpenLocationModal: this.onOpenLocationModal,\n        onRemoveLocation: this.onRemoveOption\n      })), React.createElement(\"div\", {\n        className: \"btn-holder align-right-sm\"\n      }, React.createElement(\"a\", {\n        href: \"#\",\n        className: \"btn\",\n        onClick: this.onSaveChanges\n      }, \"Save\")))));\n    }\n  }]);\n\n  return DetailAccountPage;\n}(React.Component);\n\nDetailAccountPage.propTypes = {\n  user: PropTypes.object\n};\nexport default DetailAccountPage;","map":{"version":3,"sources":["C:\\Users\\KFROE\\OneDrive\\Desktop\\Clear Choice\\clear-choice-admin\\components\\Instructor\\DetailAccountPage\\index.js"],"names":["React","PropTypes","update","UserInfo","ContactInfo","UserLocation","LocationModal","nestedEditFieldValidation","DetailAccountPage","props","nextProps","state","originalUser","user","id","userInfo","contactInfo","userLocation","updatedUser","originalUserState","$merge","setState","locationModalOpen","validation","cb","event","preventDefault","onSetValidation","console","warn","valid","optionIndex","section","array","$splice","name","previousUserState","value","target","selectedOptions","$set","firstName","lastName","email","gender","phone","streetAddress","city","zip","locations","updatedUserInfo","updatedContactInfo","updatedUserLocation","onCloseLocationModal","selectedLocations","handleOptionsChange","initialUserMount","handleDetailsChange","onOpenLocationModal","onRemoveOption","onSaveChanges","Component","propTypes","object"],"mappings":"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","sourcesContent":["/* eslint-disable no-unused-vars */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport update from 'immutability-helper';\n\nimport UserInfo from './components/UserInfo';\nimport ContactInfo from './components/ContactInfo';\nimport UserLocation from './components/UserLocation';\nimport LocationModal from '../../Location/components/LocationModal';\n\nimport { nestedEditFieldValidation } from '../../utils/fieldValidation';\n\nclass DetailAccountPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      locationModalOpen: false,\n      originalUser: {\n        userInfo: {\n          firstName: '',\n          lastName: '',\n          email: '',\n          gender: '',\n        },\n        contactInfo: {\n          phone: '',\n          streetAddress: '',\n          city: '',\n          state: '',\n          zip: '',\n        },\n        userLocation: {\n          locations: [],\n        },\n      },\n      updatedUser: {\n        userInfo: {\n          firstName: '',\n          lastName: '',\n          email: '',\n          gender: '',\n        },\n        contactInfo: {\n          phone: '',\n          streetAddress: '',\n          city: '',\n          state: '',\n          zip: '',\n        },\n        userLocation: {\n          locations: [],\n        },\n      },\n      validation: {\n        userInfo: {\n          firstName: true,\n          lastName: true,\n          email: true,\n          gender: true,\n        },\n      },\n    };\n  }\n\n  componentDidMount() {\n    const { user: { id, userInfo, contactInfo, userLocation } = {} } = this.props;\n    const updatedUser = { id, userInfo, contactInfo, userLocation };\n    const { originalUser: originalUserState } = this.state;\n    const originalUser = update(originalUserState, {\n      $merge: updatedUser,\n    });\n    this.setState({ originalUser, updatedUser }); // eslint-disable-line\n  }\n\n  // TODO: This seems to be working well - confirm that only one isntance of this edit modal is opening on the user edit page\n  // This resets the component state to reflect the details of the next user the user clicks on\n  componentWillReceiveProps = (nextProps) => {\n    if ((!this.state.originalUser || nextProps.user.id !== this.state.originalUser.id)) {\n      const { user: { id, userInfo, contactInfo, userLocation } = {} } = nextProps;\n      const updatedUser = { id, userInfo, contactInfo, userLocation };\n      const { originalUser: originalUserState } = this.state;\n      const originalUser = update(originalUserState, {\n        $merge: nextProps.user,\n      });\n      this.setState({ originalUser, updatedUser });\n    }\n  }\n\n  onOpenLocationModal = () => this.setState({ locationModalOpen: true });\n  onCloseLocationModal = () => this.setState({ locationModalOpen: false });\n\n  // This function is passed into nestedCreateFieldValidation, it takes the result of the validation check and a callback function\n  // The updated component validation state is set and then the callback is dispatched - in this case, the callback handles the toast warning at the container level\n  onSetValidation = (validation, cb) => this.setState({ validation }, cb);\n\n  // TODO: Clean this up once the react toast bugs are fixed. Just logging the validation response for now\n  onSaveChanges = async (event) => {\n    event.preventDefault();\n    // const { onSavePassageChanges, onSaveChangesError, onSetPassageValidation } = this.props;\n    const { updatedUser } = this.state;\n    const valid = await nestedEditFieldValidation(this.state, this.state.updatedUser, this.onSetValidation, (validation) => console.warn('validation', validation));\n    if (!valid) {\n      // return onSaveChangesError();\n      console.warn('not valid');\n    }\n    this.setState({ originalUser: this.state.updatedUser });\n    // return onSavePassageChanges(updatedUser);\n  }\n\n  onRemoveOption = (optionIndex, section, array) => {\n    const updatedUser = update(this.state.updatedUser, {\n      [section]: {\n        [array]: {\n          $splice: [[optionIndex, 1]],\n        },\n      },\n    });\n    this.setState({ updatedUser });\n  }\n\n  initialUserMount = () => this.state.originalUser.id !== this.props.user.id;\n\n  // We pull the value based on the field type then merge that updated key/value pair with the last version of component state\n  handleDetailsChange = (event, name, section) => {\n    const { updatedUser: previousUserState } = this.state;\n    const value = event.target ? event.target.value : event;\n    const updatedUser = update(previousUserState, {\n      [section]: { $merge: { [name]: value } },\n    });\n    this.setState({ updatedUser });\n  }\n\n  handleOptionsChange = (selectedOptions, section, array) => {\n    const updatedUser = update(this.state.updatedUser, {\n      [section]: {\n        [array]: {\n          $set: selectedOptions,\n        },\n      },\n    });\n    this.setState({ updatedUser });\n  }\n\n  render() {\n    const { locationModalOpen, updatedUser: { userInfo: updatedUserInfo, contactInfo: updatedContactInfo, userLocation: updatedUserLocation } } = this.state;\n    const { user: { userInfo, contactInfo, userLocation } } = this.props;\n    return (\n      <React.Fragment>\n        <LocationModal\n          open={locationModalOpen}\n          onClose={this.onCloseLocationModal}\n          handleLocationsChange={(selectedLocations) => this.handleOptionsChange(selectedLocations, 'userLocation', 'locations')}\n        />\n        <div className=\"content-section\">\n          <div className=\"content-section-holder\">\n            <div className=\"row mb-0 d-flex-content large\">\n              <div className=\"col s12 l5\">\n                <UserInfo\n                  state={this.initialUserMount() ? userInfo : updatedUserInfo}\n                  handleDetailsChange={this.handleDetailsChange}\n                />\n                <ContactInfo\n                  state={this.initialUserMount() ? contactInfo : updatedContactInfo}\n                  handleDetailsChange={this.handleDetailsChange}\n                />\n              </div>\n              <UserLocation\n                state={this.initialUserMount() ? userLocation : updatedUserLocation}\n                onOpenLocationModal={this.onOpenLocationModal}\n                onRemoveLocation={this.onRemoveOption}\n              />\n            </div>\n            <div className=\"btn-holder align-right-sm\">\n              <a\n                href=\"#\"\n                className=\"btn\"\n                onClick={this.onSaveChanges}\n              >\n                Save\n              </a>\n            </div>\n          </div>\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n\nDetailAccountPage.propTypes = {\n  user: PropTypes.object,\n};\n\nexport default DetailAccountPage;\n"]},"metadata":{},"sourceType":"module"}