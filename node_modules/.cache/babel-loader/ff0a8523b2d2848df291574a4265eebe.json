{"ast":null,"code":"import _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _JSXStyle from \"styled-jsx/style\";\n\n/* eslint-disable array-callback-return */\n\n/* eslint-disable consistent-return */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport update from 'immutability-helper';\nimport Portal from '../../../../Portal';\nimport FilterSection from './components/FilterSection';\nimport TableHeader from './components/TableHeader';\nimport { topicMap, workbookMap, subjectMap, difficultyMap, typeMap } from '../../../utils/worksheetFilterMap';\nimport { subjectAscending, subjectDescending } from '../../../../utils/sortFunctions';\n\nvar ProblemBank =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ProblemBank, _React$Component);\n\n  function ProblemBank(props) {\n    var _this;\n\n    _classCallCheck(this, ProblemBank);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ProblemBank).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"componentWillReceiveProps\", function (nextProps) {\n      if (!_this.props.worksheetId || nextProps.worksheetId !== _this.state.worksheetId) {\n        var problems = nextProps.problems,\n            passages = nextProps.passages,\n            worksheetId = nextProps.worksheetId;\n\n        _this.setState({\n          problems: problems,\n          passages: passages,\n          worksheetId: worksheetId\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onToggleAddProblemDropdown\", function () {\n      return _this.setState(function (_ref) {\n        var addProblemsDropdownOpen = _ref.addProblemsDropdownOpen;\n        return {\n          addProblemsDropdownOpen: !addProblemsDropdownOpen\n        };\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onChangeOpenSection\", function (openSection) {\n      return _this.setState({\n        openSection: openSection\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSetFilteredTopicState\", function (topicFilter) {\n      return _this.setState({\n        topicFilter: topicFilter\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClearFilters\", function () {\n      return _this.setState({\n        subjectFilters: [],\n        difficultyFilters: [],\n        typeFilters: [],\n        workbookFilters: [],\n        topicFilter: ''\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSetAscendingSort\", function () {\n      return _this.setState({\n        sort: 'ascending'\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSetDescendingSort\", function () {\n      return _this.setState({\n        sort: 'descending'\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSortBySubject\", function (problemsOrPassages) {\n      var sort = _this.state.sort;\n\n      if (sort === 'ascending') {\n        return problemsOrPassages.sort(subjectAscending);\n      }\n\n      return problemsOrPassages.sort(subjectDescending);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onFilterPassages\", function (passages, filterType, filter) {\n      switch (filterType) {\n        case 'difficulty':\n        case 'type':\n          return passages.reduce(function (finalArr, passage) {\n            passage.problems.map(function (problem) {\n              if (filter.indexOf(problem[filterType]) !== -1 && finalArr.indexOf(passage) === -1) {\n                finalArr.push(passage);\n              }\n            });\n            return finalArr;\n          }, []);\n\n        case 'topic':\n          return passages.reduce(function (finalArr, passage) {\n            passage.problems.map(function (problem) {\n              if (problem.topics.indexOf(filter) !== -1 && finalArr.indexOf(passage) === -1) {\n                finalArr.push(passage);\n              }\n            });\n            return finalArr;\n          }, []);\n\n        case 'workbook':\n          return passages.reduce(function (finalArr, passage) {\n            passage.problems.map(function (problem) {\n              if (filter.indexOf(workbookMap[problem.inWorkbook]) !== -1 && finalArr.indexOf(passage) === -1) {\n                finalArr.push(passage);\n              }\n            });\n            return finalArr;\n          }, []);\n\n        default:\n          break;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onFilterProblemsOrPassages\", function (type) {\n      var _this$state = _this.state,\n          subjectFilters = _this$state.subjectFilters,\n          difficultyFilters = _this$state.difficultyFilters,\n          typeFilters = _this$state.typeFilters,\n          workbookFilters = _this$state.workbookFilters,\n          topicFilter = _this$state.topicFilter,\n          allProblems = _this$state.problems,\n          allPassages = _this$state.passages;\n      var problemsOrPassages;\n\n      if (type === 'problems') {\n        problemsOrPassages = allProblems;\n      } else {\n        problemsOrPassages = allPassages;\n      }\n\n      if (subjectFilters.length) {\n        problemsOrPassages = problemsOrPassages.filter(function (problemOrPassage) {\n          return subjectFilters.indexOf(problemOrPassage.subject) !== -1;\n        });\n      }\n\n      if (difficultyFilters.length) {\n        if (type === 'problems') {\n          problemsOrPassages = problemsOrPassages.filter(function (problem) {\n            return difficultyFilters.indexOf(problem.difficulty) !== -1;\n          });\n        } else {\n          problemsOrPassages = _this.onFilterPassages(problemsOrPassages, 'difficulty', difficultyFilters);\n        }\n      }\n\n      if (typeFilters.length) {\n        if (type === 'problems') {\n          problemsOrPassages = problemsOrPassages.filter(function (problem) {\n            return typeFilters.indexOf(problem.type) !== -1;\n          });\n        } else {\n          problemsOrPassages = _this.onFilterPassages(problemsOrPassages, 'type', typeFilters);\n        }\n      }\n\n      if (workbookFilters.length) {\n        if (type === 'problems') {\n          problemsOrPassages = problemsOrPassages.filter(function (problem) {\n            return workbookFilters.indexOf(workbookMap[problem.inWorkbook]) !== -1;\n          });\n        } else {\n          problemsOrPassages = _this.onFilterPassages(problemsOrPassages, 'workbook', workbookFilters);\n        }\n      }\n\n      if (topicFilter.length) {\n        if (type === 'problems') {\n          problemsOrPassages = problemsOrPassages.filter(function (problem) {\n            return problem.topics.indexOf(topicFilter) !== -1;\n          });\n        } else {\n          problemsOrPassages = _this.onFilterPassages(problemsOrPassages, 'topic', topicFilter);\n        }\n      }\n\n      return problemsOrPassages;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onAddSelectedProblems\", function (addTime) {\n      var _this$state2 = _this.state,\n          selectedProblems = _this$state2.selectedProblems,\n          selectedPassages = _this$state2.selectedPassages;\n      var addSelectedProblems = _this.props.addSelectedProblems;\n      addSelectedProblems(selectedProblems, selectedPassages, addTime);\n\n      _this.setState({\n        selectedPassages: [],\n        selectedProblems: [],\n        addProblemsDropdownOpen: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getMappableProblemsOrPassages\", function (type) {\n      var _this$state3 = _this.state,\n          subjectFilters = _this$state3.subjectFilters,\n          difficultyFilters = _this$state3.difficultyFilters,\n          typeFilters = _this$state3.typeFilters,\n          workbookFilters = _this$state3.workbookFilters,\n          topicFilter = _this$state3.topicFilter,\n          sort = _this$state3.sort,\n          allProblems = _this$state3.problems,\n          allPassages = _this$state3.passages;\n      var problemsOrPassages;\n\n      if (type === 'problems') {\n        problemsOrPassages = allProblems;\n      } else {\n        problemsOrPassages = allPassages;\n      }\n\n      if (topicFilter.length || subjectFilters.length || difficultyFilters.length || typeFilters.length || workbookFilters.length) {\n        problemsOrPassages = _this.onFilterProblemsOrPassages(type);\n      }\n\n      if (sort) {\n        return _this.onSortBySubject(problemsOrPassages);\n      }\n\n      return problemsOrPassages;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"determineSort\", function () {\n      var sort = _this.state.sort;\n\n      if (sort === '' || sort === 'descending') {\n        return _this.onSetAscendingSort();\n      }\n\n      return _this.onSetDescendingSort();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleFilterClick\", function (filterType, filter) {\n      var _this$state4 = _this.state,\n          currentSubjectFilters = _this$state4.subjectFilters,\n          currentDifficultyFilters = _this$state4.difficultyFilters,\n          currentTypeFilters = _this$state4.typeFilters,\n          currentWorkbookFilters = _this$state4.workbookFilters;\n      var modifiedFilterCurrentState;\n      var modifiedFilterName;\n      var modifiedFilterUpdatedState;\n\n      switch (filterType) {\n        case 'subject':\n          modifiedFilterCurrentState = currentSubjectFilters;\n          modifiedFilterName = 'subjectFilters';\n          break;\n\n        case 'difficulty':\n          modifiedFilterCurrentState = currentDifficultyFilters;\n          modifiedFilterName = 'difficultyFilters';\n          break;\n\n        case 'type':\n          modifiedFilterCurrentState = currentTypeFilters;\n          modifiedFilterName = 'typeFilters';\n          break;\n\n        case 'workbook':\n          modifiedFilterCurrentState = currentWorkbookFilters;\n          modifiedFilterName = 'workbookFilters';\n          break;\n\n        default:\n          break;\n      }\n\n      if (modifiedFilterCurrentState.indexOf(filter) === -1) {\n        modifiedFilterUpdatedState = update(modifiedFilterCurrentState, {\n          $push: [filter]\n        });\n      } else {\n        var filterIndex = modifiedFilterCurrentState.indexOf(filter);\n        modifiedFilterUpdatedState = update(modifiedFilterCurrentState, {\n          $splice: [[filterIndex, 1]]\n        });\n      }\n\n      _this.setState(_defineProperty({}, modifiedFilterName, modifiedFilterUpdatedState));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"toggleSelectAllProblemsOrPassages\", function () {\n      var _this$state5 = _this.state,\n          type = _this$state5.openSection,\n          problems = _this$state5.problems,\n          passages = _this$state5.passages,\n          currentSelectedProblems = _this$state5.selectedProblems,\n          currentSelectedPassages = _this$state5.selectedPassages;\n      var clickedTypeCurrentState;\n      var clickedTypeName;\n      var clickedAllOfType;\n\n      if (type === 'problems') {\n        clickedTypeCurrentState = currentSelectedProblems;\n        clickedTypeName = 'selectedProblems';\n        clickedAllOfType = problems;\n      } else {\n        clickedTypeCurrentState = currentSelectedPassages;\n        clickedTypeName = 'selectedPassages';\n        clickedAllOfType = passages;\n      }\n\n      if (clickedTypeCurrentState.length === 0) {\n        _this.setState(_defineProperty({}, clickedTypeName, clickedAllOfType));\n      } else {\n        _this.setState(_defineProperty({}, clickedTypeName, []));\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleProblemOrPassageClick\", function (type, value) {\n      var _this$state6 = _this.state,\n          currentSelectedProblems = _this$state6.selectedProblems,\n          currentSelectedPassages = _this$state6.selectedPassages;\n      var clickedTypeCurrentState;\n      var clickedTypeName;\n\n      if (type === 'problem') {\n        clickedTypeCurrentState = currentSelectedProblems;\n        clickedTypeName = 'selectedProblems';\n      } else {\n        clickedTypeCurrentState = currentSelectedPassages;\n        clickedTypeName = 'selectedPassages';\n      }\n\n      var clickedTypeUpdatedState;\n\n      if (clickedTypeCurrentState.map(function (selectedElement) {\n        return selectedElement.id;\n      }).indexOf(value.id) === -1) {\n        clickedTypeUpdatedState = update(clickedTypeCurrentState, {\n          $push: [value]\n        });\n      } else {\n        var selectedIndex = clickedTypeCurrentState.map(function (selectedElement) {\n          return selectedElement.id;\n        }).indexOf(value.id);\n        clickedTypeUpdatedState = update(clickedTypeCurrentState, {\n          $splice: [[selectedIndex, 1]]\n        });\n      }\n\n      _this.setState(_defineProperty({}, clickedTypeName, clickedTypeUpdatedState));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"mapProblems\", function () {\n      return _this.getMappableProblemsOrPassages('problems').map(function (problem) {\n        var selectedProblems = _this.state.selectedProblems;\n        var selected = selectedProblems.map(function (selectedProblem) {\n          return selectedProblem.id;\n        }).indexOf(problem.id) !== -1;\n        return React.createElement(\"div\", {\n          className: selected ? \"card list-table-row list-row-added\" : \"card list-table-row\"\n        }, React.createElement(\"div\", {\n          className: \"list-table-cell checkbox-cell\"\n        }, React.createElement(\"label\", null, React.createElement(\"input\", {\n          type: \"checkbox\",\n          className: \"filled-in\",\n          name: \"check_01\",\n          checked: selectedProblems.map(function (selectedProblem) {\n            return selectedProblem.id;\n          }).indexOf(problem.id) !== -1,\n          onChange: function onChange() {\n            return _this.handleProblemOrPassageClick('problem', problem);\n          }\n        }), React.createElement(\"span\", null, \"\\xA0\"))), React.createElement(\"div\", {\n          className: \"list-table-cell subject-cell\"\n        }, React.createElement(\"span\", null, subjectMap[problem.subject])), React.createElement(\"div\", {\n          className: \"list-table-cell info-cell\"\n        }, React.createElement(\"span\", null, difficultyMap[problem.difficulty])), React.createElement(\"div\", {\n          className: \"list-table-cell type-cell\"\n        }, React.createElement(\"span\", null, typeMap[problem.type])), React.createElement(\"div\", {\n          className: \"list-table-cell in-cell\"\n        }, problem.inWorkbook ? 'Yes' : 'No'), React.createElement(\"div\", {\n          className: \"list-table-cell topic-cell\"\n        }, problem.topics.map(function (topic) {\n          return React.createElement(\"span\", {\n            className: \"chip\",\n            id: topic\n          }, topicMap[topic]);\n        })), React.createElement(\"div\", {\n          className: \"list-table-cell view-cell\"\n        }, React.createElement(\"a\", {\n          href: \"#\"\n        }, React.createElement(\"i\", {\n          className: \"icon-eye\"\n        }))), React.createElement(\"div\", {\n          className: \"list-table-cell drop-cell\"\n        }, React.createElement(\"a\", {\n          href: \"#\"\n        }, React.createElement(\"i\", {\n          className: \"icon-plus-circle\"\n        }))));\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"mapPassages\", function () {\n      return _this.getMappableProblemsOrPassages('passages').map(function (passage) {\n        var selectedPassages = _this.state.selectedPassages;\n        var selected = selectedPassages.map(function (selectedPassage) {\n          return selectedPassage.id;\n        }).indexOf(passage.id) !== -1;\n        return React.createElement(\"div\", {\n          className: \"list-view-section\"\n        }, React.createElement(\"div\", {\n          className: selected ? \"list-table detail-table list-table-added\" : \"list-table detail-table\"\n        }, React.createElement(TableHeader, {\n          sortBySubject: _this.determineSort\n        }), React.createElement(\"div\", {\n          className: \"list-table-body\"\n        }, React.createElement(\"div\", {\n          className: \"combined-holder\"\n        }, React.createElement(\"div\", {\n          className: \"combined-header\"\n        }, React.createElement(\"div\", {\n          className: \"list-table-row\"\n        }, React.createElement(\"div\", {\n          className: \"list-table-cell checkbox-cell\"\n        }, React.createElement(\"div\", {\n          className: \"checkbox-block\"\n        }, React.createElement(\"label\", null, React.createElement(\"input\", {\n          type: \"checkbox\",\n          className: \"filled-in\",\n          checked: selectedPassages.map(function (selectedPassage) {\n            return selectedPassage.id;\n          }).indexOf(passage.id) !== -1,\n          onChange: function onChange() {\n            return _this.handleProblemOrPassageClick('passage', passage);\n          }\n        }), React.createElement(\"span\", null, \"\\xA0\")))), React.createElement(\"div\", {\n          className: \"list-table-cell subject-cell\"\n        }, React.createElement(\"div\", {\n          className: \"filter-name\"\n        }, subjectMap[passage.subject])), React.createElement(\"div\", {\n          className: \"list-table-cell combined-title-cell\"\n        }, React.createElement(\"div\", {\n          className: \"combined-title\"\n        }, passage.title)), React.createElement(\"div\", {\n          className: \"list-table-cell view-cell\"\n        }, React.createElement(\"a\", {\n          href: \"#\"\n        }, React.createElement(\"i\", {\n          className: \"custom-icon-triangle-right\"\n        }))), React.createElement(\"div\", {\n          className: \"list-table-cell drop-cell\"\n        }, React.createElement(\"a\", {\n          href: \"#\"\n        }, React.createElement(\"i\", {\n          className: \"icon-plus-circle\"\n        }))))), React.createElement(\"div\", {\n          className: \"collection\"\n        }, passage.problems.map(function (problem) {\n          return React.createElement(\"div\", {\n            className: \"collection-item list-table-row\",\n            id: problem.id\n          }, React.createElement(\"div\", {\n            className: \"list-table-cell checkbox-cell\"\n          }, React.createElement(\"span\", null, \"\\xA0\")), React.createElement(\"div\", {\n            className: \"list-table-cell subject-cell\"\n          }, React.createElement(\"span\", null, subjectMap[problem.subject])), React.createElement(\"div\", {\n            className: \"list-table-cell info-cell\"\n          }, React.createElement(\"span\", null, difficultyMap[problem.difficulty])), React.createElement(\"div\", {\n            className: \"list-table-cell type-cell\"\n          }, React.createElement(\"span\", null, typeMap[problem.type])), React.createElement(\"div\", {\n            className: \"list-table-cell in-cell\"\n          }, problem.inWorkbook ? 'Yes' : 'No'), React.createElement(\"div\", {\n            className: \"list-table-cell topic-cell\"\n          }, problem.topics.map(function (topic) {\n            return React.createElement(\"span\", {\n              className: \"chip\",\n              id: topic\n            }, topicMap[topic]);\n          })), React.createElement(\"div\", {\n            className: \"list-table-cell view-cell\"\n          }, React.createElement(\"a\", {\n            href: \"#\"\n          }, React.createElement(\"i\", {\n            className: \"icon-eye\"\n          }))), React.createElement(\"div\", {\n            className: \"list-table-cell drop-cell\"\n          }, React.createElement(\"span\", null, \"\\xA0\")));\n        }))))));\n      });\n    });\n\n    _this.state = {\n      addProblemsDropdownOpen: false,\n      openSection: 'problems',\n      topicFilter: '',\n      subjectFilters: [],\n      difficultyFilters: [],\n      typeFilters: [],\n      workbookFilters: [],\n      sort: '',\n      selectedProblems: [],\n      selectedPassages: [],\n      problems: [],\n      passages: [],\n      worksheetId: null\n    };\n    return _this;\n  }\n\n  _createClass(ProblemBank, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props = this.props,\n          problems = _this$props.problems,\n          passages = _this$props.passages,\n          worksheetId = _this$props.worksheetId; // eslint-disable-next-line react/no-did-mount-set-state\n\n      this.setState({\n        problems: problems,\n        passages: passages,\n        worksheetId: worksheetId\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props2 = this.props,\n          open = _this$props2.open,\n          onClose = _this$props2.onClose,\n          problems = _this$props2.problems;\n      var _this$state7 = this.state,\n          openSection = _this$state7.openSection,\n          subjectFilters = _this$state7.subjectFilters,\n          difficultyFilters = _this$state7.difficultyFilters,\n          typeFilters = _this$state7.typeFilters,\n          workbookFilters = _this$state7.workbookFilters,\n          addProblemsDropdownOpen = _this$state7.addProblemsDropdownOpen;\n      return React.createElement(Portal, {\n        selector: \"#modal\"\n      }, open && React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"wrapper\"\n      }, React.createElement(\"div\", {\n        id: \"modal_add_problem\",\n        style: {\n          zIndex: '1003'\n        },\n        className: \"jsx-837324748\" + \" \" + \"modal-page modal modal-custom\"\n      }, React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"card-modal grey lighten-3\"\n      }, React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"header-modal-box card-panel light-blue lighten-1 white-text\"\n      }, React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"header-flex-row row mb-0\"\n      }, React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"col s12 m4 l5\"\n      }, React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"header-holder\"\n      }, React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"header-col\"\n      }, React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"icon-col\"\n      }, React.createElement(\"i\", {\n        className: \"jsx-837324748\" + \" \" + \"icon-search\"\n      }))), React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"header-col\"\n      }, React.createElement(\"nav\", {\n        className: \"jsx-837324748\" + \" \" + \"breadcrumb-header\"\n      }, React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"nav-wrapper \"\n      }, React.createElement(\"a\", {\n        href: \"#!\",\n        className: \"jsx-837324748\" + \" \" + \"breadcrumb modal-close\"\n      }, \"< Custom Worksheet\"))), React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"card-panel-text\"\n      }, React.createElement(\"h1\", {\n        className: \"jsx-837324748\" + \" \" + \"text-large\"\n      }, \"Problem Bank\"))))), React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"card-panel-description col s8 m3 l2\"\n      }, React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"card-panel-text\"\n      }, React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"col-row\"\n      }, React.createElement(\"span\", {\n        className: \"jsx-837324748\" + \" \" + \"value\"\n      }, problems.length), React.createElement(\"span\", {\n        className: \"jsx-837324748\" + \" \" + \"value-text\"\n      }, \"worksheet \", React.createElement(\"br\", {\n        className: \"jsx-837324748\"\n      }), \"problems\")))), React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"col s2 m1 right-align position-mobile-right\"\n      }, React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"close-block\"\n      }, React.createElement(\"a\", {\n        href: \"#\",\n        onClick: onClose,\n        className: \"jsx-837324748\" + \" \" + \"modal-close close\"\n      }, React.createElement(\"i\", {\n        className: \"jsx-837324748\" + \" \" + \"icon-close-thin\"\n      }))))), React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"tabs-switcher-holder card-panel-row\"\n      }, React.createElement(\"ul\", {\n        className: \"jsx-837324748\" + \" \" + \"tabs\"\n      }, React.createElement(\"li\", {\n        style: {\n          borderBottom: openSection === 'problems' ? '2px solid white' : ''\n        },\n        className: \"jsx-837324748\" + \" \" + \"tab col s3\"\n      }, React.createElement(\"a\", {\n        href: \"#\",\n        onClick: function onClick() {\n          return _this2.onChangeOpenSection('problems');\n        },\n        className: \"jsx-837324748\" + \" \" + ((openSection === 'problems' ? 'active' : '') || \"\")\n      }, React.createElement(\"b\", {\n        className: \"jsx-837324748\"\n      }, \"Problems\"))), React.createElement(\"li\", {\n        style: {\n          borderBottom: openSection === 'passages' ? '2px solid white' : ''\n        },\n        className: \"jsx-837324748\" + \" \" + \"tab col s3\"\n      }, React.createElement(\"a\", {\n        href: \"#\",\n        onClick: function onClick() {\n          return _this2.onChangeOpenSection('passages');\n        },\n        className: \"jsx-837324748\" + \" \" + ((openSection === 'passages' ? 'active' : '') || \"\")\n      }, React.createElement(\"b\", {\n        className: \"jsx-837324748\"\n      }, \"Passages\")))))), React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"tabs-content\"\n      }, React.createElement(FilterSection, {\n        onSetFilteredTopicState: this.onSetFilteredTopicState,\n        onClearFilters: this.onClearFilters,\n        sortBySubject: this.determineSort,\n        toggleSelectAllProblemsOrPassages: this.toggleSelectAllProblemsOrPassages,\n        handleFilterClick: this.handleFilterClick,\n        subjectFilters: subjectFilters,\n        difficultyFilters: difficultyFilters,\n        typeFilters: typeFilters,\n        workbookFilters: workbookFilters\n      }), openSection === 'problems' ? React.createElement(\"div\", {\n        id: \"tab_problems\",\n        className: \"jsx-837324748\" + \" \" + \"tab-content active\"\n      }, React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"content-section content-section-80\"\n      }, React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"container-lg\"\n      }, React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"result-row center-align\"\n      }, React.createElement(\"b\", {\n        className: \"jsx-837324748\" + \" \" + \"result\"\n      }, \"- \", this.getMappableProblemsOrPassages('problems').length, \" matches -\")), React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"list-view-section\"\n      }, React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"list-table detail-table\"\n      }, React.createElement(TableHeader, {\n        sortBySubject: this.determineSort\n      }), React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"list-table-body\"\n      }, this.mapProblems())))))) : React.createElement(\"div\", {\n        id: \"tab_passages\",\n        className: \"jsx-837324748\" + \" \" + \"tab-content active\"\n      }, React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"content-section content-section-80\"\n      }, React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"container-lg\"\n      }, React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"result-row center-align\"\n      }, React.createElement(\"b\", {\n        className: \"jsx-837324748\" + \" \" + \"result\"\n      }, \"- \", this.getMappableProblemsOrPassages('passages').length, \" matches -\")), this.mapPassages()))), React.createElement(\"div\", {\n        className: \"jsx-837324748\" + \" \" + \"add-btn-block\"\n      }, React.createElement(\"a\", {\n        href: \"#\",\n        \"data-target\": \"dropdown_assign_selected_passeges\",\n        onClick: this.onToggleAddProblemDropdown,\n        className: \"jsx-837324748\" + \" \" + \"dropdown-trigger waves-effect waves-teal btn add-btn\"\n      }, React.createElement(\"i\", {\n        className: \"jsx-837324748\" + \" \" + \"material-icons\"\n      }, \"add\"), \"Add Selected Problems\"), React.createElement(\"ul\", {\n        id: \"dropdown_assign_selected_passeges\",\n        style: {\n          display: addProblemsDropdownOpen ? 'block' : '0',\n          opacity: addProblemsDropdownOpen ? '1' : '0'\n        },\n        className: \"jsx-837324748\" + \" \" + 'dropdown-content'\n      }, React.createElement(\"li\", {\n        className: \"jsx-837324748\"\n      }, React.createElement(\"a\", {\n        href: \"#\",\n        onClick: function onClick() {\n          return _this2.onAddSelectedProblems('today');\n        },\n        className: \"jsx-837324748\"\n      }, \"For Today\")), React.createElement(\"li\", {\n        className: \"jsx-837324748\"\n      }, React.createElement(\"a\", {\n        href: \"#\",\n        onClick: function onClick() {\n          return _this2.onAddSelectedProblems('tomorrow');\n        },\n        className: \"jsx-837324748\"\n      }, \"For Tomorrow\")), React.createElement(\"li\", {\n        className: \"jsx-837324748\"\n      }, React.createElement(\"a\", {\n        href: \"#\",\n        onClick: function onClick() {\n          return _this2.onAddSelectedProblems('nextSession');\n        },\n        className: \"jsx-837324748\"\n      }, \"For Next Session\")), React.createElement(\"li\", {\n        className: \"jsx-837324748\"\n      }, React.createElement(\"a\", {\n        href: \"#\",\n        onClick: function onClick() {\n          return _this2.onAddSelectedProblems('date');\n        },\n        className: \"jsx-837324748\"\n      }, \"For Date...\")))))))), React.createElement(_JSXStyle, {\n        id: \"837324748\"\n      }, \".card-modal.jsx-837324748{margin:0;border-radius:6px;}.wrapper.jsx-837324748{min-height:0px;}.modal-custom.jsx-837324748{opacity:1;visibility:visible;}.modal-footer.jsx-837324748{background-color:white;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Wb2x1bWVzL0hERC9TaXRlcy9jbGVhcmNob2ljZXRlc3RwcmVwL2NsZWFyLWNob2ljZS1hZG1pbi9jb21wb25lbnRzL1dvcmtzaGVldC9EZXRhaWxQYWdlL2NvbXBvbmVudHMvUHJvYmxlbUJhbmsvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBNmZXLEFBRzBCLEFBSU0sQUFHTCxBQUlhLFNBVkwsQ0FPQyxLQUhyQixRQU9BLElBVkEsRUFPQSIsImZpbGUiOiIvVm9sdW1lcy9IREQvU2l0ZXMvY2xlYXJjaG9pY2V0ZXN0cHJlcC9jbGVhci1jaG9pY2UtYWRtaW4vY29tcG9uZW50cy9Xb3Jrc2hlZXQvRGV0YWlsUGFnZS9jb21wb25lbnRzL1Byb2JsZW1CYW5rL2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgYXJyYXktY2FsbGJhY2stcmV0dXJuICovXG4vKiBlc2xpbnQtZGlzYWJsZSBjb25zaXN0ZW50LXJldHVybiAqL1xuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgdXBkYXRlIGZyb20gJ2ltbXV0YWJpbGl0eS1oZWxwZXInO1xuXG5pbXBvcnQgUG9ydGFsIGZyb20gJy4uLy4uLy4uLy4uL1BvcnRhbCc7XG5pbXBvcnQgRmlsdGVyU2VjdGlvbiBmcm9tICcuL2NvbXBvbmVudHMvRmlsdGVyU2VjdGlvbic7XG5pbXBvcnQgVGFibGVIZWFkZXIgZnJvbSAnLi9jb21wb25lbnRzL1RhYmxlSGVhZGVyJztcblxuaW1wb3J0IHsgdG9waWNNYXAsIHdvcmtib29rTWFwLCBzdWJqZWN0TWFwLCBkaWZmaWN1bHR5TWFwLCB0eXBlTWFwIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvd29ya3NoZWV0RmlsdGVyTWFwJztcbmltcG9ydCB7IHN1YmplY3RBc2NlbmRpbmcsIHN1YmplY3REZXNjZW5kaW5nIH0gZnJvbSAnLi4vLi4vLi4vLi4vdXRpbHMvc29ydEZ1bmN0aW9ucyc7XG5cbmNsYXNzIFByb2JsZW1CYW5rIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGFkZFByb2JsZW1zRHJvcGRvd25PcGVuOiBmYWxzZSxcbiAgICAgIG9wZW5TZWN0aW9uOiAncHJvYmxlbXMnLFxuICAgICAgdG9waWNGaWx0ZXI6ICcnLFxuICAgICAgc3ViamVjdEZpbHRlcnM6IFtdLFxuICAgICAgZGlmZmljdWx0eUZpbHRlcnM6IFtdLFxuICAgICAgdHlwZUZpbHRlcnM6IFtdLFxuICAgICAgd29ya2Jvb2tGaWx0ZXJzOiBbXSxcbiAgICAgIHNvcnQ6ICcnLFxuICAgICAgc2VsZWN0ZWRQcm9ibGVtczogW10sXG4gICAgICBzZWxlY3RlZFBhc3NhZ2VzOiBbXSxcbiAgICAgIHByb2JsZW1zOiBbXSxcbiAgICAgIHBhc3NhZ2VzOiBbXSxcbiAgICAgIHdvcmtzaGVldElkOiBudWxsLFxuICAgIH1cbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIGNvbnN0IHsgcHJvYmxlbXMsIHBhc3NhZ2VzLCB3b3Jrc2hlZXRJZCB9ID0gdGhpcy5wcm9wcztcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3Qvbm8tZGlkLW1vdW50LXNldC1zdGF0ZVxuICAgIHRoaXMuc2V0U3RhdGUoeyBwcm9ibGVtcywgcGFzc2FnZXMsIHdvcmtzaGVldElkIH0pO1xuICB9XG5cbiAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyA9IChuZXh0UHJvcHMpID0+IHtcbiAgICBpZiAoKCF0aGlzLnByb3BzLndvcmtzaGVldElkIHx8IG5leHRQcm9wcy53b3Jrc2hlZXRJZCAhPT0gdGhpcy5zdGF0ZS53b3Jrc2hlZXRJZCkpIHtcbiAgICAgIGNvbnN0IHsgcHJvYmxlbXMsIHBhc3NhZ2VzLCB3b3Jrc2hlZXRJZCB9ID0gbmV4dFByb3BzO1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7IHByb2JsZW1zLCBwYXNzYWdlcywgd29ya3NoZWV0SWQgfSk7XG4gICAgfVxuICB9XG5cbiAgb25Ub2dnbGVBZGRQcm9ibGVtRHJvcGRvd24gPSAoKSA9PiB0aGlzLnNldFN0YXRlKCh7IGFkZFByb2JsZW1zRHJvcGRvd25PcGVuIH0pID0+ICh7IGFkZFByb2JsZW1zRHJvcGRvd25PcGVuOiAhYWRkUHJvYmxlbXNEcm9wZG93bk9wZW4gfSkpXG5cbiAgb25DaGFuZ2VPcGVuU2VjdGlvbiA9IChvcGVuU2VjdGlvbikgPT4gdGhpcy5zZXRTdGF0ZSh7IG9wZW5TZWN0aW9uIH0pXG4gIG9uU2V0RmlsdGVyZWRUb3BpY1N0YXRlID0gKHRvcGljRmlsdGVyKSA9PiB0aGlzLnNldFN0YXRlKHsgdG9waWNGaWx0ZXIgfSlcbiAgb25DbGVhckZpbHRlcnMgPSAoKSA9PiB0aGlzLnNldFN0YXRlKHsgc3ViamVjdEZpbHRlcnM6IFtdLCBkaWZmaWN1bHR5RmlsdGVyczogW10sIHR5cGVGaWx0ZXJzOiBbXSwgd29ya2Jvb2tGaWx0ZXJzOiBbXSwgdG9waWNGaWx0ZXI6ICcnIH0pXG5cbiAgb25TZXRBc2NlbmRpbmdTb3J0ID0gKCkgPT4gdGhpcy5zZXRTdGF0ZSh7IHNvcnQ6ICdhc2NlbmRpbmcnIH0pO1xuICBvblNldERlc2NlbmRpbmdTb3J0ID0gKCkgPT4gdGhpcy5zZXRTdGF0ZSh7IHNvcnQ6ICdkZXNjZW5kaW5nJyB9KTtcblxuICBvblNvcnRCeVN1YmplY3QgPSAocHJvYmxlbXNPclBhc3NhZ2VzKSA9PiB7XG4gICAgY29uc3QgeyBzb3J0IH0gPSB0aGlzLnN0YXRlO1xuICAgIGlmIChzb3J0ID09PSAnYXNjZW5kaW5nJykge1xuICAgICAgcmV0dXJuIHByb2JsZW1zT3JQYXNzYWdlcy5zb3J0KHN1YmplY3RBc2NlbmRpbmcpO1xuICAgIH1cbiAgICByZXR1cm4gcHJvYmxlbXNPclBhc3NhZ2VzLnNvcnQoc3ViamVjdERlc2NlbmRpbmcpO1xuICB9XG4gIC8vIERpZmZpY3VsdHkgYW5kIHR5cGUgZmlsdGVycyBhcmUgc2ltaWxhciBlbm91Z2ggdG8gcmV1c2UgdGhlIHNhbWUgcmVkdWNlIGZ1bmN0aW9uLCB0b3BpYyBhbmQgd29ya2Jvb2sgYXJlIHVuaXF1ZSBlbm91Z2ggdG8gZ2V0IHJlcGV0aXRpdmUgZm9yIHRoZSBzYWtlIG9mIHJlYWRhYmlsaXR5XG4gIG9uRmlsdGVyUGFzc2FnZXMgPSAocGFzc2FnZXMsIGZpbHRlclR5cGUsIGZpbHRlcikgPT4ge1xuICAgIHN3aXRjaCAoZmlsdGVyVHlwZSkge1xuICAgICAgY2FzZSAnZGlmZmljdWx0eSc6XG4gICAgICBjYXNlICd0eXBlJzpcbiAgICAgICAgcmV0dXJuIHBhc3NhZ2VzLnJlZHVjZSgoZmluYWxBcnIsIHBhc3NhZ2UpID0+IHtcbiAgICAgICAgICBwYXNzYWdlLnByb2JsZW1zLm1hcChwcm9ibGVtID0+IHtcbiAgICAgICAgICAgIGlmIChmaWx0ZXIuaW5kZXhPZihwcm9ibGVtW2ZpbHRlclR5cGVdKSAhPT0gLTEgJiYgZmluYWxBcnIuaW5kZXhPZihwYXNzYWdlKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgZmluYWxBcnIucHVzaChwYXNzYWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gZmluYWxBcnI7XG4gICAgICAgIH0sIFtdKTtcbiAgICAgIGNhc2UgJ3RvcGljJzpcbiAgICAgICAgcmV0dXJuIHBhc3NhZ2VzLnJlZHVjZSgoZmluYWxBcnIsIHBhc3NhZ2UpID0+IHtcbiAgICAgICAgICBwYXNzYWdlLnByb2JsZW1zLm1hcChwcm9ibGVtID0+IHtcbiAgICAgICAgICAgIGlmIChwcm9ibGVtLnRvcGljcy5pbmRleE9mKGZpbHRlcikgIT09IC0xICYmIGZpbmFsQXJyLmluZGV4T2YocGFzc2FnZSkgPT09IC0xKSB7XG4gICAgICAgICAgICAgIGZpbmFsQXJyLnB1c2gocGFzc2FnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIGZpbmFsQXJyO1xuICAgICAgICB9LCBbXSk7XG4gICAgICBjYXNlICd3b3JrYm9vayc6XG4gICAgICAgIHJldHVybiBwYXNzYWdlcy5yZWR1Y2UoKGZpbmFsQXJyLCBwYXNzYWdlKSA9PiB7XG4gICAgICAgICAgcGFzc2FnZS5wcm9ibGVtcy5tYXAocHJvYmxlbSA9PiB7XG4gICAgICAgICAgICBpZiAoZmlsdGVyLmluZGV4T2Yod29ya2Jvb2tNYXBbcHJvYmxlbS5pbldvcmtib29rXSkgIT09IC0xICYmIGZpbmFsQXJyLmluZGV4T2YocGFzc2FnZSkgPT09IC0xKSB7XG4gICAgICAgICAgICAgIGZpbmFsQXJyLnB1c2gocGFzc2FnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIGZpbmFsQXJyO1xuICAgICAgICB9LCBbXSk7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICAvLyBQcm9ibGVtcyBnZXQgZmlsdGVyZWQgd2l0aCBiYXNpYyBmaWx0ZXIgZnVuY3Rpb25zLCBwYXNzYWdlcyBnZXQgcGFzc2VkIGludG8gb25GaWx0ZXJQYXNzYWdlcyBzaW5jZSBhIGZldyBvZiB0aGUgZmlsdGVycyBhcmUgYmFzZWQgb24gdGhlIHByb2JsZW1zIG5lc3RlZCBpbiBlYWNoIHBhc3NhZ2VcbiAgb25GaWx0ZXJQcm9ibGVtc09yUGFzc2FnZXMgPSAodHlwZSkgPT4ge1xuICAgIGNvbnN0IHsgc3ViamVjdEZpbHRlcnMsIGRpZmZpY3VsdHlGaWx0ZXJzLCB0eXBlRmlsdGVycywgd29ya2Jvb2tGaWx0ZXJzLCB0b3BpY0ZpbHRlciwgcHJvYmxlbXM6IGFsbFByb2JsZW1zLCBwYXNzYWdlczogYWxsUGFzc2FnZXMgfSA9IHRoaXMuc3RhdGU7XG4gICAgbGV0IHByb2JsZW1zT3JQYXNzYWdlcztcbiAgICBpZiAodHlwZSA9PT0gJ3Byb2JsZW1zJykge1xuICAgICAgcHJvYmxlbXNPclBhc3NhZ2VzID0gYWxsUHJvYmxlbXM7XG4gICAgfSBlbHNlIHtcbiAgICAgIHByb2JsZW1zT3JQYXNzYWdlcyA9IGFsbFBhc3NhZ2VzO1xuICAgIH1cbiAgICBpZiAoc3ViamVjdEZpbHRlcnMubGVuZ3RoKSB7XG4gICAgICBwcm9ibGVtc09yUGFzc2FnZXMgPSBwcm9ibGVtc09yUGFzc2FnZXMuZmlsdGVyKHByb2JsZW1PclBhc3NhZ2UgPT4gc3ViamVjdEZpbHRlcnMuaW5kZXhPZihwcm9ibGVtT3JQYXNzYWdlLnN1YmplY3QpICE9PSAtMSk7XG4gICAgfVxuICAgIGlmIChkaWZmaWN1bHR5RmlsdGVycy5sZW5ndGgpIHtcbiAgICAgIGlmICh0eXBlID09PSAncHJvYmxlbXMnKSB7XG4gICAgICAgIHByb2JsZW1zT3JQYXNzYWdlcyA9IHByb2JsZW1zT3JQYXNzYWdlcy5maWx0ZXIocHJvYmxlbSA9PiBkaWZmaWN1bHR5RmlsdGVycy5pbmRleE9mKHByb2JsZW0uZGlmZmljdWx0eSkgIT09IC0xKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHByb2JsZW1zT3JQYXNzYWdlcyA9IHRoaXMub25GaWx0ZXJQYXNzYWdlcyhwcm9ibGVtc09yUGFzc2FnZXMsICdkaWZmaWN1bHR5JywgZGlmZmljdWx0eUZpbHRlcnMpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAodHlwZUZpbHRlcnMubGVuZ3RoKSB7XG4gICAgICBpZiAodHlwZSA9PT0gJ3Byb2JsZW1zJykge1xuICAgICAgICBwcm9ibGVtc09yUGFzc2FnZXMgPSBwcm9ibGVtc09yUGFzc2FnZXMuZmlsdGVyKHByb2JsZW0gPT4gdHlwZUZpbHRlcnMuaW5kZXhPZihwcm9ibGVtLnR5cGUpICE9PSAtMSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcm9ibGVtc09yUGFzc2FnZXMgPSB0aGlzLm9uRmlsdGVyUGFzc2FnZXMocHJvYmxlbXNPclBhc3NhZ2VzLCAndHlwZScsIHR5cGVGaWx0ZXJzKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHdvcmtib29rRmlsdGVycy5sZW5ndGgpIHtcbiAgICAgIGlmICh0eXBlID09PSAncHJvYmxlbXMnKSB7XG4gICAgICAgIHByb2JsZW1zT3JQYXNzYWdlcyA9IHByb2JsZW1zT3JQYXNzYWdlcy5maWx0ZXIocHJvYmxlbSA9PiB3b3JrYm9va0ZpbHRlcnMuaW5kZXhPZih3b3JrYm9va01hcFtwcm9ibGVtLmluV29ya2Jvb2tdKSAhPT0gLTEpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcHJvYmxlbXNPclBhc3NhZ2VzID0gdGhpcy5vbkZpbHRlclBhc3NhZ2VzKHByb2JsZW1zT3JQYXNzYWdlcywgJ3dvcmtib29rJywgd29ya2Jvb2tGaWx0ZXJzKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHRvcGljRmlsdGVyLmxlbmd0aCkge1xuICAgICAgaWYgKHR5cGUgPT09ICdwcm9ibGVtcycpIHtcbiAgICAgICAgcHJvYmxlbXNPclBhc3NhZ2VzID0gcHJvYmxlbXNPclBhc3NhZ2VzLmZpbHRlcihwcm9ibGVtID0+IHByb2JsZW0udG9waWNzLmluZGV4T2YodG9waWNGaWx0ZXIpICE9PSAtMSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcm9ibGVtc09yUGFzc2FnZXMgPSB0aGlzLm9uRmlsdGVyUGFzc2FnZXMocHJvYmxlbXNPclBhc3NhZ2VzLCAndG9waWMnLCB0b3BpY0ZpbHRlcik7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwcm9ibGVtc09yUGFzc2FnZXM7XG4gIH1cblxuICBvbkFkZFNlbGVjdGVkUHJvYmxlbXMgPSAoYWRkVGltZSkgPT4ge1xuICAgIGNvbnN0IHsgc2VsZWN0ZWRQcm9ibGVtcywgc2VsZWN0ZWRQYXNzYWdlcyB9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCB7IGFkZFNlbGVjdGVkUHJvYmxlbXMgfSA9IHRoaXMucHJvcHM7XG4gICAgYWRkU2VsZWN0ZWRQcm9ibGVtcyhzZWxlY3RlZFByb2JsZW1zLCBzZWxlY3RlZFBhc3NhZ2VzLCBhZGRUaW1lKTtcbiAgICB0aGlzLnNldFN0YXRlKHsgc2VsZWN0ZWRQYXNzYWdlczogW10sIHNlbGVjdGVkUHJvYmxlbXM6IFtdLCBhZGRQcm9ibGVtc0Ryb3Bkb3duT3BlbjogZmFsc2UgfSk7XG4gICB9XG5cbiAgZ2V0TWFwcGFibGVQcm9ibGVtc09yUGFzc2FnZXMgPSAodHlwZSkgPT4ge1xuICAgIGNvbnN0IHsgc3ViamVjdEZpbHRlcnMsIGRpZmZpY3VsdHlGaWx0ZXJzLCB0eXBlRmlsdGVycywgd29ya2Jvb2tGaWx0ZXJzLCB0b3BpY0ZpbHRlciwgc29ydCwgcHJvYmxlbXM6IGFsbFByb2JsZW1zLCBwYXNzYWdlczogYWxsUGFzc2FnZXMgfSA9IHRoaXMuc3RhdGU7XG4gICAgbGV0IHByb2JsZW1zT3JQYXNzYWdlcztcbiAgICBpZiAodHlwZSA9PT0gJ3Byb2JsZW1zJykge1xuICAgICAgcHJvYmxlbXNPclBhc3NhZ2VzID0gYWxsUHJvYmxlbXM7XG4gICAgfSBlbHNlIHtcbiAgICAgIHByb2JsZW1zT3JQYXNzYWdlcyA9IGFsbFBhc3NhZ2VzO1xuICAgIH1cbiAgICBpZiAodG9waWNGaWx0ZXIubGVuZ3RoIHx8IHN1YmplY3RGaWx0ZXJzLmxlbmd0aCB8fCBkaWZmaWN1bHR5RmlsdGVycy5sZW5ndGggfHwgdHlwZUZpbHRlcnMubGVuZ3RoIHx8IHdvcmtib29rRmlsdGVycy5sZW5ndGgpIHtcbiAgICAgIHByb2JsZW1zT3JQYXNzYWdlcyA9IHRoaXMub25GaWx0ZXJQcm9ibGVtc09yUGFzc2FnZXModHlwZSk7XG4gICAgfVxuICAgIGlmIChzb3J0KSB7XG4gICAgICByZXR1cm4gdGhpcy5vblNvcnRCeVN1YmplY3QocHJvYmxlbXNPclBhc3NhZ2VzKTtcbiAgICB9XG4gICAgcmV0dXJuIHByb2JsZW1zT3JQYXNzYWdlcztcbiAgfVxuXG4gIGRldGVybWluZVNvcnQgPSAoKSA9PiB7XG4gICAgY29uc3QgeyBzb3J0IH0gPSB0aGlzLnN0YXRlO1xuICAgIGlmIChzb3J0ID09PSAnJyB8fCBzb3J0ID09PSAnZGVzY2VuZGluZycpIHtcbiAgICAgIHJldHVybiB0aGlzLm9uU2V0QXNjZW5kaW5nU29ydCgpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5vblNldERlc2NlbmRpbmdTb3J0KCk7XG4gIH1cblxuICBoYW5kbGVGaWx0ZXJDbGljayA9IChmaWx0ZXJUeXBlLCBmaWx0ZXIpID0+IHtcbiAgICBjb25zdCB7IHN1YmplY3RGaWx0ZXJzOiBjdXJyZW50U3ViamVjdEZpbHRlcnMsIGRpZmZpY3VsdHlGaWx0ZXJzOiBjdXJyZW50RGlmZmljdWx0eUZpbHRlcnMsXG4gICAgICB0eXBlRmlsdGVyczogY3VycmVudFR5cGVGaWx0ZXJzLCB3b3JrYm9va0ZpbHRlcnM6IGN1cnJlbnRXb3JrYm9va0ZpbHRlcnMgfSA9IHRoaXMuc3RhdGU7XG4gICAgbGV0IG1vZGlmaWVkRmlsdGVyQ3VycmVudFN0YXRlO1xuICAgIGxldCBtb2RpZmllZEZpbHRlck5hbWU7XG4gICAgbGV0IG1vZGlmaWVkRmlsdGVyVXBkYXRlZFN0YXRlO1xuICAgIHN3aXRjaCAoZmlsdGVyVHlwZSkge1xuICAgICAgY2FzZSAnc3ViamVjdCc6XG4gICAgICAgIG1vZGlmaWVkRmlsdGVyQ3VycmVudFN0YXRlID0gY3VycmVudFN1YmplY3RGaWx0ZXJzO1xuICAgICAgICBtb2RpZmllZEZpbHRlck5hbWUgPSAnc3ViamVjdEZpbHRlcnMnO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2RpZmZpY3VsdHknOlxuICAgICAgICBtb2RpZmllZEZpbHRlckN1cnJlbnRTdGF0ZSA9IGN1cnJlbnREaWZmaWN1bHR5RmlsdGVycztcbiAgICAgICAgbW9kaWZpZWRGaWx0ZXJOYW1lID0gJ2RpZmZpY3VsdHlGaWx0ZXJzJztcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICd0eXBlJzpcbiAgICAgICAgbW9kaWZpZWRGaWx0ZXJDdXJyZW50U3RhdGUgPSBjdXJyZW50VHlwZUZpbHRlcnM7XG4gICAgICAgIG1vZGlmaWVkRmlsdGVyTmFtZSA9ICd0eXBlRmlsdGVycyc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnd29ya2Jvb2snOlxuICAgICAgICBtb2RpZmllZEZpbHRlckN1cnJlbnRTdGF0ZSA9IGN1cnJlbnRXb3JrYm9va0ZpbHRlcnM7XG4gICAgICAgIG1vZGlmaWVkRmlsdGVyTmFtZSA9ICd3b3JrYm9va0ZpbHRlcnMnO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBpZiAobW9kaWZpZWRGaWx0ZXJDdXJyZW50U3RhdGUuaW5kZXhPZihmaWx0ZXIpID09PSAtMSkge1xuICAgICAgbW9kaWZpZWRGaWx0ZXJVcGRhdGVkU3RhdGUgPSB1cGRhdGUobW9kaWZpZWRGaWx0ZXJDdXJyZW50U3RhdGUsIHtcbiAgICAgICAgJHB1c2g6IFtmaWx0ZXJdLFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGZpbHRlckluZGV4ID0gbW9kaWZpZWRGaWx0ZXJDdXJyZW50U3RhdGUuaW5kZXhPZihmaWx0ZXIpO1xuICAgICAgbW9kaWZpZWRGaWx0ZXJVcGRhdGVkU3RhdGUgPSB1cGRhdGUobW9kaWZpZWRGaWx0ZXJDdXJyZW50U3RhdGUsIHtcbiAgICAgICAgJHNwbGljZTogW1sgZmlsdGVySW5kZXgsIDEgXV0sXG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5zZXRTdGF0ZSh7IFttb2RpZmllZEZpbHRlck5hbWVdOiBtb2RpZmllZEZpbHRlclVwZGF0ZWRTdGF0ZSB9KTtcbiAgfVxuXG4gIHRvZ2dsZVNlbGVjdEFsbFByb2JsZW1zT3JQYXNzYWdlcyA9ICgpID0+IHtcbiAgICBjb25zdCB7IG9wZW5TZWN0aW9uOiB0eXBlLCBwcm9ibGVtcywgcGFzc2FnZXMsIHNlbGVjdGVkUHJvYmxlbXM6IGN1cnJlbnRTZWxlY3RlZFByb2JsZW1zLCBzZWxlY3RlZFBhc3NhZ2VzOiBjdXJyZW50U2VsZWN0ZWRQYXNzYWdlcyB9ID0gdGhpcy5zdGF0ZTtcbiAgICBsZXQgY2xpY2tlZFR5cGVDdXJyZW50U3RhdGU7XG4gICAgbGV0IGNsaWNrZWRUeXBlTmFtZTtcbiAgICBsZXQgY2xpY2tlZEFsbE9mVHlwZTtcbiAgICBpZiAodHlwZSA9PT0gJ3Byb2JsZW1zJykge1xuICAgICAgY2xpY2tlZFR5cGVDdXJyZW50U3RhdGUgPSBjdXJyZW50U2VsZWN0ZWRQcm9ibGVtcztcbiAgICAgIGNsaWNrZWRUeXBlTmFtZSA9ICdzZWxlY3RlZFByb2JsZW1zJztcbiAgICAgIGNsaWNrZWRBbGxPZlR5cGUgPSBwcm9ibGVtcztcbiAgICB9IGVsc2Uge1xuICAgICAgY2xpY2tlZFR5cGVDdXJyZW50U3RhdGUgPSBjdXJyZW50U2VsZWN0ZWRQYXNzYWdlcztcbiAgICAgIGNsaWNrZWRUeXBlTmFtZSA9ICdzZWxlY3RlZFBhc3NhZ2VzJztcbiAgICAgIGNsaWNrZWRBbGxPZlR5cGUgPSBwYXNzYWdlcztcbiAgICB9XG4gICAgaWYgKGNsaWNrZWRUeXBlQ3VycmVudFN0YXRlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7IFtjbGlja2VkVHlwZU5hbWVdOiBjbGlja2VkQWxsT2ZUeXBlIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHsgW2NsaWNrZWRUeXBlTmFtZV06IFtdIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8vIENvbmRpdGlvbmFsbHkgdXBkYXRlcyB0aGUgc2VsZWN0ZWQgcHJvYmxlbSBvciBwYXNzYWdlcyBhcnJheSBkZXBlbmRpbmcgb24gdGhlIGluY29taW5nIHR5cGUgbmFtZVxuICBoYW5kbGVQcm9ibGVtT3JQYXNzYWdlQ2xpY2sgPSAodHlwZSwgdmFsdWUpID0+IHtcbiAgICBjb25zdCB7IHNlbGVjdGVkUHJvYmxlbXM6IGN1cnJlbnRTZWxlY3RlZFByb2JsZW1zLCBzZWxlY3RlZFBhc3NhZ2VzOiBjdXJyZW50U2VsZWN0ZWRQYXNzYWdlcyB9ID0gdGhpcy5zdGF0ZTtcbiAgICBsZXQgY2xpY2tlZFR5cGVDdXJyZW50U3RhdGU7XG4gICAgbGV0IGNsaWNrZWRUeXBlTmFtZTtcbiAgICBpZiAodHlwZSA9PT0gJ3Byb2JsZW0nKSB7XG4gICAgICBjbGlja2VkVHlwZUN1cnJlbnRTdGF0ZSA9IGN1cnJlbnRTZWxlY3RlZFByb2JsZW1zO1xuICAgICAgY2xpY2tlZFR5cGVOYW1lID0gJ3NlbGVjdGVkUHJvYmxlbXMnO1xuICAgIH0gZWxzZSB7XG4gICAgICBjbGlja2VkVHlwZUN1cnJlbnRTdGF0ZSA9IGN1cnJlbnRTZWxlY3RlZFBhc3NhZ2VzO1xuICAgICAgY2xpY2tlZFR5cGVOYW1lID0gJ3NlbGVjdGVkUGFzc2FnZXMnO1xuICAgIH1cbiAgICBsZXQgY2xpY2tlZFR5cGVVcGRhdGVkU3RhdGU7XG4gICAgaWYgKGNsaWNrZWRUeXBlQ3VycmVudFN0YXRlLm1hcChzZWxlY3RlZEVsZW1lbnQgPT4gc2VsZWN0ZWRFbGVtZW50LmlkKS5pbmRleE9mKHZhbHVlLmlkKSA9PT0gLTEpIHtcbiAgICAgIGNsaWNrZWRUeXBlVXBkYXRlZFN0YXRlID0gdXBkYXRlKGNsaWNrZWRUeXBlQ3VycmVudFN0YXRlLCB7XG4gICAgICAgICRwdXNoOiBbdmFsdWVdLFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHNlbGVjdGVkSW5kZXggPSBjbGlja2VkVHlwZUN1cnJlbnRTdGF0ZS5tYXAoc2VsZWN0ZWRFbGVtZW50ID0+IHNlbGVjdGVkRWxlbWVudC5pZCkuaW5kZXhPZih2YWx1ZS5pZCk7XG4gICAgICBjbGlja2VkVHlwZVVwZGF0ZWRTdGF0ZSA9IHVwZGF0ZShjbGlja2VkVHlwZUN1cnJlbnRTdGF0ZSwge1xuICAgICAgICAkc3BsaWNlOiBbWyBzZWxlY3RlZEluZGV4LCAxIF1dLFxuICAgICAgfSk7XG4gICAgfVxuICAgIHRoaXMuc2V0U3RhdGUoeyBbY2xpY2tlZFR5cGVOYW1lXTogY2xpY2tlZFR5cGVVcGRhdGVkU3RhdGUgfSk7XG4gIH1cblxuICBtYXBQcm9ibGVtcyA9ICgpID0+IHRoaXMuZ2V0TWFwcGFibGVQcm9ibGVtc09yUGFzc2FnZXMoJ3Byb2JsZW1zJykubWFwKHByb2JsZW0gPT4ge1xuICAgIGNvbnN0IHsgc2VsZWN0ZWRQcm9ibGVtcyB9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCBzZWxlY3RlZCA9IHNlbGVjdGVkUHJvYmxlbXMubWFwKHNlbGVjdGVkUHJvYmxlbSA9PiBzZWxlY3RlZFByb2JsZW0uaWQpLmluZGV4T2YocHJvYmxlbS5pZCkgIT09IC0xO1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT17c2VsZWN0ZWQgPyBcImNhcmQgbGlzdC10YWJsZS1yb3cgbGlzdC1yb3ctYWRkZWRcIiA6IFwiY2FyZCBsaXN0LXRhYmxlLXJvd1wifT5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsaXN0LXRhYmxlLWNlbGwgY2hlY2tib3gtY2VsbFwiPlxuICAgICAgICAgIDxsYWJlbD5cbiAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICB0eXBlPVwiY2hlY2tib3hcIlxuICAgICAgICAgICAgICBjbGFzc05hbWU9XCJmaWxsZWQtaW5cIlxuICAgICAgICAgICAgICBuYW1lPVwiY2hlY2tfMDFcIlxuICAgICAgICAgICAgICBjaGVja2VkPXtzZWxlY3RlZFByb2JsZW1zLm1hcChzZWxlY3RlZFByb2JsZW0gPT4gc2VsZWN0ZWRQcm9ibGVtLmlkKS5pbmRleE9mKHByb2JsZW0uaWQpICE9PSAtMX1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9eygpID0+IHRoaXMuaGFuZGxlUHJvYmxlbU9yUGFzc2FnZUNsaWNrKCdwcm9ibGVtJywgcHJvYmxlbSl9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPHNwYW4+Jm5ic3A7PC9zcGFuPlxuICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxpc3QtdGFibGUtY2VsbCBzdWJqZWN0LWNlbGxcIj5cbiAgICAgICAgICA8c3Bhbj57c3ViamVjdE1hcFtwcm9ibGVtLnN1YmplY3RdfTwvc3Bhbj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibGlzdC10YWJsZS1jZWxsIGluZm8tY2VsbFwiPlxuICAgICAgICAgIDxzcGFuPntkaWZmaWN1bHR5TWFwW3Byb2JsZW0uZGlmZmljdWx0eV19PC9zcGFuPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsaXN0LXRhYmxlLWNlbGwgdHlwZS1jZWxsXCI+XG4gICAgICAgICAgPHNwYW4+e3R5cGVNYXBbcHJvYmxlbS50eXBlXX08L3NwYW4+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxpc3QtdGFibGUtY2VsbCBpbi1jZWxsXCI+e3Byb2JsZW0uaW5Xb3JrYm9vayA/ICdZZXMnIDogJ05vJ308L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsaXN0LXRhYmxlLWNlbGwgdG9waWMtY2VsbFwiPlxuICAgICAgICAgIHtwcm9ibGVtLnRvcGljcy5tYXAodG9waWMgPT4gPHNwYW4gY2xhc3NOYW1lPVwiY2hpcFwiIGlkPXt0b3BpY30+e3RvcGljTWFwW3RvcGljXX08L3NwYW4+KX1cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibGlzdC10YWJsZS1jZWxsIHZpZXctY2VsbFwiPlxuICAgICAgICAgIDxhIGhyZWY9XCIjXCI+PGkgY2xhc3NOYW1lPVwiaWNvbi1leWVcIj48L2k+PC9hPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsaXN0LXRhYmxlLWNlbGwgZHJvcC1jZWxsXCI+XG4gICAgICAgICAgPGEgaHJlZj1cIiNcIj48aSBjbGFzc05hbWU9XCJpY29uLXBsdXMtY2lyY2xlXCI+PC9pPjwvYT5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICApXG4gIH0pXG5cbiAgbWFwUGFzc2FnZXMgPSAoKSA9PiB0aGlzLmdldE1hcHBhYmxlUHJvYmxlbXNPclBhc3NhZ2VzKCdwYXNzYWdlcycpLm1hcChwYXNzYWdlID0+IHtcbiAgICBjb25zdCB7IHNlbGVjdGVkUGFzc2FnZXMgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3Qgc2VsZWN0ZWQgPSBzZWxlY3RlZFBhc3NhZ2VzLm1hcChzZWxlY3RlZFBhc3NhZ2UgPT4gc2VsZWN0ZWRQYXNzYWdlLmlkKS5pbmRleE9mKHBhc3NhZ2UuaWQpICE9PSAtMTtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJsaXN0LXZpZXctc2VjdGlvblwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT17c2VsZWN0ZWQgPyBcImxpc3QtdGFibGUgZGV0YWlsLXRhYmxlIGxpc3QtdGFibGUtYWRkZWRcIiA6IFwibGlzdC10YWJsZSBkZXRhaWwtdGFibGVcIn0+XG4gICAgICAgICAgPFRhYmxlSGVhZGVyIHNvcnRCeVN1YmplY3Q9e3RoaXMuZGV0ZXJtaW5lU29ydH0gLz5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxpc3QtdGFibGUtYm9keVwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb21iaW5lZC1ob2xkZXJcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb21iaW5lZC1oZWFkZXJcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxpc3QtdGFibGUtcm93XCI+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxpc3QtdGFibGUtY2VsbCBjaGVja2JveC1jZWxsXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2hlY2tib3gtYmxvY2tcIj5cbiAgICAgICAgICAgICAgICAgICAgICA8bGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cImNoZWNrYm94XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZmlsbGVkLWluXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17c2VsZWN0ZWRQYXNzYWdlcy5tYXAoc2VsZWN0ZWRQYXNzYWdlID0+IHNlbGVjdGVkUGFzc2FnZS5pZCkuaW5kZXhPZihwYXNzYWdlLmlkKSAhPT0gLTF9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoKSA9PiB0aGlzLmhhbmRsZVByb2JsZW1PclBhc3NhZ2VDbGljaygncGFzc2FnZScsIHBhc3NhZ2UpfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPiZuYnNwOzwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsaXN0LXRhYmxlLWNlbGwgc3ViamVjdC1jZWxsXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmlsdGVyLW5hbWVcIj57c3ViamVjdE1hcFtwYXNzYWdlLnN1YmplY3RdfTwvZGl2PlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxpc3QtdGFibGUtY2VsbCBjb21iaW5lZC10aXRsZS1jZWxsXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29tYmluZWQtdGl0bGVcIj57cGFzc2FnZS50aXRsZX08L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsaXN0LXRhYmxlLWNlbGwgdmlldy1jZWxsXCI+XG4gICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCIjXCI+PGkgY2xhc3NOYW1lPVwiY3VzdG9tLWljb24tdHJpYW5nbGUtcmlnaHRcIj48L2k+PC9hPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxpc3QtdGFibGUtY2VsbCBkcm9wLWNlbGxcIj5cbiAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cIiNcIj48aSBjbGFzc05hbWU9XCJpY29uLXBsdXMtY2lyY2xlXCI+PC9pPjwvYT5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2xsZWN0aW9uXCI+XG4gICAgICAgICAgICAgICAge3Bhc3NhZ2UucHJvYmxlbXMubWFwKHByb2JsZW0gPT4gKFxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2xsZWN0aW9uLWl0ZW0gbGlzdC10YWJsZS1yb3dcIiBpZD17cHJvYmxlbS5pZH0+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibGlzdC10YWJsZS1jZWxsIGNoZWNrYm94LWNlbGxcIj5cbiAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj4mbmJzcDs8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxpc3QtdGFibGUtY2VsbCBzdWJqZWN0LWNlbGxcIj5cbiAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj57c3ViamVjdE1hcFtwcm9ibGVtLnN1YmplY3RdfTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibGlzdC10YWJsZS1jZWxsIGluZm8tY2VsbFwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPntkaWZmaWN1bHR5TWFwW3Byb2JsZW0uZGlmZmljdWx0eV19PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsaXN0LXRhYmxlLWNlbGwgdHlwZS1jZWxsXCI+XG4gICAgICAgICAgICAgICAgICAgICAgPHNwYW4+e3R5cGVNYXBbcHJvYmxlbS50eXBlXX08L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxpc3QtdGFibGUtY2VsbCBpbi1jZWxsXCI+e3Byb2JsZW0uaW5Xb3JrYm9vayA/ICdZZXMnIDogJ05vJ308L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsaXN0LXRhYmxlLWNlbGwgdG9waWMtY2VsbFwiPlxuICAgICAgICAgICAgICAgICAgICAgIHtwcm9ibGVtLnRvcGljcy5tYXAodG9waWMgPT4gPHNwYW4gY2xhc3NOYW1lPVwiY2hpcFwiIGlkPXt0b3BpY30+e3RvcGljTWFwW3RvcGljXX08L3NwYW4+KX1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibGlzdC10YWJsZS1jZWxsIHZpZXctY2VsbFwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCIjXCI+PGkgY2xhc3NOYW1lPVwiaWNvbi1leWVcIj48L2k+PC9hPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsaXN0LXRhYmxlLWNlbGwgZHJvcC1jZWxsXCI+XG4gICAgICAgICAgICAgICAgICAgICAgPHNwYW4+Jm5ic3A7PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIClcbiAgfSlcblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyBvcGVuLCBvbkNsb3NlLCBwcm9ibGVtcyB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB7IG9wZW5TZWN0aW9uLCBzdWJqZWN0RmlsdGVycywgZGlmZmljdWx0eUZpbHRlcnMsIHR5cGVGaWx0ZXJzLCB3b3JrYm9va0ZpbHRlcnMsIGFkZFByb2JsZW1zRHJvcGRvd25PcGVuIH0gPSB0aGlzLnN0YXRlO1xuICAgIHJldHVybiAoXG4gICAgICA8UG9ydGFsIHNlbGVjdG9yPVwiI21vZGFsXCI+XG4gICAgICAgIHtvcGVuICYmIChcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIndyYXBwZXJcIj5cbiAgICAgICAgICAgIDxkaXYgaWQ9XCJtb2RhbF9hZGRfcHJvYmxlbVwiIGNsYXNzTmFtZT1cIm1vZGFsLXBhZ2UgbW9kYWwgbW9kYWwtY3VzdG9tXCIgc3R5bGU9e3sgekluZGV4OiAnMTAwMycgfX0+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2FyZC1tb2RhbCBncmV5IGxpZ2h0ZW4tM1wiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaGVhZGVyLW1vZGFsLWJveCBjYXJkLXBhbmVsIGxpZ2h0LWJsdWUgbGlnaHRlbi0xIHdoaXRlLXRleHRcIj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaGVhZGVyLWZsZXgtcm93IHJvdyBtYi0wXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29sIHMxMiBtNCBsNVwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaGVhZGVyLWhvbGRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJoZWFkZXItY29sXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaWNvbi1jb2xcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJpY29uLXNlYXJjaFwiPjwvaT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaGVhZGVyLWNvbFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8bmF2IGNsYXNzTmFtZT1cImJyZWFkY3J1bWItaGVhZGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJuYXYtd3JhcHBlciBcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCIjIVwiIGNsYXNzTmFtZT1cImJyZWFkY3J1bWIgbW9kYWwtY2xvc2VcIj4mbHQ7IEN1c3RvbSBXb3Jrc2hlZXQ8L2E+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvbmF2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNhcmQtcGFuZWwtdGV4dFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoMSBjbGFzc05hbWU9XCJ0ZXh0LWxhcmdlXCI+UHJvYmxlbSBCYW5rPC9oMT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2FyZC1wYW5lbC1kZXNjcmlwdGlvbiBjb2wgczggbTMgbDJcIj5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNhcmQtcGFuZWwtdGV4dFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2wtcm93XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInZhbHVlXCI+e3Byb2JsZW1zLmxlbmd0aH08L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInZhbHVlLXRleHRcIj53b3Jrc2hlZXQgPGJyIC8+cHJvYmxlbXM8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29sIHMyIG0xIHJpZ2h0LWFsaWduIHBvc2l0aW9uLW1vYmlsZS1yaWdodFwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2xvc2UtYmxvY2tcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCIjXCIgY2xhc3NOYW1lPVwibW9kYWwtY2xvc2UgY2xvc2VcIiBvbkNsaWNrPXtvbkNsb3NlfT48aSBjbGFzc05hbWU9XCJpY29uLWNsb3NlLXRoaW5cIj48L2k+PC9hPlxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YWJzLXN3aXRjaGVyLWhvbGRlciBjYXJkLXBhbmVsLXJvd1wiPlxuICAgICAgICAgICAgICAgICAgICA8dWwgY2xhc3NOYW1lPVwidGFic1wiPlxuICAgICAgICAgICAgICAgICAgICAgIDxsaVxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidGFiIGNvbCBzM1wiXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17eyBib3JkZXJCb3R0b206IG9wZW5TZWN0aW9uID09PSAncHJvYmxlbXMnID8gJzJweCBzb2xpZCB3aGl0ZScgOiAnJyB9fVxuICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzTmFtZT17b3BlblNlY3Rpb24gPT09ICdwcm9ibGVtcycgPyAnYWN0aXZlJyA6ICcnfSBocmVmPVwiI1wiIG9uQ2xpY2s9eygpID0+IHRoaXMub25DaGFuZ2VPcGVuU2VjdGlvbigncHJvYmxlbXMnKX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxiPlByb2JsZW1zPC9iPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgICAgICAgIDwvbGk+XG4gICAgICAgICAgICAgICAgICAgICAgPGxpXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ0YWIgY29sIHMzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7IGJvcmRlckJvdHRvbTogb3BlblNlY3Rpb24gPT09ICdwYXNzYWdlcycgPyAnMnB4IHNvbGlkIHdoaXRlJyA6ICcnIH19XG4gICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3NOYW1lPXtvcGVuU2VjdGlvbiA9PT0gJ3Bhc3NhZ2VzJyA/ICdhY3RpdmUnIDogJyd9IGhyZWY9XCIjXCIgb25DbGljaz17KCkgPT4gdGhpcy5vbkNoYW5nZU9wZW5TZWN0aW9uKCdwYXNzYWdlcycpfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGI+UGFzc2FnZXM8L2I+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICAgICAgICAgPC91bD5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGFicy1jb250ZW50XCI+XG4gICAgICAgICAgICAgICAgICA8RmlsdGVyU2VjdGlvblxuICAgICAgICAgICAgICAgICAgICBvblNldEZpbHRlcmVkVG9waWNTdGF0ZT17dGhpcy5vblNldEZpbHRlcmVkVG9waWNTdGF0ZX1cbiAgICAgICAgICAgICAgICAgICAgb25DbGVhckZpbHRlcnM9e3RoaXMub25DbGVhckZpbHRlcnN9XG4gICAgICAgICAgICAgICAgICAgIHNvcnRCeVN1YmplY3Q9e3RoaXMuZGV0ZXJtaW5lU29ydH1cbiAgICAgICAgICAgICAgICAgICAgdG9nZ2xlU2VsZWN0QWxsUHJvYmxlbXNPclBhc3NhZ2VzPXt0aGlzLnRvZ2dsZVNlbGVjdEFsbFByb2JsZW1zT3JQYXNzYWdlc31cbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlRmlsdGVyQ2xpY2s9e3RoaXMuaGFuZGxlRmlsdGVyQ2xpY2t9XG4gICAgICAgICAgICAgICAgICAgIHN1YmplY3RGaWx0ZXJzPXtzdWJqZWN0RmlsdGVyc31cbiAgICAgICAgICAgICAgICAgICAgZGlmZmljdWx0eUZpbHRlcnM9e2RpZmZpY3VsdHlGaWx0ZXJzfVxuICAgICAgICAgICAgICAgICAgICB0eXBlRmlsdGVycz17dHlwZUZpbHRlcnN9XG4gICAgICAgICAgICAgICAgICAgIHdvcmtib29rRmlsdGVycz17d29ya2Jvb2tGaWx0ZXJzfVxuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgIDxDaG9vc2U+XG4gICAgICAgICAgICAgICAgICAgIDxXaGVuIGNvbmRpdGlvbj17b3BlblNlY3Rpb24gPT09ICdwcm9ibGVtcyd9PlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgaWQ9XCJ0YWJfcHJvYmxlbXNcIiBjbGFzc05hbWU9XCJ0YWItY29udGVudCBhY3RpdmVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udGVudC1zZWN0aW9uIGNvbnRlbnQtc2VjdGlvbi04MFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRhaW5lci1sZ1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicmVzdWx0LXJvdyBjZW50ZXItYWxpZ25cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxiIGNsYXNzTmFtZT1cInJlc3VsdFwiPi0ge3RoaXMuZ2V0TWFwcGFibGVQcm9ibGVtc09yUGFzc2FnZXMoJ3Byb2JsZW1zJykubGVuZ3RofSBtYXRjaGVzIC08L2I+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsaXN0LXZpZXctc2VjdGlvblwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsaXN0LXRhYmxlIGRldGFpbC10YWJsZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGFibGVIZWFkZXIgc29ydEJ5U3ViamVjdD17dGhpcy5kZXRlcm1pbmVTb3J0fSAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxpc3QtdGFibGUtYm9keVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLm1hcFByb2JsZW1zKCl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvV2hlbj5cbiAgICAgICAgICAgICAgICAgICAgPE90aGVyd2lzZT5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPVwidGFiX3Bhc3NhZ2VzXCIgY2xhc3NOYW1lPVwidGFiLWNvbnRlbnQgYWN0aXZlXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRlbnQtc2VjdGlvbiBjb250ZW50LXNlY3Rpb24tODBcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250YWluZXItbGdcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInJlc3VsdC1yb3cgY2VudGVyLWFsaWduXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YiBjbGFzc05hbWU9XCJyZXN1bHRcIj4tIHt0aGlzLmdldE1hcHBhYmxlUHJvYmxlbXNPclBhc3NhZ2VzKCdwYXNzYWdlcycpLmxlbmd0aH0gbWF0Y2hlcyAtPC9iPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0aGlzLm1hcFBhc3NhZ2VzKCl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvT3RoZXJ3aXNlPlxuICAgICAgICAgICAgICAgICAgPC9DaG9vc2U+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFkZC1idG4tYmxvY2tcIj5cbiAgICAgICAgICAgICAgICAgICAgPGFcbiAgICAgICAgICAgICAgICAgICAgICBocmVmPVwiI1wiXG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZHJvcGRvd24tdHJpZ2dlciB3YXZlcy1lZmZlY3Qgd2F2ZXMtdGVhbCBidG4gYWRkLWJ0blwiXG4gICAgICAgICAgICAgICAgICAgICAgZGF0YS10YXJnZXQ9J2Ryb3Bkb3duX2Fzc2lnbl9zZWxlY3RlZF9wYXNzZWdlcydcbiAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uVG9nZ2xlQWRkUHJvYmxlbURyb3Bkb3dufVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwibWF0ZXJpYWwtaWNvbnNcIj5hZGQ8L2k+XG4gICAgICAgICAgICAgICAgICAgICAgQWRkIFNlbGVjdGVkIFByb2JsZW1zXG4gICAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgICAgPHVsXG4gICAgICAgICAgICAgICAgICAgICAgaWQ9J2Ryb3Bkb3duX2Fzc2lnbl9zZWxlY3RlZF9wYXNzZWdlcydcbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9J2Ryb3Bkb3duLWNvbnRlbnQnXG4gICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3sgZGlzcGxheTogYWRkUHJvYmxlbXNEcm9wZG93bk9wZW4gPyAnYmxvY2snIDogJzAnLCBvcGFjaXR5OiBhZGRQcm9ibGVtc0Ryb3Bkb3duT3BlbiA/ICcxJyA6ICcwJyB9fVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCIjXCIgb25DbGljaz17KCkgPT4gdGhpcy5vbkFkZFNlbGVjdGVkUHJvYmxlbXMoJ3RvZGF5Jyl9PkZvciBUb2RheTwvYT48L2xpPlxuICAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiI1wiIG9uQ2xpY2s9eygpID0+IHRoaXMub25BZGRTZWxlY3RlZFByb2JsZW1zKCd0b21vcnJvdycpfT5Gb3IgVG9tb3Jyb3c8L2E+PC9saT5cbiAgICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj1cIiNcIiBvbkNsaWNrPXsoKSA9PiB0aGlzLm9uQWRkU2VsZWN0ZWRQcm9ibGVtcygnbmV4dFNlc3Npb24nKX0+Rm9yIE5leHQgU2Vzc2lvbjwvYT48L2xpPlxuICAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPVwiI1wiIG9uQ2xpY2s9eygpID0+IHRoaXMub25BZGRTZWxlY3RlZFByb2JsZW1zKCdkYXRlJyl9PkZvciBEYXRlLi4uPC9hPjwvbGk+XG4gICAgICAgICAgICAgICAgICAgIDwvdWw+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKX1cbiAgICAgICAgPHN0eWxlIGpzeD5cbiAgICAgICAgICB7YFxuICAgICAgICAgICAgICAuY2FyZC1tb2RhbCB7XG4gICAgICAgICAgICAgICAgbWFyZ2luOiAwO1xuICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDZweDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAud3JhcHBlciB7XG4gICAgICAgICAgICAgICAgbWluLWhlaWdodDogMHB4O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC5tb2RhbC1jdXN0b20ge1xuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgICAgICAgICAgdmlzaWJpbGl0eTogdmlzaWJsZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAubW9kYWwtZm9vdGVyIHtcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgYH1cbiAgICAgICAgPC9zdHlsZT5cbiAgICAgIDwvUG9ydGFsPlxuICAgICk7XG4gIH1cbn1cblxuUHJvYmxlbUJhbmsucHJvcFR5cGVzID0ge1xuICB3b3Jrc2hlZXRJZDogUHJvcFR5cGVzLm51bWJlcixcbiAgb3BlbjogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgb25DbG9zZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgcHJvYmxlbXM6IFByb3BUeXBlcy5hcnJheS5pc1JlcXVpcmVkLFxuICBwYXNzYWdlczogUHJvcFR5cGVzLmFycmF5LmlzUmVxdWlyZWQsXG4gIGFkZFNlbGVjdGVkUHJvYmxlbXM6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG59XG5cbmV4cG9ydCBkZWZhdWx0IFByb2JsZW1CYW5rO1xuIl19 */\\n/*@ sourceURL=/Volumes/HDD/Sites/clearchoicetestprep/clear-choice-admin/components/Worksheet/DetailPage/components/ProblemBank/index.js */\"));\n    }\n  }]);\n\n  return ProblemBank;\n}(React.Component);\n\nProblemBank.propTypes = {\n  worksheetId: PropTypes.number,\n  open: PropTypes.bool.isRequired,\n  onClose: PropTypes.func.isRequired,\n  problems: PropTypes.array.isRequired,\n  passages: PropTypes.array.isRequired,\n  addSelectedProblems: PropTypes.func.isRequired\n};\nexport default ProblemBank;","map":{"version":3,"sources":["/Volumes/HDD/Sites/clearchoicetestprep/clear-choice-admin/components/Worksheet/DetailPage/components/ProblemBank/index.js"],"names":["React","PropTypes","update","Portal","FilterSection","TableHeader","topicMap","workbookMap","subjectMap","difficultyMap","typeMap","subjectAscending","subjectDescending","ProblemBank","props","nextProps","worksheetId","state","problems","passages","setState","addProblemsDropdownOpen","openSection","topicFilter","subjectFilters","difficultyFilters","typeFilters","workbookFilters","sort","problemsOrPassages","filterType","filter","reduce","finalArr","passage","map","problem","indexOf","push","topics","inWorkbook","type","allProblems","allPassages","length","problemOrPassage","subject","difficulty","onFilterPassages","addTime","selectedProblems","selectedPassages","addSelectedProblems","onFilterProblemsOrPassages","onSortBySubject","onSetAscendingSort","onSetDescendingSort","currentSubjectFilters","currentDifficultyFilters","currentTypeFilters","currentWorkbookFilters","modifiedFilterCurrentState","modifiedFilterName","modifiedFilterUpdatedState","$push","filterIndex","$splice","currentSelectedProblems","currentSelectedPassages","clickedTypeCurrentState","clickedTypeName","clickedAllOfType","value","clickedTypeUpdatedState","selectedElement","id","selectedIndex","getMappableProblemsOrPassages","selected","selectedProblem","handleProblemOrPassageClick","topic","selectedPassage","determineSort","title","open","onClose","zIndex","borderBottom","onChangeOpenSection","onSetFilteredTopicState","onClearFilters","toggleSelectAllProblemsOrPassages","handleFilterClick","mapProblems","mapPassages","onToggleAddProblemDropdown","display","opacity","onAddSelectedProblems","Component","propTypes","number","bool","isRequired","func","array"],"mappings":"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","sourcesContent":["/* eslint-disable array-callback-return */\n/* eslint-disable consistent-return */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport update from 'immutability-helper';\n\nimport Portal from '../../../../Portal';\nimport FilterSection from './components/FilterSection';\nimport TableHeader from './components/TableHeader';\n\nimport { topicMap, workbookMap, subjectMap, difficultyMap, typeMap } from '../../../utils/worksheetFilterMap';\nimport { subjectAscending, subjectDescending } from '../../../../utils/sortFunctions';\n\nclass ProblemBank extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      addProblemsDropdownOpen: false,\n      openSection: 'problems',\n      topicFilter: '',\n      subjectFilters: [],\n      difficultyFilters: [],\n      typeFilters: [],\n      workbookFilters: [],\n      sort: '',\n      selectedProblems: [],\n      selectedPassages: [],\n      problems: [],\n      passages: [],\n      worksheetId: null,\n    }\n  }\n\n  componentDidMount() {\n    const { problems, passages, worksheetId } = this.props;\n    // eslint-disable-next-line react/no-did-mount-set-state\n    this.setState({ problems, passages, worksheetId });\n  }\n\n  componentWillReceiveProps = (nextProps) => {\n    if ((!this.props.worksheetId || nextProps.worksheetId !== this.state.worksheetId)) {\n      const { problems, passages, worksheetId } = nextProps;\n      this.setState({ problems, passages, worksheetId });\n    }\n  }\n\n  onToggleAddProblemDropdown = () => this.setState(({ addProblemsDropdownOpen }) => ({ addProblemsDropdownOpen: !addProblemsDropdownOpen }))\n\n  onChangeOpenSection = (openSection) => this.setState({ openSection })\n  onSetFilteredTopicState = (topicFilter) => this.setState({ topicFilter })\n  onClearFilters = () => this.setState({ subjectFilters: [], difficultyFilters: [], typeFilters: [], workbookFilters: [], topicFilter: '' })\n\n  onSetAscendingSort = () => this.setState({ sort: 'ascending' });\n  onSetDescendingSort = () => this.setState({ sort: 'descending' });\n\n  onSortBySubject = (problemsOrPassages) => {\n    const { sort } = this.state;\n    if (sort === 'ascending') {\n      return problemsOrPassages.sort(subjectAscending);\n    }\n    return problemsOrPassages.sort(subjectDescending);\n  }\n  // Difficulty and type filters are similar enough to reuse the same reduce function, topic and workbook are unique enough to get repetitive for the sake of readability\n  onFilterPassages = (passages, filterType, filter) => {\n    switch (filterType) {\n      case 'difficulty':\n      case 'type':\n        return passages.reduce((finalArr, passage) => {\n          passage.problems.map(problem => {\n            if (filter.indexOf(problem[filterType]) !== -1 && finalArr.indexOf(passage) === -1) {\n              finalArr.push(passage);\n            }\n          });\n          return finalArr;\n        }, []);\n      case 'topic':\n        return passages.reduce((finalArr, passage) => {\n          passage.problems.map(problem => {\n            if (problem.topics.indexOf(filter) !== -1 && finalArr.indexOf(passage) === -1) {\n              finalArr.push(passage);\n            }\n          });\n          return finalArr;\n        }, []);\n      case 'workbook':\n        return passages.reduce((finalArr, passage) => {\n          passage.problems.map(problem => {\n            if (filter.indexOf(workbookMap[problem.inWorkbook]) !== -1 && finalArr.indexOf(passage) === -1) {\n              finalArr.push(passage);\n            }\n          });\n          return finalArr;\n        }, []);\n      default:\n        break;\n    }\n  }\n\n  // Problems get filtered with basic filter functions, passages get passed into onFilterPassages since a few of the filters are based on the problems nested in each passage\n  onFilterProblemsOrPassages = (type) => {\n    const { subjectFilters, difficultyFilters, typeFilters, workbookFilters, topicFilter, problems: allProblems, passages: allPassages } = this.state;\n    let problemsOrPassages;\n    if (type === 'problems') {\n      problemsOrPassages = allProblems;\n    } else {\n      problemsOrPassages = allPassages;\n    }\n    if (subjectFilters.length) {\n      problemsOrPassages = problemsOrPassages.filter(problemOrPassage => subjectFilters.indexOf(problemOrPassage.subject) !== -1);\n    }\n    if (difficultyFilters.length) {\n      if (type === 'problems') {\n        problemsOrPassages = problemsOrPassages.filter(problem => difficultyFilters.indexOf(problem.difficulty) !== -1);\n      } else {\n        problemsOrPassages = this.onFilterPassages(problemsOrPassages, 'difficulty', difficultyFilters);\n      }\n    }\n    if (typeFilters.length) {\n      if (type === 'problems') {\n        problemsOrPassages = problemsOrPassages.filter(problem => typeFilters.indexOf(problem.type) !== -1);\n      } else {\n        problemsOrPassages = this.onFilterPassages(problemsOrPassages, 'type', typeFilters);\n      }\n    }\n    if (workbookFilters.length) {\n      if (type === 'problems') {\n        problemsOrPassages = problemsOrPassages.filter(problem => workbookFilters.indexOf(workbookMap[problem.inWorkbook]) !== -1);\n      } else {\n        problemsOrPassages = this.onFilterPassages(problemsOrPassages, 'workbook', workbookFilters);\n      }\n    }\n    if (topicFilter.length) {\n      if (type === 'problems') {\n        problemsOrPassages = problemsOrPassages.filter(problem => problem.topics.indexOf(topicFilter) !== -1);\n      } else {\n        problemsOrPassages = this.onFilterPassages(problemsOrPassages, 'topic', topicFilter);\n      }\n    }\n    return problemsOrPassages;\n  }\n\n  onAddSelectedProblems = (addTime) => {\n    const { selectedProblems, selectedPassages } = this.state;\n    const { addSelectedProblems } = this.props;\n    addSelectedProblems(selectedProblems, selectedPassages, addTime);\n    this.setState({ selectedPassages: [], selectedProblems: [], addProblemsDropdownOpen: false });\n   }\n\n  getMappableProblemsOrPassages = (type) => {\n    const { subjectFilters, difficultyFilters, typeFilters, workbookFilters, topicFilter, sort, problems: allProblems, passages: allPassages } = this.state;\n    let problemsOrPassages;\n    if (type === 'problems') {\n      problemsOrPassages = allProblems;\n    } else {\n      problemsOrPassages = allPassages;\n    }\n    if (topicFilter.length || subjectFilters.length || difficultyFilters.length || typeFilters.length || workbookFilters.length) {\n      problemsOrPassages = this.onFilterProblemsOrPassages(type);\n    }\n    if (sort) {\n      return this.onSortBySubject(problemsOrPassages);\n    }\n    return problemsOrPassages;\n  }\n\n  determineSort = () => {\n    const { sort } = this.state;\n    if (sort === '' || sort === 'descending') {\n      return this.onSetAscendingSort();\n    }\n    return this.onSetDescendingSort();\n  }\n\n  handleFilterClick = (filterType, filter) => {\n    const { subjectFilters: currentSubjectFilters, difficultyFilters: currentDifficultyFilters,\n      typeFilters: currentTypeFilters, workbookFilters: currentWorkbookFilters } = this.state;\n    let modifiedFilterCurrentState;\n    let modifiedFilterName;\n    let modifiedFilterUpdatedState;\n    switch (filterType) {\n      case 'subject':\n        modifiedFilterCurrentState = currentSubjectFilters;\n        modifiedFilterName = 'subjectFilters';\n        break;\n      case 'difficulty':\n        modifiedFilterCurrentState = currentDifficultyFilters;\n        modifiedFilterName = 'difficultyFilters';\n        break;\n      case 'type':\n        modifiedFilterCurrentState = currentTypeFilters;\n        modifiedFilterName = 'typeFilters';\n        break;\n      case 'workbook':\n        modifiedFilterCurrentState = currentWorkbookFilters;\n        modifiedFilterName = 'workbookFilters';\n        break;\n      default:\n        break;\n    }\n    if (modifiedFilterCurrentState.indexOf(filter) === -1) {\n      modifiedFilterUpdatedState = update(modifiedFilterCurrentState, {\n        $push: [filter],\n      });\n    } else {\n      const filterIndex = modifiedFilterCurrentState.indexOf(filter);\n      modifiedFilterUpdatedState = update(modifiedFilterCurrentState, {\n        $splice: [[ filterIndex, 1 ]],\n      });\n    }\n    this.setState({ [modifiedFilterName]: modifiedFilterUpdatedState });\n  }\n\n  toggleSelectAllProblemsOrPassages = () => {\n    const { openSection: type, problems, passages, selectedProblems: currentSelectedProblems, selectedPassages: currentSelectedPassages } = this.state;\n    let clickedTypeCurrentState;\n    let clickedTypeName;\n    let clickedAllOfType;\n    if (type === 'problems') {\n      clickedTypeCurrentState = currentSelectedProblems;\n      clickedTypeName = 'selectedProblems';\n      clickedAllOfType = problems;\n    } else {\n      clickedTypeCurrentState = currentSelectedPassages;\n      clickedTypeName = 'selectedPassages';\n      clickedAllOfType = passages;\n    }\n    if (clickedTypeCurrentState.length === 0) {\n      this.setState({ [clickedTypeName]: clickedAllOfType });\n    } else {\n      this.setState({ [clickedTypeName]: [] });\n    }\n  }\n\n  // Conditionally updates the selected problem or passages array depending on the incoming type name\n  handleProblemOrPassageClick = (type, value) => {\n    const { selectedProblems: currentSelectedProblems, selectedPassages: currentSelectedPassages } = this.state;\n    let clickedTypeCurrentState;\n    let clickedTypeName;\n    if (type === 'problem') {\n      clickedTypeCurrentState = currentSelectedProblems;\n      clickedTypeName = 'selectedProblems';\n    } else {\n      clickedTypeCurrentState = currentSelectedPassages;\n      clickedTypeName = 'selectedPassages';\n    }\n    let clickedTypeUpdatedState;\n    if (clickedTypeCurrentState.map(selectedElement => selectedElement.id).indexOf(value.id) === -1) {\n      clickedTypeUpdatedState = update(clickedTypeCurrentState, {\n        $push: [value],\n      });\n    } else {\n      const selectedIndex = clickedTypeCurrentState.map(selectedElement => selectedElement.id).indexOf(value.id);\n      clickedTypeUpdatedState = update(clickedTypeCurrentState, {\n        $splice: [[ selectedIndex, 1 ]],\n      });\n    }\n    this.setState({ [clickedTypeName]: clickedTypeUpdatedState });\n  }\n\n  mapProblems = () => this.getMappableProblemsOrPassages('problems').map(problem => {\n    const { selectedProblems } = this.state;\n    const selected = selectedProblems.map(selectedProblem => selectedProblem.id).indexOf(problem.id) !== -1;\n    return (\n      <div className={selected ? \"card list-table-row list-row-added\" : \"card list-table-row\"}>\n        <div className=\"list-table-cell checkbox-cell\">\n          <label>\n            <input\n              type=\"checkbox\"\n              className=\"filled-in\"\n              name=\"check_01\"\n              checked={selectedProblems.map(selectedProblem => selectedProblem.id).indexOf(problem.id) !== -1}\n              onChange={() => this.handleProblemOrPassageClick('problem', problem)}\n            />\n            <span>&nbsp;</span>\n          </label>\n        </div>\n        <div className=\"list-table-cell subject-cell\">\n          <span>{subjectMap[problem.subject]}</span>\n        </div>\n        <div className=\"list-table-cell info-cell\">\n          <span>{difficultyMap[problem.difficulty]}</span>\n        </div>\n        <div className=\"list-table-cell type-cell\">\n          <span>{typeMap[problem.type]}</span>\n        </div>\n        <div className=\"list-table-cell in-cell\">{problem.inWorkbook ? 'Yes' : 'No'}</div>\n        <div className=\"list-table-cell topic-cell\">\n          {problem.topics.map(topic => <span className=\"chip\" id={topic}>{topicMap[topic]}</span>)}\n        </div>\n        <div className=\"list-table-cell view-cell\">\n          <a href=\"#\"><i className=\"icon-eye\"></i></a>\n        </div>\n        <div className=\"list-table-cell drop-cell\">\n          <a href=\"#\"><i className=\"icon-plus-circle\"></i></a>\n        </div>\n      </div>\n    )\n  })\n\n  mapPassages = () => this.getMappableProblemsOrPassages('passages').map(passage => {\n    const { selectedPassages } = this.state;\n    const selected = selectedPassages.map(selectedPassage => selectedPassage.id).indexOf(passage.id) !== -1;\n    return (\n      <div className=\"list-view-section\">\n        <div className={selected ? \"list-table detail-table list-table-added\" : \"list-table detail-table\"}>\n          <TableHeader sortBySubject={this.determineSort} />\n          <div className=\"list-table-body\">\n            <div className=\"combined-holder\">\n              <div className=\"combined-header\">\n                <div className=\"list-table-row\">\n                  <div className=\"list-table-cell checkbox-cell\">\n                    <div className=\"checkbox-block\">\n                      <label>\n                        <input\n                          type=\"checkbox\"\n                          className=\"filled-in\"\n                          checked={selectedPassages.map(selectedPassage => selectedPassage.id).indexOf(passage.id) !== -1}\n                          onChange={() => this.handleProblemOrPassageClick('passage', passage)}\n                        />\n                        <span>&nbsp;</span>\n                      </label>\n                    </div>\n                  </div>\n                  <div className=\"list-table-cell subject-cell\">\n                    <div className=\"filter-name\">{subjectMap[passage.subject]}</div>\n                  </div>\n                  <div className=\"list-table-cell combined-title-cell\">\n                    <div className=\"combined-title\">{passage.title}</div>\n                  </div>\n                  <div className=\"list-table-cell view-cell\">\n                    <a href=\"#\"><i className=\"custom-icon-triangle-right\"></i></a>\n                  </div>\n                  <div className=\"list-table-cell drop-cell\">\n                    <a href=\"#\"><i className=\"icon-plus-circle\"></i></a>\n                  </div>\n                </div>\n              </div>\n              <div className=\"collection\">\n                {passage.problems.map(problem => (\n                  <div className=\"collection-item list-table-row\" id={problem.id}>\n                    <div className=\"list-table-cell checkbox-cell\">\n                      <span>&nbsp;</span>\n                    </div>\n                    <div className=\"list-table-cell subject-cell\">\n                      <span>{subjectMap[problem.subject]}</span>\n                    </div>\n                    <div className=\"list-table-cell info-cell\">\n                      <span>{difficultyMap[problem.difficulty]}</span>\n                    </div>\n                    <div className=\"list-table-cell type-cell\">\n                      <span>{typeMap[problem.type]}</span>\n                    </div>\n                    <div className=\"list-table-cell in-cell\">{problem.inWorkbook ? 'Yes' : 'No'}</div>\n                    <div className=\"list-table-cell topic-cell\">\n                      {problem.topics.map(topic => <span className=\"chip\" id={topic}>{topicMap[topic]}</span>)}\n                    </div>\n                    <div className=\"list-table-cell view-cell\">\n                      <a href=\"#\"><i className=\"icon-eye\"></i></a>\n                    </div>\n                    <div className=\"list-table-cell drop-cell\">\n                      <span>&nbsp;</span>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  })\n\n  render() {\n    const { open, onClose, problems } = this.props;\n    const { openSection, subjectFilters, difficultyFilters, typeFilters, workbookFilters, addProblemsDropdownOpen } = this.state;\n    return (\n      <Portal selector=\"#modal\">\n        {open && (\n          <div className=\"wrapper\">\n            <div id=\"modal_add_problem\" className=\"modal-page modal modal-custom\" style={{ zIndex: '1003' }}>\n              <div className=\"card-modal grey lighten-3\">\n                <div className=\"header-modal-box card-panel light-blue lighten-1 white-text\">\n                  <div className=\"header-flex-row row mb-0\">\n                    <div className=\"col s12 m4 l5\">\n                      <div className=\"header-holder\">\n                        <div className=\"header-col\">\n                          <div className=\"icon-col\">\n                            <i className=\"icon-search\"></i>\n                          </div>\n                        </div>\n                        <div className=\"header-col\">\n                          <nav className=\"breadcrumb-header\">\n                            <div className=\"nav-wrapper \">\n                              <a href=\"#!\" className=\"breadcrumb modal-close\">&lt; Custom Worksheet</a>\n                            </div>\n                          </nav>\n                          <div className=\"card-panel-text\">\n                            <h1 className=\"text-large\">Problem Bank</h1>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"card-panel-description col s8 m3 l2\">\n                      <div className=\"card-panel-text\">\n                        <div className=\"col-row\">\n                          <span className=\"value\">{problems.length}</span>\n                          <span className=\"value-text\">worksheet <br />problems</span>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"col s2 m1 right-align position-mobile-right\">\n                      <div className=\"close-block\">\n                        <a href=\"#\" className=\"modal-close close\" onClick={onClose}><i className=\"icon-close-thin\"></i></a>\n                      </div>\n                    </div>\n                  </div>\n                  <div className=\"tabs-switcher-holder card-panel-row\">\n                    <ul className=\"tabs\">\n                      <li\n                        className=\"tab col s3\"\n                        style={{ borderBottom: openSection === 'problems' ? '2px solid white' : '' }}\n                      >\n                        <a className={openSection === 'problems' ? 'active' : ''} href=\"#\" onClick={() => this.onChangeOpenSection('problems')}>\n                          <b>Problems</b>\n                        </a>\n                      </li>\n                      <li\n                        className=\"tab col s3\"\n                        style={{ borderBottom: openSection === 'passages' ? '2px solid white' : '' }}\n                      >\n                        <a className={openSection === 'passages' ? 'active' : ''} href=\"#\" onClick={() => this.onChangeOpenSection('passages')}>\n                          <b>Passages</b>\n                        </a>\n                      </li>\n                    </ul>\n                  </div>\n                </div>\n                <div className=\"tabs-content\">\n                  <FilterSection\n                    onSetFilteredTopicState={this.onSetFilteredTopicState}\n                    onClearFilters={this.onClearFilters}\n                    sortBySubject={this.determineSort}\n                    toggleSelectAllProblemsOrPassages={this.toggleSelectAllProblemsOrPassages}\n                    handleFilterClick={this.handleFilterClick}\n                    subjectFilters={subjectFilters}\n                    difficultyFilters={difficultyFilters}\n                    typeFilters={typeFilters}\n                    workbookFilters={workbookFilters}\n                  />\n                  <Choose>\n                    <When condition={openSection === 'problems'}>\n                      <div id=\"tab_problems\" className=\"tab-content active\">\n                        <div className=\"content-section content-section-80\">\n                          <div className=\"container-lg\">\n                            <div className=\"result-row center-align\">\n                              <b className=\"result\">- {this.getMappableProblemsOrPassages('problems').length} matches -</b>\n                            </div>\n                            <div className=\"list-view-section\">\n                              <div className=\"list-table detail-table\">\n                                <TableHeader sortBySubject={this.determineSort} />\n                                <div className=\"list-table-body\">\n                                  {this.mapProblems()}\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </When>\n                    <Otherwise>\n                      <div id=\"tab_passages\" className=\"tab-content active\">\n                        <div className=\"content-section content-section-80\">\n                          <div className=\"container-lg\">\n                            <div className=\"result-row center-align\">\n                              <b className=\"result\">- {this.getMappableProblemsOrPassages('passages').length} matches -</b>\n                            </div>\n                            {this.mapPassages()}\n                          </div>\n                        </div>\n                      </div>\n                    </Otherwise>\n                  </Choose>\n                  <div className=\"add-btn-block\">\n                    <a\n                      href=\"#\"\n                      className=\"dropdown-trigger waves-effect waves-teal btn add-btn\"\n                      data-target='dropdown_assign_selected_passeges'\n                      onClick={this.onToggleAddProblemDropdown}\n                    >\n                      <i className=\"material-icons\">add</i>\n                      Add Selected Problems\n                    </a>\n                    <ul\n                      id='dropdown_assign_selected_passeges'\n                      className='dropdown-content'\n                      style={{ display: addProblemsDropdownOpen ? 'block' : '0', opacity: addProblemsDropdownOpen ? '1' : '0' }}\n                    >\n                      <li><a href=\"#\" onClick={() => this.onAddSelectedProblems('today')}>For Today</a></li>\n                      <li><a href=\"#\" onClick={() => this.onAddSelectedProblems('tomorrow')}>For Tomorrow</a></li>\n                      <li><a href=\"#\" onClick={() => this.onAddSelectedProblems('nextSession')}>For Next Session</a></li>\n                      <li><a href=\"#\" onClick={() => this.onAddSelectedProblems('date')}>For Date...</a></li>\n                    </ul>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n        <style jsx>\n          {`\n              .card-modal {\n                margin: 0;\n                border-radius: 6px;\n              }\n              .wrapper {\n                min-height: 0px;\n              }\n              .modal-custom {\n                opacity: 1;\n                visibility: visible;\n              }\n              .modal-footer {\n                background-color: white;\n              }\n            `}\n        </style>\n      </Portal>\n    );\n  }\n}\n\nProblemBank.propTypes = {\n  worksheetId: PropTypes.number,\n  open: PropTypes.bool.isRequired,\n  onClose: PropTypes.func.isRequired,\n  problems: PropTypes.array.isRequired,\n  passages: PropTypes.array.isRequired,\n  addSelectedProblems: PropTypes.func.isRequired,\n}\n\nexport default ProblemBank;\n"]},"metadata":{},"sourceType":"module"}