{"ast":null,"code":"import _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React from \"react\";\nimport Portal from \"../../../../Portal\";\nimport update from 'immutability-helper';\nimport ClickOffComponentWrapper from '../../../../ClickOffComponentWrapper';\nimport AccountInfo from '../SharedModalComponents/AccountInfo';\nimport ContactInfo from '../SharedModalComponents/ContactInfo';\nimport Locations from '../SharedModalComponents/Locations';\nimport { nestedEditFieldValidation } from '../../../../utils/fieldValidation';\n\nclass ClassDetailModal extends React.Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"componentWillReceiveProps\", nextProps => {\n      if (!this.state.originalClassRoom || nextProps.classroom.id !== this.state.originalClassRoom.id) {\n        const {\n          classroom: {\n            id,\n            basicInfo,\n            accountInfo,\n            contactInfo,\n            locations,\n            summary\n          } = {}\n        } = nextProps;\n        const updatedClassRoom = {\n          id,\n          basicInfo,\n          accountInfo,\n          contactInfo,\n          locations,\n          summary\n        };\n        const {\n          originalClassRoom: originalClassRoomState\n        } = this.state;\n        const originalClassRoom = update(originalClassRoomState, {\n          $merge: nextProps.classroom\n        });\n        this.setState({\n          originalClassRoom,\n          updatedClassRoom\n        });\n      }\n    });\n\n    _defineProperty(this, \"handleDetailsChange\", (event, name, section) => {\n      const value = event.target ? event.target.value : event;\n      const updatedClassRoom = update(this.state.updatedClassRoom, {\n        [section]: {\n          $merge: {\n            [name]: value\n          }\n        }\n      });\n      this.setState({\n        updatedClassRoom\n      });\n    });\n\n    _defineProperty(this, \"initialClassRoomMount\", () => this.state.originalClassRoom.id !== this.props.classroom.id);\n\n    _defineProperty(this, \"renderModalHeader\", () => {\n      const {\n        classroom: {\n          accountInfo: {\n            lastName: initialLastName,\n            firstName: initialFIrstName,\n            email: initialEmail\n          }\n        }\n      } = this.props;\n      const {\n        updatedClassRoom: {\n          accountInfo: {\n            lastName: updatedLastName,\n            firstName: updatedFirstName,\n            email: updatedEmail\n          }\n        }\n      } = this.state;\n      let lastName;\n      let firstName;\n      let email;\n\n      if (this.initialClassRoomMount()) {\n        lastName = initialLastName;\n        firstName = initialFIrstName;\n        email = initialEmail;\n      } else {\n        lastName = updatedLastName;\n        firstName = updatedFirstName;\n        email = updatedEmail;\n      }\n\n      return __jsx(React.Fragment, null, __jsx(\"h4\", {\n        className: \"h3\"\n      }, lastName, \", \", firstName), __jsx(\"a\", {\n        href: `mailto:${email}`\n      }, email));\n    });\n\n    _defineProperty(this, \"onSetValidation\", (validation, cb) => this.setState({\n      validation\n    }, cb));\n\n    _defineProperty(this, \"onSubmit\", async event => {\n      event.preventDefault();\n      const {\n        updatedClassRoom: {\n          id,\n          basicInfo,\n          accountInfo,\n          contactInfo,\n          locations,\n          summary\n        }\n      } = this.state;\n      const {\n        onSaveLocationError,\n        onSaveClassChanges,\n        onClose\n      } = this.props; // NOTE: Swap out what instance of valid is active if you want to test saving a new location without worrying about validation\n      // const valid = true;\n\n      const valid = await nestedEditFieldValidation(this.state, this.state.updatedClassRoom, this.onSetValidation, validation => console.warn('validation', validation));\n\n      if (!valid) {\n        // return onSaveLocationError();\n        console.warn('not valid');\n      }\n\n      const postBody = {\n        id,\n        basicInfo,\n        accountInfo,\n        contactInfo,\n        locations,\n        summary\n      };\n      onSaveClassChanges(postBody);\n      onClose();\n    });\n\n    _defineProperty(this, \"onCancelChanges\", () => {\n      const {\n        onClose\n      } = this.props;\n      const {\n        originalClassRoom\n      } = this.state;\n      this.setState({\n        updatedClassRoom: originalClassRoom\n      }, onClose());\n    });\n\n    this.state = {\n      deleteLocationModalOpen: false,\n      newLocationModalOpen: false,\n      editLocationModalOpen: false,\n      pendingLocationDelete: {},\n      activeLocation: {},\n      dropdownIsOpen: false,\n      dropdownIndex: null,\n      originalClassRoom: {\n        summary: {\n          amount_students: '',\n          start_date: '',\n          end_date: '',\n          improvement: 0,\n          coursework_assigned: 0,\n          coursework_completed: 0,\n          problems_flagged_review: 0,\n          average_score: 0,\n          achieved_target_score: 0,\n          average_practice_tests_completed: 0,\n          instruction: 0\n        },\n        accountInfo: {\n          firstName: '',\n          lastName: '',\n          email: '',\n          gender: ''\n        },\n        contactInfo: {\n          phone: '',\n          streetAddress: '',\n          city: '',\n          state: '',\n          zip: ''\n        },\n        locations: []\n      },\n      updatedClassRoom: {\n        summary: {\n          amount_students: '',\n          start_date: '',\n          end_date: '',\n          improvement: 0,\n          coursework_assigned: 0,\n          coursework_completed: 0,\n          problems_flagged_review: 0,\n          average_score: 0,\n          achieved_target_score: 0,\n          average_practice_tests_completed: 0,\n          instruction: 0\n        },\n        accountInfo: {\n          firstName: '',\n          lastName: '',\n          email: '',\n          gender: ''\n        },\n        contactInfo: {\n          phone: '',\n          streetAddress: '',\n          city: '',\n          state: '',\n          zip: ''\n        },\n        locations: []\n      },\n      validation: {\n        accountInfo: {\n          firstName: true,\n          lastName: true,\n          email: true,\n          gender: true\n        }\n      }\n    };\n  }\n\n  componentDidMount() {\n    const {\n      classroom: {\n        id,\n        basicInfo,\n        accountInfo,\n        contactInfo,\n        locations,\n        summary\n      } = {}\n    } = this.props;\n    const updatedClassRoom = {\n      id,\n      basicInfo,\n      accountInfo,\n      contactInfo,\n      locations,\n      summary\n    };\n    const {\n      originalClassRoom: originalClassRoomState\n    } = this.state;\n    const originalClassRoom = update(originalClassRoomState, {\n      $merge: updatedClassRoom\n    });\n    this.setState({\n      originalClassRoom,\n      updatedClassRoom\n    }); // eslint-disable-line\n  } // This resets the component state to reflect the details of the next classroom the user clicks on\n\n\n  render() {\n    const {\n      open,\n      onOpenDeleteModal,\n      onDeleteClass,\n      deleteModalOpen,\n      index\n    } = this.props;\n    const {\n      dropdownIsOpen,\n      dropdownIndex,\n      activeLocation,\n      deleteLocationModalOpen,\n      pendingLocationDelete,\n      newLocationModalOpen,\n      editLocationModalOpen,\n      updatedClassRoom: {\n        accountInfo: updatedAccountInfo,\n        contactInfo: updatedContactInfo,\n        locations: updatedLocations\n      }\n    } = this.state;\n    return __jsx(Portal, {\n      selector: \"#modal\"\n    }, open && __jsx(\"div\", {\n      className: \"jsx-2557376288\" + \" \" + \"overlay\"\n    }, __jsx(ClickOffComponentWrapper, {\n      onOuterClick: this.onCancelChanges,\n      nestedModals: deleteModalOpen || deleteLocationModalOpen || editLocationModalOpen || newLocationModalOpen\n    }, __jsx(\"div\", {\n      id: \"modal_user_edit\",\n      className: \"jsx-2557376288\" + \" \" + \"modal modal-custom modal-custom-large modal-gray\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2557376288\" + \" \" + \"card-modal card-main card grey lighten-3\"\n    }, __jsx(\"div\", {\n      style: {\n        backgroundColor: \"#31837a\",\n        color: \"#fff\"\n      },\n      className: \"jsx-2557376288\" + \" \" + \"owner-box card-panel card-panel-title\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2557376288\" + \" \" + \"card-panel-row row\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2557376288\" + \" \" + \"col s9\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2557376288\" + \" \" + \"user-block\"\n    }, __jsx(\"div\", {\n      style: {\n        backgroundColor: \"#0085ce\",\n        color: \"#fff\"\n      },\n      className: \"jsx-2557376288\" + \" \" + \"user-circle\"\n    }, __jsx(\"img\", {\n      src: \"./static/images/img-owner01.jpg\",\n      alt: \"\",\n      className: \"jsx-2557376288\"\n    })), __jsx(\"div\", {\n      style: {\n        color: \"#fff\"\n      },\n      className: \"jsx-2557376288\" + \" \" + \"user-text\"\n    }, this.renderModalHeader()))), __jsx(\"div\", {\n      style: {\n        textAlign: \"right\"\n      },\n      className: \"jsx-2557376288\" + \" \" + \"col\"\n    }, __jsx(\"span\", {\n      className: \"jsx-2557376288\" + \" \" + \"block-icon\"\n    }, __jsx(\"i\", {\n      className: \"jsx-2557376288\" + \" \" + \"icon-owner\"\n    }), __jsx(\"span\", {\n      className: \"jsx-2557376288\" + \" \" + \"text-icon\"\n    }, \"Owner\"))))), __jsx(\"div\", {\n      className: \"jsx-2557376288\" + \" \" + \"card-content\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2557376288\" + \" \" + \"card-body\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2557376288\" + \" \" + \"row mb-0\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2557376288\" + \" \" + \"col s12 l6\"\n    }, __jsx(AccountInfo, {\n      state: this.initialClassRoomMount() ? accountInfo : updatedAccountInfo,\n      handleDetailsChange: this.handleDetailsChange\n    }), __jsx(ContactInfo, {\n      state: this.initialClassRoomMount() ? contactInfo : updatedContactInfo,\n      handleDetailsChange: this.handleDetailsChange\n    })), __jsx(\"div\", {\n      className: \"jsx-2557376288\" + \" \" + \"col s12 l6\"\n    }, __jsx(Locations, {\n      state: this.initialClassRoomMount() ? locations : updatedLocations,\n      handleDetailsChange: this.handleDetailsChange,\n      dropdownIsOpen: dropdownIsOpen,\n      dropdownIndex: dropdownIndex,\n      activeLocation: activeLocation,\n      deleteLocationModalOpen: deleteLocationModalOpen,\n      pendingLocationDelete: pendingLocationDelete,\n      newLocationModalOpen: newLocationModalOpen,\n      editLocationModalOpen: editLocationModalOpen,\n      onSetDropdown: this.onSetDropdown,\n      onCloseDropdown: this.onCloseDropdown,\n      onOpenNewLocationModal: this.onOpenNewLocationModal,\n      onOpenEditLocationModal: this.onOpenEditLocationModal,\n      onCloseNewLocationModal: this.onCloseNewLocationModal,\n      onCloseEditLocationModal: this.onCloseEditLocationModal,\n      onOpenDeleteLocationModal: this.onOpenDeleteLocationModal,\n      onCloseDeleteLocationModal: this.onCloseDeleteLocationModal\n    })))), __jsx(\"div\", {\n      className: \"jsx-2557376288\" + \" \" + \"modal-footer\"\n    }, __jsx(\"a\", {\n      href: \"#\",\n      onClick: () => onDeleteClass(index),\n      className: \"jsx-2557376288\" + \" \" + \"waves-effect waves-teal btn-flat pink-text text-darken-1\"\n    }, \"Delete\"), __jsx(\"a\", {\n      href: \"#\",\n      onClick: this.onCancelChanges,\n      className: \"jsx-2557376288\" + \" \" + \"modal-close waves-effect waves-teal btn-flat grey-text text-darken-1\"\n    }, \"Cancel\"), __jsx(\"a\", {\n      href: \"#\",\n      onClick: this.onSubmit,\n      className: \"jsx-2557376288\" + \" \" + \"btn\"\n    }, \"Save\"))))))), __jsx(_JSXStyle, {\n      id: \"2557376288\"\n    }, [\".overlay.jsx-2557376288{position:fixed;background-color:rgba(0,0,0,0.7);top:0;right:0;bottom:0;left:0;z-index:1999;}\", \".card-modal.jsx-2557376288{margin:0;border-radius:6px;}\", \".modal.jsx-2557376288{display:block;background-color:white;position:absolute;top:10%;right:10%;left:10%;box-shadow:0 24px 38px 3px rgba(0,0,0,0.14),0 9px 46px 8px rgba(0,0,0,0.12),0 11px 15px -7px rgba(0,0,0,0.2);}\", \".modal-custom.jsx-2557376288{opacity:1;visibility:visible;}\", \".modal-footer.jsx-2557376288{background-color:white;}\"]));\n  }\n\n}\n\nexport default ClassDetailModal;","map":null,"metadata":{},"sourceType":"module"}