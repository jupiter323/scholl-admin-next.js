{"ast":null,"code":"import _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport update from 'immutability-helper';\nimport moment from 'moment';\nimport Portal from '../../../../Portal';\nimport FilterSection from './components/FilterSection';\nimport WorksheetCard from './components/WorksheetCard';\nimport { difficultySort, problemSort, timeEstimateSort, subjectSort } from '../../../utils/sortOptions';\nimport sampleWorksheets from '../../../utils/sampleWorksheets';\nimport { worksheetTypeMap, worksheetSourceMap, worksheetDifficultyMap, worksheetSubjectMap } from '../../../utils/worksheetModalMaps';\n\nclass AssignWorksheetModal extends React.Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"onToggleAssignSelectedDropdown\", () => this.setState(({\n      assignSelectedDropdownOpen\n    }) => ({\n      assignSelectedDropdownOpen: !assignSelectedDropdownOpen\n    })));\n\n    _defineProperty(this, \"onSetDropdown\", dropdownIndex => this.setState({\n      dropdownIndex,\n      dropdownIsOpen: true\n    }));\n\n    _defineProperty(this, \"onCloseDropdown\", () => this.setState({\n      dropdownIsOpen: false\n    }));\n\n    _defineProperty(this, \"onResetModal\", () => this.setState({\n      sourceFilters: [],\n      difficultyFilters: [],\n      subjectFilters: [],\n      typeFilters: [],\n      sort: ''\n    }));\n\n    _defineProperty(this, \"onSetSort\", sort => this.setState({\n      sort\n    }));\n\n    _defineProperty(this, \"onSetFilteredState\", (titleFilter, value) => this.setState({\n      [titleFilter]: value\n    }));\n\n    _defineProperty(this, \"onUnsetFilteredState\", titleFilter => this.setState({\n      [titleFilter]: ''\n    }));\n\n    _defineProperty(this, \"onCloseModal\", () => {\n      const {\n        onClose\n      } = this.props;\n      onClose();\n      this.onResetModal();\n    });\n\n    _defineProperty(this, \"onSortWorksheets\", worksheets => {\n      const {\n        sort\n      } = this.state;\n\n      switch (sort) {\n        case 'difficulty':\n          return worksheets.sort(difficultySort);\n\n        case 'problems':\n          return worksheets.sort(problemSort);\n\n        case 'timeEstimate':\n          return worksheets.sort(timeEstimateSort);\n\n        case 'subject':\n          return worksheets.sort(subjectSort);\n\n        default:\n          break;\n      }\n    });\n\n    _defineProperty(this, \"onFilterByTitle\", () => {\n      const {\n        worksheets,\n        titleFilter\n      } = this.state;\n      return worksheets.reduce((finalArr, currentWorksheet) => {\n        const {\n          title\n        } = currentWorksheet;\n        const worksheetString = title.replace(/\\s/g, \"\").toLowerCase();\n\n        if (worksheetString.indexOf(titleFilter) !== -1 && finalArr.indexOf(currentWorksheet) === -1) {\n          finalArr.push(currentWorksheet);\n        }\n\n        return finalArr;\n      }, []);\n    });\n\n    _defineProperty(this, \"onFilterByUnit\", () => {\n      const {\n        worksheets,\n        unitFilter\n      } = this.state;\n      return worksheets.reduce((finalArr, currentWorksheet) => {\n        const {\n          unit\n        } = currentWorksheet;\n        const worksheetString = unit.replace(/\\s/g, \"\").toLowerCase();\n\n        if (worksheetString.indexOf(unitFilter) !== -1 && finalArr.indexOf(currentWorksheet) === -1) {\n          finalArr.push(currentWorksheet);\n        }\n\n        return finalArr;\n      }, []);\n    });\n\n    _defineProperty(this, \"onFilterWorksheets\", () => {\n      const {\n        subjectFilters,\n        typeFilters,\n        sourceFilters,\n        difficultyFilters,\n        worksheets: allWorksheets\n      } = this.state;\n      let worksheets = allWorksheets;\n\n      if (subjectFilters.length) {\n        worksheets = worksheets.filter(worksheet => subjectFilters.indexOf(worksheetSubjectMap[worksheet.subject]) !== -1);\n      }\n\n      if (typeFilters.length) {\n        worksheets = worksheets.filter(worksheet => typeFilters.indexOf(worksheetTypeMap[worksheet.type]) !== -1);\n      }\n\n      if (sourceFilters.length) {\n        worksheets = worksheets.filter(worksheet => sourceFilters.indexOf(worksheetSourceMap[worksheet.source]) !== -1);\n      }\n\n      if (difficultyFilters.length) {\n        worksheets = worksheets.filter(worksheet => difficultyFilters.indexOf(worksheetDifficultyMap[worksheet.difficulty]) !== -1);\n      }\n\n      return worksheets;\n    });\n\n    _defineProperty(this, \"getMappableWorksheets\", () => {\n      const {\n        subjectFilters,\n        typeFilters,\n        difficultyFilters,\n        sourceFilters,\n        sort,\n        unitFilter,\n        titleFilter,\n        worksheets\n      } = this.state;\n      let mappableWorksheets = worksheets;\n\n      if (titleFilter.length) {\n        mappableWorksheets = this.onFilterByTitle();\n      }\n\n      if (unitFilter.length) {\n        mappableWorksheets = this.onFilterByUnit();\n      }\n\n      if (subjectFilters.length || typeFilters.length || difficultyFilters.length || sourceFilters.length) {\n        mappableWorksheets = this.onFilterWorksheets();\n      }\n\n      if (sort) {\n        return this.onSortWorksheets(mappableWorksheets);\n      }\n\n      return mappableWorksheets;\n    });\n\n    _defineProperty(this, \"handleFilterClick\", (filterType, filter) => {\n      const {\n        sourceFilters: currentSourceFilters,\n        difficultyFilters: currentDifficultyFilters,\n        subjectFilters: currentSubjectFilters,\n        typeFilters: currentTypeFilters\n      } = this.state;\n      let modifiedFilterCurrentState;\n      let modifiedFilterName;\n      let modifiedFilterUpdatedState;\n\n      switch (filterType) {\n        case 'subject':\n          modifiedFilterCurrentState = currentSubjectFilters;\n          modifiedFilterName = 'subjectFilters';\n          break;\n\n        case 'type':\n          modifiedFilterCurrentState = currentTypeFilters;\n          modifiedFilterName = 'typeFilters';\n          break;\n\n        case 'source':\n          modifiedFilterCurrentState = currentSourceFilters;\n          modifiedFilterName = 'sourceFilters';\n          break;\n\n        case 'difficulty':\n          modifiedFilterCurrentState = currentDifficultyFilters;\n          modifiedFilterName = 'difficultyFilters';\n          break;\n\n        default:\n          break;\n      }\n\n      if (modifiedFilterCurrentState.indexOf(filter) === -1) {\n        modifiedFilterUpdatedState = update(modifiedFilterCurrentState, {\n          $push: [filter]\n        });\n      } else {\n        const filterIndex = modifiedFilterCurrentState.indexOf(filter);\n        modifiedFilterUpdatedState = update(modifiedFilterCurrentState, {\n          $splice: [[filterIndex, 1]]\n        });\n      }\n\n      this.setState({\n        [modifiedFilterName]: modifiedFilterUpdatedState\n      });\n    });\n\n    _defineProperty(this, \"handleWorksheetClick\", worksheet => {\n      const {\n        selectedWorksheets\n      } = this.state;\n      let modifiedWorksheets;\n\n      if (selectedWorksheets.indexOf(worksheet) === -1) {\n        modifiedWorksheets = update(selectedWorksheets, {\n          $push: [worksheet]\n        });\n      } else {\n        const worksheetIndex = selectedWorksheets.indexOf(worksheet);\n        modifiedWorksheets = update(selectedWorksheets, {\n          $splice: [[worksheetIndex, 1]]\n        });\n      }\n\n      this.setState({\n        selectedWorksheets: modifiedWorksheets\n      });\n    });\n\n    _defineProperty(this, \"assignWorksheets\", date => {\n      const {\n        onAssignWorksheets\n      } = this.props;\n      const {\n        selectedWorksheets\n      } = this.state;\n      let assignDate;\n\n      switch (date) {\n        case 'today':\n          assignDate = moment().format('MM/DD/YY');\n          break;\n\n        case 'tomorrow':\n          assignDate = moment().add(1, 'days').format('MM/DD/YY');\n          break;\n\n        case 'nextSession':\n          break;\n\n        case 'customDate':\n          assignDate = '01/05/19';\n          break;\n\n        default:\n          break;\n      }\n\n      this.onToggleAssignSelectedDropdown();\n      onAssignWorksheets(selectedWorksheets, assignDate);\n    });\n\n    _defineProperty(this, \"mapWorksheets\", () => this.getMappableWorksheets().map((worksheet, index) => __jsx(WorksheetCard, {\n      worksheet: worksheet,\n      index: index,\n      key: worksheet.id,\n      onSetDropdown: this.onSetDropdown,\n      onCloseDropdown: this.onCloseDropdown,\n      dropdownIndex: this.state.dropdownIndex,\n      dropdownIsOpen: this.state.dropdownIsOpen,\n      handleWorksheetClick: this.handleWorksheetClick,\n      selectedWorksheets: this.state.selectedWorksheets\n    })));\n\n    this.state = {\n      sort: '',\n      unitFilter: '',\n      titleFilter: '',\n      typeFilters: [],\n      sourceFilters: [],\n      subjectFilters: [],\n      selectedWorksheets: [],\n      difficultyFilters: [],\n      worksheets: sampleWorksheets,\n      dropdownIndex: null,\n      dropdownIsOpen: false,\n      assignSelectedDropdownOpen: false\n    };\n  }\n\n  render() {\n    const {\n      open\n    } = this.props;\n    const {\n      assignSelectedDropdownOpen,\n      typeFilters,\n      sourceFilters,\n      subjectFilters,\n      difficultyFilters,\n      sort\n    } = this.state;\n    return __jsx(\"div\", {\n      className: \"jsx-2666520574\"\n    }, open && __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"wrapper\"\n    }, __jsx(\"div\", {\n      style: {\n        minWidth: \"100%\"\n      },\n      className: \"jsx-2666520574\" + \" \" + \"card-modal card-main card switcher-section grey lighten-3\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"header-row card-panel light-blue lighten-1 white-text\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"card-panel-row row\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"col s11\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"d-flex\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"icon-col\"\n    }, __jsx(\"i\", {\n      className: \"jsx-2666520574\" + \" \" + \"icon-sheets-w\"\n    })), __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"card-panel-text\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"text-large\"\n    }, \"Assign Worksheets\")))), __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"col s1 right-align\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"row icons-row\"\n    }, __jsx(\"a\", {\n      href: \"#\",\n      onClick: this.onCloseModal,\n      className: \"jsx-2666520574\" + \" \" + \"modal-close close\"\n    }, __jsx(\"i\", {\n      className: \"jsx-2666520574\" + \" \" + \"icon-close-thin\"\n    })))))), __jsx(FilterSection, {\n      sort: sort,\n      typeFilters: typeFilters,\n      sourceFilters: sourceFilters,\n      subjectFilters: subjectFilters,\n      difficultyFilters: difficultyFilters,\n      onSetSort: this.onSetSort,\n      onClearFilters: this.onResetModal,\n      handleFilterClick: this.handleFilterClick,\n      onSetFilteredState: this.onSetFilteredState,\n      onUnsetFilteredState: this.onUnsetFilteredState\n    }), __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"card-content\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"card-body\"\n    }, __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"result-row center-align\"\n    }, __jsx(\"b\", {\n      className: \"jsx-2666520574\" + \" \" + \"result\"\n    }, \" - \", this.getMappableWorksheets().length, \" results -\")), __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"checkboxes-section row d-flex-content card-width-322\"\n    }, this.mapWorksheets())))), __jsx(\"div\", {\n      className: \"jsx-2666520574\" + \" \" + \"add-btn-block\"\n    }, __jsx(\"a\", {\n      href: \"#\",\n      \"data-target\": \"dropdown_assign_selected\",\n      onClick: this.onToggleAssignSelectedDropdown,\n      className: \"jsx-2666520574\" + \" \" + \"dropdown-trigger waves-effect waves-teal btn add-btn\"\n    }, __jsx(\"i\", {\n      className: \"jsx-2666520574\" + \" \" + \"material-icons\"\n    }, \"add\"), \" Assign Selected\"), __jsx(\"ul\", {\n      id: \"dropdown_assign_selected\",\n      style: {\n        display: assignSelectedDropdownOpen ? 'block' : '0',\n        opacity: assignSelectedDropdownOpen ? '1' : '0'\n      },\n      className: \"jsx-2666520574\" + \" \" + 'dropdown-content'\n    }, __jsx(\"li\", {\n      className: \"jsx-2666520574\"\n    }, __jsx(\"a\", {\n      href: \"#\",\n      onClick: () => this.assignWorksheets('today'),\n      className: \"jsx-2666520574\"\n    }, \"For Today\")), __jsx(\"li\", {\n      className: \"jsx-2666520574\"\n    }, __jsx(\"a\", {\n      href: \"#\",\n      onClick: () => this.assignWorksheets('tomorrow'),\n      className: \"jsx-2666520574\"\n    }, \"For Tomorrow\")), __jsx(\"li\", {\n      className: \"jsx-2666520574\"\n    }, __jsx(\"a\", {\n      href: \"#\",\n      onClick: () => this.assignWorksheets('nextSession'),\n      className: \"jsx-2666520574\"\n    }, \"For Next Session\")), __jsx(\"li\", {\n      className: \"jsx-2666520574\"\n    }, __jsx(\"a\", {\n      href: \"#\",\n      onClick: () => this.assignWorksheets('customDate'),\n      className: \"jsx-2666520574\"\n    }, \"For Date...\"))))), __jsx(_JSXStyle, {\n      id: \"2666520574\"\n    }, [\".card-modal.jsx-2666520574{margin:0;border-radius:6px;}\", \".wrapper.jsx-2666520574{min-height:0px;}\", \".modal-custom.jsx-2666520574{opacity:1;visibility:visible;}\", \".modal-footer.jsx-2666520574{background-color:white;}\"]));\n  }\n\n}\n\nexport default AssignWorksheetModal;","map":null,"metadata":{},"sourceType":"module"}